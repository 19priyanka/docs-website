
<p>Sliding windows are a technique for generating charts using the <code>SLIDE BY</code> clause in conjunction with the <code>TIMESERIES</code> clause. With sliding windows, data is gathered in time "windows" that overlap with each other.</p>
<p>For example, in the image below, a query gathers data with 5 minute windows. The windows "slide" by 1 minute. Each window overlaps with the previous window by 4 minutes.</p>
<p>
  <img src="./images/SlidingWindow2.jpg" alt="Image representing a TIMESERIES query using the SLIDE BY clause" title="TIMESERIES query with SLIDE BY clause">
</p>
<p>5-minute windows with 1-minute "slide"</p>
<p>In contrast, with "tumbling" or "cascading" windows, the windows do not overlap. For example, in this <code>TIMESERIES 3 minutes</code> NRQL query, the windows are 3 minutes in length, with each beginning when the other ends. There is no overlap in the measurement interval.</p>
<p>
  <img src="./images/RegWindow2.jpg" alt="Image representing a standard TIMESERIES query" title="TIMESERIES query without SLIDE BY clause">
</p>
<p>3-minute windows with no overlap or "slide".</p>
<h2>When to use sliding windows [#when-to-use]</h2>
<p>Sliding windows are helpful when you need to smooth out "spiky" charts. One common use case is to use sliding windows to smooth line graphs that have a lot of variation over short periods of time in cases where the rolling aggregate (for example a rolling mean) is more important than aggregates from narrow windows of time.</p>
<p>In the example below, data varies greatly from one minute to another, so the 1-minute tumbling window chart shows many high peaks and low valleys.</p>
<p>
  <img src="./images/TIMESERIESspiky.jpg" alt="Image of a chart based on a standard TIMESERIES query" title="TIMESERIES query without SLIDE BY clause">
</p>
<p>TIMESERIES query without SLIDE BY clause</p>
<p>However, in this example, 5-minute wide <code>TIMESERIES</code> windows are smoothed with the help of 1-minute <code>SLIDE BY</code> intervals. The query returns similar data but creates a much smoother chart.</p>
<p>
  <img src="./images/SlidingWindowsSmooth.png" alt="Image of a chart based on a TIMESERIES query used together with the SLIDE BY clause" title="SLIDE BY used with TIMESERIES">
</p>
<p>TIMESERIES query with SLIDE BY clause</p>
<h2>Valid NRQL syntax for <code>SLIDE BY</code> [#valid-syntax]</h2>
<p>Valid NRQL syntax for the <code>SLIDE BY</code> clause will follow the format below.</p>
<pre><code>SELECT ... TIMESERIES integer1 units SLIDE BY integer2 units
</code></pre>
<p><code>integer1</code> specifies the sliding window width and <code>integer2</code> specifies the <code>SLIDE BY</code> interval. <code>units</code> is a time unit, such as <code>second</code>, <code>minute</code>, <code>hour</code>, or <code>day</code>. All standard NRQL time units are accepted.</p>
<p>Hereâ€™s a real-life example. It shows 5-minute <code>TIMESERIES</code> windows with a 1-minute <code>SLIDE BY</code> interval.</p>
<pre><code>SELECT average(duration) from Transaction TIMESERIES 5 minutes SLIDE BY 1 minute
</code></pre>
<h2>Translation from PromQL-style queries [#translate-promql]</h2>
<p>When applicable, a PromQL-style query is translated into a NRQL sliding window query.</p>
<p>For example, if your PromQL style query uses <code>rate(request_count[5m])</code> for the past 60 minutes with a 1-minute window overlap, the NRQL translation would be the query below.</p>
<pre><code>SELECT rate(sum(request_count), 1 SECONDS) FROM Metric SINCE 3600 SECONDS AGO UNTIL NOW FACET dimensions() LIMIT 100 TIMESERIES 300000 SLIDE BY 60000
</code></pre>
<p>In the translation output, the default unit of millisecond is used for <code>TIMESERIES</code> and <code>SLIDE BY</code> clauses. For <code>TIMESERIES</code>, 300000 ms is 300 seconds, or 5 minutes, specifying a window size of 5 minutes. For <code>SLIDE BY</code>, 60000 ms is 60 seconds, specifying a slide interval of 1 minute.</p>
<h2>Use <code>SLIDE BY</code> with <code>MAX</code> and <code>AUTO</code> [#auto-max]</h2>
<p>You can combine <code>SLIDE BY</code> with <code>MAX</code> and <code>AUTO</code> arguments to further tailor query results, as shown in the examples below.</p>
<pre><code>SELECT average(duration) FROM Transaction TIMESERIES 5 minutes SLIDE BY MAX
</code></pre>
<pre><code>SELECT average(duration) FROM Transaction TIMESERIES 5 minutes SLIDE BY AUTO
</code></pre>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>When paired with <code>SLIDE BY</code>, <code>TIMESERIES</code> does not support <code>AUTO</code> or <code>MAX</code>. The <code>TIMESERIES</code> value must be an integer time unit value. In other words, <code>SLIDE BY AUTO</code> or <code>SLIDE BY MAX</code> will work, but <code>TIMESERIES AUTO</code> or <code>TIMESERIES MAX</code> followed by <code>SLIDE BY</code> and <code>MAX</code>, <code>AUTO</code>, or a specific integer time unit is not supported.</p>
</div>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>The <code>SLIDE BY</code> value as determined by <code>AUTO</code> or <code>MAX</code> can produce a step interval greater than the window size, which will show up as gaps and unexpected results. If you experience these issues with query results, consider checking for instances of SLIDE BY where the step interval exceeds the window size.</p>
</div>
