
<p>One way to <a href="/docs/using-new-relic/data/understand-data/query-new-relic-data">query your New Relic data</a> is with the New Relic Query Language (NRQL). This resource explains what NRQL is, when and how you can use it, and basic syntax rules. For more detailed information on querying, including a listing of clauses and functions and example queries, see <a href="/docs/query-your-data/nrql-new-relic-query-language/get-started/nrql-syntax-clauses-functions">NRQL syntax, clauses, and functions</a>.</p>
<h2>What is NRQL?</h2>
<p>NRQL is New Relic's SQL-like query language. You can use NRQL to retrieve detailed New Relic data and get insight into your applications, hosts, and business-important activity.</p>
<p>Reasons to use NRQL include:</p>
<ul>
  <li>To answer a question for the purpose of troubleshooting or business analysis</li>
  <li>To create a new chart</li>
  <li>To make API queries of New Relic data (for example, using our <a href="/docs/apis/graphql-api/tutorials/nerdgraph-graphiql-nrql-tutorial">NerdGraph</a> API)</li>
</ul>
<p>NRQL is used behind the scenes to generate some New Relic charts:</p>
<p>
  <img src="./images/new-relic-view-chart-nrql-query_0.png" alt="New Relic view chart NRQL query" title="new-relic-view-chart-nrql-query.png">
</p>
<p>Some New Relic charts are built using NRQL. One way to start using NRQL is to view a chart's query and then edit it to make your own custom chart.</p>
<h2>Where can you use NRQL? [#where]</h2>
<p>You can use NRQL in these places:</p>
<ul>
  <li><a href="/docs/chart-builder/use-chart-builder/get-started/introduction-chart-builder">New Relic One query builder</a>:
    <ul>
      <li><strong>Advanced mode</strong> is a NRQL query interface</li>
      <li><strong>Basic mode</strong> provides a simplified query experience that doesn't require knowledge of NRQL but that uses NRQL to generate results</li>
    </ul>
  </li>
  <li><a href="https://docs.newrelic.com/docs/insights">New Relic Insights</a></li>
  <li><a href="/docs/apis/graphql-api/tutorials/nerdgraph-graphiql-nrql-tutorial">NerdGraph</a>: our GraphQL-format API, which includes options for making NRQL queries</li>
</ul>
<p>
  <img src="./images/nrql_example.png" alt="nrql_example.png" title="nrql_example.png">
</p>
<p><strong><a href="https://one.newrelic.com">one.newrelic.com</a> > Query your data</strong>: You can run a NRQL query in both <a href="/docs/new-relic-one/use-new-relic-one/get-started/introduction-new-relic-one">New Relic One</a> and <a href="/docs/insights">New Relic Insights</a>. This NRQL query shows a count of <a href="/docs/understand-dependencies/distributed-tracing/get-started/introduction-distributed-tracing">distributed tracing</a> spans faceted by their entity names.</p>
<p>NRQL is one of several ways to query New Relic data. For more on all query options, see <a href="/docs/using-new-relic/data/understand-data/query-new-relic-data">Query your data</a>.</p>
<h2>What data can you query with NRQL? [#what-you-can-query]</h2>
<p>NRQL allows you to query these New Relic data types:</p>
<ul>
  <li><a href="/docs/using-new-relic/data/understand-data/new-relic-data-types#event-data">Event data</a> from all New Relic products, including:
    <ul>
      <li><a href="/docs/insights/insights-data-sources/default-data/apm-default-events-insights">APM events</a>, like <code>Transaction</code></li>
      <li><a href="/docs/insights/insights-data-sources/default-data/browser-default-events-insights">New Relic Browser events</a>, like <code>PageView</code></li>
      <li><a href="/docs/insights/insights-data-sources/default-data/mobile-default-events-insights">New Relic Mobile events</a>, like <code>Mobile</code></li>
      <li><a href="/docs/infrastructure/manage-your-data/data-instrumentation/default-infrastructure-events">Infrastructure events</a>, like <code>ProcessSample</code></li>
      <li><a href="/docs/insights/insights-data-sources/default-data/synthetics-default-events-insights">Synthetics events</a>, like <code>SyntheticCheck</code></li>
      <li>Custom events, like those reported by the <a href="/docs/insights/insights-data-sources/custom-data/introduction-event-api">Event API</a></li>
    </ul>
  </li>
  <li><a href="/docs/using-new-relic/data/understand-data/new-relic-data-types#timeslice-data">Metric timeslice data</a> (metrics reported by New Relic APM, Browser, and Mobile)</li>
  <li>The <a href="/docs/using-new-relic/data/understand-data/new-relic-data-types#metric-time-series"><code>Metric</code> data type</a> (metrics reported by the Metric API and data sources that use that API)</li>
  <li>The <a href="/docs/using-new-relic/data/understand-data/new-relic-data-types#trace-data"><code>Span</code> data type</a> (distributed tracing data)</li>
  <li>The <a href="/docs/using-new-relic/data/understand-data/new-relic-data-types#log-data"><code>Log</code> data type</a> (data from New Relic Logs)</li>
</ul>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>Some data, like relationships between monitored entities, is not available via NRQL but is available using our <a href="/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph">NerdGraph API</a>.</p>
</div>
<h2>Start using NRQL [#start-learning]</h2>
<p>One way to start using NRQL and to understand what data you have available is to go to a NRQL interface (for example, the <a href="/docs/chart-builder/use-chart-builder/get-started/introduction-chart-builder">New Relic One query builder</a>), type <code>FROM</code>, and press space. The interface will suggest available types of data:</p>
<p>
  <img src="./images/nrql_query01.png" alt="nrql_query01.png" title="nrql_query01.png">
</p>
<p>To see the <a href="/docs/using-new-relic/welcome-new-relic/get-started/glossary#attribute">attributes</a> available for a specific data type, type <code>FROM DATA_TYPE SELECT</code> and press space. The interface will suggest available attributes. For example:</p>
<p>
  <img src="./images/nrql_query02.png" alt="nrql_query02.png" title="nrql_query02.png">
</p>
<p>To see the complete JSON associated with a data type, including all of its attributes, use the <code>keyset()</code> attribute. For example:</p>
<pre><code>FROM Transaction SELECT keyset()
</code></pre>
<p>NRQL is used behind the scenes to build some New Relic charts and dashboards. One way to learn NRQL is to find one of these NRQL-generated charts and start playing with the NRQL to create new, customized queries and charts:</p>
<p>
  <img src="./images/new-relic-view-chart-nrql-query_0.png" alt="New Relic view chart NRQL query" title="new-relic-view-chart-nrql-query.png">
</p>
<p>Charts built with NRQL will have <strong>View query</strong> as an option. You can then edit and customize that query to see how your changes affect the resulting visualization.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>To explore your data without having to use NRQL, use the <a href="/docs/chart-builder/use-chart-builder/choose-data/use-basic-mode-specify-data">basic mode of New Relic One query builder</a>.</p>
</div>
<h2>NRQL query examples [#examples]</h2>
<p>Here's an example NRQL query of <code>Transaction</code> data, which is reported by <a href="/docs/apm">New Relic APM</a>.</p>
<pre><code>FROM Transaction SELECT average(duration) 
  FACET appName TIMESERIES auto
</code></pre>
<p>This would generate a chart that looks like:</p>
<p>
  <img src="./images/nrql_example_0.png" alt="nrql_example.png" title="nrql_example.png">
</p>
<p>Here are some more query examples:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiYmFzaWMtYnJvd3Nlci1ucnFsIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJCYXNpYyBOUlFMIHF1ZXJ5IG9mIEJyb3dzZXIgZGF0YSJ9XQ==">
    <div data-prop-text="title">Basic NRQL query of Browser data</div>
    <p>Here's a NRQL query of <code>PageView</code> data, which is reported by <a href="/docs/browser">New Relic Browser</a>.</p>
    <pre><code>SELECT uniqueCount(user) FROM PageView 
  WHERE userAgentOS = 'Mac' 
  FACET countryCode
  SINCE 1 day ago 
  LIMIT 20

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiYXR0cmlidXRlLXdpdGgtc3BhY2UifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkF0dHJpYnV0ZSBuYW1lIHdpdGggYSBzcGFjZSBpbiBpdCJ9XQ==">
    <div data-prop-text="title">Attribute name with a space in it</div>
    <p>If a <a href="/docs/insights/new-relic-insights/decorating-events/insights-custom-attributes">custom attribute</a> name has a space in it, use backticks around the attribute name:</p>
    <pre><code>SELECT count(*)
 FROM Transaction
 FACET `Logged-in user`

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicXVlcnktbXVsdGlwbGUtZXZlbnRzLWNvbHVtbnMifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IlF1ZXJ5aW5nIG11bHRpcGxlIGRhdGEgc291cmNlcyJ9XQ==">
    <div data-prop-text="title">Querying multiple data sources</div>
    <p>To return data from two data sources, separate their data types with a comma. For example, this query returns a count of all <a href="/docs/insights/new-relic-insights/decorating-events/insights-attributes#transaction-defaults">APM transactions</a> and <a href="/docs/insights/new-relic-insights/decorating-events/insights-attributes#browser-defaults">Browser events</a> over the last three days:</p>
    <pre><code>SELECT count(*) FROM Transaction, PageView SINCE 3 days ago

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJRdWVyeSByZXR1cm5pbmcgbXVsdGlwbGUgY29sdW1ucyJ9XQ==">
    <div data-prop-text="title">Query returning multiple columns</div>
    <p>To return multiple columns from a dataset, separate the aggregator arguments with a comma:</p>
    <pre><code>SELECT function(attribute), function(attribute) ...
  FROM ...

</code></pre>
    <pre><code>
SELECT min(duration), max(duration), average(duration)
  FROM PageView SINCE 1 week ago

</code></pre>This query returns the minimum, average, and maximum duration for New Relic Browser `PageView` events over the last week:
  </div>
</div>
<p>See more <a href="/docs/query-data/nrql-new-relic-query-language/nrql-query-examples">NRQL query examples</a>.</p>
<h2>NRQL syntax [#syntax]</h2>
<p>The syntax of a NRQL query is similar to standard SQL queries. Here is a breakdown of the structure of a NRQL query:</p>
<pre><code>SELECT function(attribute) [AS 'label'][, ...] 
  FROM data type
  [WHERE attribute [comparison] [AND|OR ...]][AS 'label'][, ...]
  [FACET attribute | function(attribute)]
  [LIMIT number]
  [SINCE time]
  [UNTIL time]
  [WITH TIMEZONE timezone]
  [COMPARE WITH time]
  [TIMESERIES time]
</code></pre>
<p>Basic rules include:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p><strong>NRQL condition</strong></p>
      </div>
      <div>
        <p>Details</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>Required values</p>
      </div>
      <div>
        <p>The <a href="#state-select"><code>SELECT</code></a> statement and <a href="#sel-from"><code>FROM</code></a> clause are required. All other clauses are optional. You can start your query with either <code>SELECT</code> or <code>FROM</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Query string size</p>
      </div>
      <div>
        <p>The query string must be less than 4 KB.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Case sensitivity</p>
      </div>
      <div>
        <ul>
          <li>The data type names and attribute names are case sensitive.</li>
          <li><a href="/docs/insights/new-relic-insights/using-new-relic-query-language/nrql-reference#clauses">NRQL clauses</a> and <a href="/docs/insights/new-relic-insights/using-new-relic-query-language/nrql-reference#functions">functions</a> are not case sensitive.</li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p>Syntax for strings</p>
      </div>
      <div>
        <p>NRQL uses single quotes to designate strings. For example:</p>
        <pre><code>... where traceId = '030a573f0df02c57'

</code></pre>
      </div>
    </div>
    <div>
      <div>
        <p>Attribute names with spaces</p>
      </div>
      <div>
        <p>Use backticks <code>``</code> to quote a <a href="/docs/insights/new-relic-insights/decorating-events/insights-custom-attributes">custom attribute</a> name that has a space in it. For example:</p>
        <pre><code>... FACET `Logged-in user`

</code></pre>
      </div>
    </div>
    <div>
      <div>
        <p>Data type coercion</p>
      </div>
      <div>
        <p>Insights does not support data type "coercion." For more information, see <a href="/docs/insights/nrql-new-relic-query-language/nrql-reference/nrql-syntax-components-functions#type-conversion">Data type conversion</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Use of math functions</p>
      </div>
      <div>
        <p><a href="/docs/insights/nrql-new-relic-query-language/using-nrql/nrql-math-using-select">Basic and advanced math functions</a> are supported in the <a href="/docs/insights/new-relic-insights/using-new-relic-query-language/nrql-reference#state-select"><code>SELECT</code></a> statement.</p>
      </div>
    </div>
    <div>
      <div>
        <p>JOIN functions</p>
      </div>
      <div>
        <p>NRQL does not have the equivalent of the SQL JOIN function, but you can <a href="/docs/insights/new-relic-insights/using-new-relic-query-language/simulate-sql-join-functions-insights">simulate a JOIN with custom attributes</a>.</p>
      </div>
    </div>
  </div>
</div>
<p>Read more about <a href="/docs/query-data/nrql-new-relic-query-language/getting-started/nrql-syntax-components-functions">NRQL syntax and functions</a>.</p>
