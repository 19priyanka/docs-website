
<p>Read on to learn how to use New Relic's Chef recipes to install and configure New Relic's infrastructure agent. For instructions on how to use Chef recipes, see the <a href="https://www.chef.io/solutions/infrastructure-automation/">Chef documentation</a>.</p>
<p>The New Relic cookbook is available from the <a href="https://supermarket.chef.io/cookbooks/newrelic-infra">public Chef Supermarket</a>. This is a community-supported effort.</p>
<h2>Compatibility and requirements [#requirements]</h2>
<p>The Infrastructure Chef recipe has the following requirements:</p>
<ul>
  <li>Chef versions 12 or higher</li>
  <li>Supports all <a href="/docs/infrastructure/new-relic-infrastructure/getting-started/compatibility-requirements-new-relic-infrastructure#operating-systems">operating systems compatible with the infrastructure agent</a></li>
</ul>
<h2>Chef recipes [#recipes]</h2>
<p>Infrastructure monitoring has one default recipe: <code>default</code>. Include this recipe to install and configure the infrastructure agent. If this recipe detects an unsupported platform or version, the Chef run fails. Configuration depends on your specific setup and standards.</p>
<h2>Chef attributes [#attributes]</h2>
<p>The <code>default</code> recipe supplies the following Chef attributes:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY2hlZi1saWNlbnNlX2tleSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjp7InR5cGUiOiJtZHhWYWx1ZUV4cHJlc3Npb24iLCJ2YWx1ZSI6Ijw+PElubGluZUNvZGU+ZGVmYXVsdFxcWyduZXdyZWxpY19pbmZyYSddXFxbJ2NvbmZpZyddXFxbJ2xpY2Vuc2Vfa2V5J108L0lubGluZUNvZGU+IChSRVFVSVJFRCk8Lz4iLCJwb3NpdGlvbiI6eyJzdGFydCI6eyJsaW5lIjozNywiY29sdW1uIjoxMSwib2Zmc2V0IjoxNjY1fSwiZW5kIjp7ImxpbmUiOjM3LCJjb2x1bW4iOjEwNywib2Zmc2V0IjoxNzYxfX19fV0=">
    <div data-prop-text="title">[object Object]</div>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Type</p>
          </div>
          <div>
            <p>String</p>
          </div>
        </div>
        <div>
          <div>
            <p>Default</p>
          </div>
          <div>
            <p>(none)</p>
          </div>
        </div>
      </div>
    </div>
    <p>Defines your <a href="/docs/accounts-partnerships/accounts/account-setup/license-key">New Relic license key</a>.</p>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY2hlZi1hZ2VudF9hY3Rpb24ifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6eyJ0eXBlIjoibWR4VmFsdWVFeHByZXNzaW9uIiwidmFsdWUiOiI8SW5saW5lQ29kZT5kZWZhdWx0XFxbJ25ld3JlbGljX2luZnJhJ11cXFsncGFja2FnZXMnXVxcWydhZ2VudCddXFxbJ2FjdGlvbiddPC9JbmxpbmVDb2RlPiIsInBvc2l0aW9uIjp7InN0YXJ0Ijp7ImxpbmUiOjY4LCJjb2x1bW4iOjExLCJvZmZzZXQiOjIyNDl9LCJlbmQiOnsibGluZSI6NjgsImNvbHVtbiI6OTgsIm9mZnNldCI6MjMzNn19fX1d">
    <div data-prop-text="title">[object Object]</div>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Type</p>
          </div>
          <div>
            <p>String</p>
          </div>
        </div>
        <div>
          <div>
            <p>Default</p>
          </div>
          <div>
            <p><code>install</code></p>
          </div>
        </div>
        <div>
          <div>
            <p>Valid values</p>
          </div>
          <div>
            <p><code>install</code>, <code>upgrade</code>, or <code>remove</code></p>
          </div>
        </div>
      </div>
    </div>
    <p>Select what type of <a href="https://docs.chef.io/resource_package.html#actions">package resource actions</a> action you want to perform:</p>
    <ul>
      <li><code>install</code>: Installs the infrastructure agent. If <code>[agent_version]</code> is specified, that version will be installed. The first time the cookbook runs on each host, it will install the latest infrastructure agent. However, the agent will <strong>not</strong> be upgraded with <code>install</code> on subsequent Chef runs. Use <code>upgrade</code> to install newer versions.</li>
      <li><code>upgrade</code>: Upgrades hosts to the latest infrastructure agent version.</li>
      <li><code>remove</code>: Uninstalls the infrastructure agent.</li>
    </ul>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY2hlZi1hZ2VudF92ZXJzaW9uIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOnsidHlwZSI6Im1keFZhbHVlRXhwcmVzc2lvbiIsInZhbHVlIjoiPElubGluZUNvZGU+ZGVmYXVsdFxcWyduZXdyZWxpY19pbmZyYSddXFxbJ3BhY2thZ2VzJ11cXFsnYWdlbnQnXVxcWydyZXRyaWVzJ108L0lubGluZUNvZGU+IiwicG9zaXRpb24iOnsic3RhcnQiOnsibGluZSI6MTEzLCJjb2x1bW4iOjExLCJvZmZzZXQiOjM0ODV9LCJlbmQiOnsibGluZSI6MTEzLCJjb2x1bW4iOjk5LCJvZmZzZXQiOjM1NzN9fX19XQ==">
    <div data-prop-text="title">[object Object]</div>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Type</p>
          </div>
          <div>
            <p>Integer</p>
          </div>
        </div>
        <div>
          <div>
            <p>Default</p>
          </div>
          <div>
            <p>0</p>
          </div>
        </div>
      </div>
    </div>
    <p>The number of times to catch exceptions and retry the resource.</p>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY2hlZi1hZ2VudF92ZXJzaW9uIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOnsidHlwZSI6Im1keFZhbHVlRXhwcmVzc2lvbiIsInZhbHVlIjoiPElubGluZUNvZGU+ZGVmYXVsdFxcWyduZXdyZWxpY19pbmZyYSddXFxbJ3BhY2thZ2VzJ11cXFsnYWdlbnQnXVxcWyd2ZXJzaW9uJ108L0lubGluZUNvZGU+IiwicG9zaXRpb24iOnsic3RhcnQiOnsibGluZSI6MTQ0LCJjb2x1bW4iOjExLCJvZmZzZXQiOjQwMjB9LCJlbmQiOnsibGluZSI6MTQ0LCJjb2x1bW4iOjk5LCJvZmZzZXQiOjQxMDh9fX19XQ==">
    <div data-prop-text="title">[object Object]</div>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Type</p>
          </div>
          <div>
            <p>String</p>
          </div>
        </div>
        <div>
          <div>
            <p>Default</p>
          </div>
          <div>
            <p>(none)</p>
          </div>
        </div>
      </div>
    </div>
    <p>Use with <code>'install'</code> to set a specific agent version. If no value is set, the recipe defaults to the latest agent version.</p>
  </div>
</div>
<h2>Use the basic recipe [#procedure]</h2>
<p>The New Relic cookbook is available from the <a href="https://supermarket.chef.io/cookbooks/newrelic-infra">public Chef Supermarket</a>. To install and configure New Relic's infrastructure agent using Chef:</p>
<ol>
  <li>
    <p>Add the <code>newrelic-infra</code> dependency in your own Chef <code>metadata.rb</code> or <code>Berksfile</code>.</p>
  </li>
  <li>
    <p>Set the New Relic license key attribute. For example, add the following to your <code>recipes/default.rb</code>:</p>
    <pre><code>default['newrelic_infra']['config']['license_key'] = 'YOUR_LICENSE_KEY'
</code></pre>
  </li>
  <li>
    <p>Optional: To control version usage and updating, customize the recipe with <a href="#attributes">Chef attributes</a>.</p>
  </li>
  <li>
    <p>Include the default New Relic recipe by using <code>include_recipe â€˜newrelic-infra::default'</code> or by adding the recipe to your run list.</p>
  </li>
</ol>
<h2>For more help [#more_help]</h2>
<p>If you need additional help, <a href="https://github.com/newrelic/infrastructure-agent-chef/issues">file an issue at <strong>newrelic/infrastructure-agent-chef</strong> on GitHub</a>.</p>
