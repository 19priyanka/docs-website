
<p>Read on to learn how to use New Relic's Ansible role to install and configure <a href="/docs/infrastructure/new-relic-infrastructure/getting-started/welcome-new-relic-infrastructure">New Relic's infrastructure agent</a>. For instructions on how to use Ansible, see the <a href="http://docs.ansible.com/">Ansible documentation</a>. This is a community-supported effort.</p>
<h2>Description [#role-description]</h2>
<p>New Relic provides configuration management sample code to help you install the New Relic infrastructure agent using workflows and tools that are common with many Ops teams. To view an Ansible sample role and more integration information, see the <a href="https://galaxy.ansible.com/newrelic/newrelic-infra/">Ansible Galaxy</a>.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>This is a basic Ansible role and is intended to be used as a starting place for creating your own customized workflow. Configuration depends on your specific setup and standards.</p>
</div>
<h2>Compatibility and requirements [#role-compatibility]</h2>
<p>The Ansible role with New Relic's infrastructure agent requires a <a href="https://docs.newrelic.com/docs/infrastructure/new-relic-infrastructure/getting-started/compatibility-requirements-new-relic-infrastructure#operating-systems">supported Linux operating system</a>.</p>
<h2>Setup [#role-setup]</h2>
<p>The <code>newrelic.newrelic-infra</code> role:</p>
<ul>
  <li>Adds the New Relic infrastructure agent package repository source.</li>
  <li>Installs and configures the infrastructure agent.</li>
</ul>
<p>To get started using this role:</p>
<ol>
  <li>Include the role in your playbook.</li>
  <li>Customize the required variables.</li>
</ol>
<h2>Use and install [#usage]</h2>
<p>All typical interactions with <code>newrelic.newrelic-infra</code> use role configuration. Here is an example of configuring your role to install the infrastructure agent:</p>
<pre><code>- hosts: ap_northeast_1
  roles:
    - name: newrelic.newrelic-infra
      vars:
        nrinfragent_os_name: YOUR_OS_NAME
        nrinfragent_os_version: YOUR_OS_VERSION
        nrinfragent_config:
          license_key: YOUR_LICENSE_KEY
          log_file: /var/log/newrelic/nr-infra.log
          log_to_stdout: false
</code></pre>
<h2>Role configuration variables [#role-config]</h2>
<p>Here are available variables for configuring the <code>newrelic.newrelic-infra</code> role:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Variable</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>nrinfragent_config</code></p>
      </div>
      <div>
        <p><strong>Required</strong>. A map of key-value pairs. Corresponds directly with the available <a href="/docs/infrastructure/new-relic-infrastructure/configuration/configure-infrastructure-agent#general">general configuration settings</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>nrinfragent_state</code></p>
      </div>
      <div>
        <p>Describes what you want to do with the agent:</p>
        <ul>
          <li><code>'latest'</code>: Default. Installs the latest version of the infrastructure agent.</li>
          <li><code>'absent'</code>: Uninstall the agent.</li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p><code>nrinfragent_version</code></p>
      </div>
      <div>
        <p>The version of the agent you want to install:</p>
        <ul>
          <li><code>'*'</code>: Default. Installs the latest version of the infrastructure agent.</li>
          <li><code>'x.y.zzz'</code>: String specifying a specific agent version number you want to install; for example, <code>1.0.682</code>.</li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p><code>nrinfragent_os_name</code></p>
      </div>
      <div>
        <p>Specifies the target OS that the infrastructure agent will be installed on. See the <code>meta/main.yml</code> file for the latest list.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>nrinfragent_os_version</code></p>
      </div>
      <div>
        <p>Specifies the OS version of the installer package needed for this machine. See the <code>meta/main.yml</code> file for the latest list.</p>
      </div>
    </div>
  </div>
</div>
<h2>For more help [#more_help]</h2>
<p>If you need additional help, <a href="https://github.com/newrelic/infrastructure-agent-ansible/issues">file an issue at <strong>newrelic/infrastructure-agent-ansible</strong> on GitHub</a>.</p>
