
<p>With our infrastructure agent for Windows, you can monitor individual servers and also understand how your service performs as a whole. The Windows agent can run on your own hardware, or in cloud systems such as Amazon EC2 or Windows Azure.</p>
<p>The infrastructure agent <a href="/docs/infrastructure/install-infrastructure-agent/get-started/requirements-infrastructure-agent">supports</a> Windows Server and 10, and can be <a href="https://docs.newrelic.com/docs/infrastructure/new-relic-infrastructure/config-management-tools/configure-new-relic-infrastructure-using-chef">installed with Chef</a>. Before installation, review the <a href="/docs/infrastructure/new-relic-infrastructure/getting-started/compatibility-requirements-new-relic-infrastructurets">requirements</a>.</p>
<h2>Install for Windows Server and 10 using our wizard [#install-windows]</h2>
<p>To install the infrastructure agent, click the following button and follow the instructions:</p>
<p>
  <img src="./images/windows.png" alt="amazonlinux.png">
</p>
<p>Windows</p>
<p>If you don't have a New Relic account yet, or prefer to follow the procedure manually, see our <a href="#step-by-step-instructions">step-by-step tutorial</a> in the next section.</p>
<h2>Step-by-step instructions</h2>
<p>To install the infrastructure agent, use our PowerShell script, or follow the step-by-step instructions:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicG93ZXJzaGVsbC1pbnN0YWxsIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJQb3dlclNoZWxsIGluc3RhbGwifV0=">
    <div data-prop-text="title">PowerShell install</div>
    <ol>
      <li>
        <p>Review the <a href="/docs/infrastructure/new-relic-infrastructure/getting-started/compatibility-requirements-new-relic-infrastructure">agent requirements and supported operating systems</a>.</p>
      </li>
      <li>
        <p>Open the PowerShell as administrator and run the following command:</p>
        <div data-component="CollapserGroup" data-prop="W10=">
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicG93ZXJzaGVsbC0zMi1iaXQifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IjMyLWJpdCBXaW5kb3dzIn1d">
            <div data-prop-text="title">32-bit Windows</div>
            <pre><code>$LICENSE_KEY="YOUR_LICENSE_KEY"; `
(New-Object System.Net.WebClient).DownloadFile("https://download.newrelic.com/infrastructure_agent/windows/386/newrelic-infra-386.msi", "$env:TEMP\newrelic-infra.msi"); `
msiexec.exe /qn /i "$env:TEMP\newrelic-infra.msi" GENERATE_CONFIG=true LICENSE_KEY="$LICENSE_KEY" | Out-Null; `
net start newrelic-infra

</code></pre>
          </div>
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicG93ZXJzaGVsbC02NC1iaXQifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IjY0LWJpdCBXaW5kb3dzIn1d">
            <div data-prop-text="title">64-bit Windows</div>
            <pre><code>$LICENSE_KEY="YOUR_LICENSE_KEY"; `
(New-Object System.Net.WebClient).DownloadFile("https://download.newrelic.com/infrastructure_agent/windows/newrelic-infra.msi", "$env:TEMP\newrelic-infra.msi"); `
msiexec.exe /qn /i "$env:TEMP\newrelic-infra.msi" GENERATE_CONFIG=true LICENSE_KEY="$LICENSE_KEY" | Out-Null; `
net start newrelic-infra

</code></pre>
          </div>
        </div>
        <p>For a scripted installation, you can pass in configuration parameters. You must first add <code>GENERATE_CONFIG=true</code> and <code>LICENSE_KEY=YOUR_LICENSE_KEY</code>. You may then add these optional config settings:</p>
      </li>
    </ol>
    <ul>
      <li>
        <p><code>DISPLAY_NAME=YOUR_DISPLAY_NAME</code></p>
      </li>
      <li>
        <p><code>PROXY=http://YOUR_PROXY_SERVER:PROXY_PORT</code></p>
      </li>
      <li>
        <p><code>CUSTOM_ATTRIBUTES="{'ATTRIBUTE_1':'VALUE_1','ATTRIBUTE_2':'VALUE_2'}"</code></p>
        <p>The following example sets the license key and configures a proxy server for outbound communication, as well as adding one custom <a href="/docs/using-new-relic/welcome-new-relic/get-started/glossary#attribute">attribute</a>:</p>
        <pre><code>msiexec.exe /qn /i PATH\TO\newrelic-infra.msi GENERATE_CONFIG=true LICENSE_KEY=YOUR_LICENSE_KEY PROXY=http://YOUR_PROXY_SERVER:PROXY_PORT CUSTOM_ATTRIBUTES="{'ATTRIBUTE_1':'VALUE_1'}"
</code></pre>
      </li>
    </ul>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoic3RlcC1ieS1zdGVwLWluc3RhbGwifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IlN0ZXAtYnktc3RlcCBpbnN0YWxsIn1d">
    <div data-prop-text="title">Step-by-step install</div>
    <ol>
      <li>
        <p>Review the <a href="/docs/infrastructure/new-relic-infrastructure/getting-started/compatibility-requirements-new-relic-infrastructure">agent requirements and supported operating systems</a>.</p>
      </li>
      <li>
        <p>Download the latest .MSI installer image from:</p>
        <div data-component="CollapserGroup" data-prop="W10=">
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiMzItYml0LXdpbmRvd3MifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IjMyLWJpdCBXaW5kb3dzIn1d">
            <div data-prop-text="title">32-bit Windows</div>
            <pre><code>https://download.newrelic.com/infrastructure_agent/windows/386/newrelic-infra-386.msiâ€‹

</code></pre>
          </div>
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiNjQtYml0LXdpbmRvd3MifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IjY0LWJpdCBXaW5kb3dzIn1d">
            <div data-prop-text="title">64-bit Windows</div>
            <pre><code>https://download.newrelic.com/infrastructure_agent/windows/newrelic-infra.msi

</code></pre>
          </div>
        </div>
        <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
          <p><strong>Do not double-click the installer</strong>. This will not fully install the local agent and can result in permissions issues.</p>
        </div>
      </li>
      <li>
        <p>In an admin account, run the install script using an absolute path.</p>
        <div data-component="CollapserGroup" data-prop="W10=">
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiMzItYml0LXBhdGgifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IjMyLWJpdCBXaW5kb3dzIn1d">
            <div data-prop-text="title">32-bit Windows</div>
            <p>To install from the Windows command prompt, run:</p>
            <pre><code>msiexec.exe /qn /i PATH\TO\newrelic-infra-386.msi

</code></pre>
          </div>
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiNjQtYml0LXBhdGgifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IjY0LWJpdCBXaW5kb3dzIn1d">
            <div data-prop-text="title">64-bit Windows</div>
            <p>To install from the Windows command prompt, run:</p>
            <pre><code>msiexec.exe /qn /i PATH\TO\newrelic-infra.msi

</code></pre>
          </div>
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoic2NyaXB0ZWQtaW5zdGFsbCJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiU2NyaXB0ZWQgaW5zdGFsbGF0aW9uIn1d">
            <div data-prop-text="title">Scripted installation</div>
            <p>For a scripted installation, you can also pass in configuration parameters. You must first add <code>GENERATE_CONFIG=true</code> and <code>LICENSE_KEY=YOUR_LICENSE_KEY</code>. You may then add these optional config settings:</p>
            <ul>
              <li>
                <p><code>DISPLAY_NAME=YOUR_DISPLAY_NAME</code></p>
              </li>
              <li>
                <p><code>PROXY=http://YOUR_PROXY_SERVER:PROXY_PORT</code></p>
              </li>
              <li>
                <p><code>CUSTOM_ATTRIBUTES="{'ATTRIBUTE_1':'VALUE_1','ATTRIBUTE_2':'VALUE_2'}"</code></p>
                <p>The following example sets the license key and configures a proxy server for outbound communication, as well as adding one custom attribute:</p>
                <pre><code>msiexec.exe /qn /i PATH\TO\newrelic-infra.msi GENERATE_CONFIG=true LICENSE_KEY=YOUR_LICENSE_KEY PROXY=http://YOUR_PROXY_SERVER:PROXY_PORT CUSTOM_ATTRIBUTES="{'ATTRIBUTE_1':'VALUE_1'}"
</code></pre>
              </li>
            </ul>
          </div>
        </div>
      </li>
      <li>
        <p>Add your <a href="/docs/accounts-partnerships/accounts/account-setup/license-key">New Relic license key</a> to the <code>license_key</code> attribute in <code>newrelic-infra.yml</code>, located in <code>C:\Program Files\New Relic\newrelic-infra\</code>. When finished, the contents of <code>newrelic-infra.yml</code> should resemble the following:</p>
        <pre><code>license_key: YOUR_LICENSE_KEY
</code></pre>
      </li>
      <li>
        <p>Start the <code>newrelic-infra</code> service. To start from the Windows command prompt, run:</p>
        <pre><code>net start newrelic-infra
</code></pre>
      </li>
    </ol>
  </div>
</div>
<p>Wait a few minutes, then <a href="/docs/infrastructure/new-relic-infrastructure/infrastructure-ui-pages/infrastructure-compute-page-measure-resource-usage">view your server in the Infrastructure UI</a>. If no data appears after waiting a few minutes, follow the <a href="/docs/infrastructure/new-relic-infrastructure/troubleshooting/no-data-appears-infrastructure">troubleshooting steps</a>.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>As of <a href="/docs/release-notes/infrastructure-release-notes/infrastructure-agent-release-notes/new-relic-infrastructure-agent-140">version 1.4.0</a>, the infrastructure agent package includes <a href="/docs/infrastructure/install-configure-manage-infrastructure/manage-your-agent/troubleshoot-running-agent"><code>newrelic-infra-ctl</code></a>, which is used to help troubleshoot a running agent. We recommend <a href="/docs/infrastructure/install-configure-manage-infrastructure/manage-your-agent/troubleshoot-running-agent">adding it to PATH</a>.</p>
</div>
<h2>What's next? [#configure]</h2>
<p>The only required <a href="/docs/infrastructure/install-configure-infrastructure/configuration/configure-infrastructure-agent">configuration option</a> is the <a href="/docs/Infrastructure-configure-your-agent#conf-license_key"><code>license_key</code></a> setting, which is created as part of the installation procedures. You may also want to:</p>
<ul>
  <li><a href="/docs/Infrastructure-configure-your-agent#conf-custom_attributes">Add custom attributes</a> to annotate your infrastructure data.</li>
  <li><a href="/docs/infrastructure-amazon-aws-ec2-integration#connect">Connect your AWS account</a> if your servers are hosted on Amazon EC2.</li>
  <li>Enable <a href="/docs/logs/enable-new-relic-logs/1-enable-logs/forward-your-logs-using-new-relic-infrastructure-agent">log forwarding</a>.</li>
  <li>Add other <a href="/docs/infrastructure/integrations-getting-started/getting-started/introduction-infrastructure-integrations">New Relic infrastructure integrations</a> to collect data from external services.</li>
</ul>
<h2>Install using zip files</h2>
<p>For <strong>custom</strong> setup scenarios, you can install the agent using <a href="https://download.newrelic.com/infrastructure_agent/binaries/windows/" title="Link opens in a new window.">our zip files</a> in <a href="/docs/infrastructure/install-configure-infrastructure/windows-installation/assisted-install-infrastructure-windows">assisted</a> or <a href="/docs/infrastructure/install-configure-infrastructure/windows-installation/manual-install-infrastructure-windows">manual</a> modes. This is especially useful when you need to adapt the default installation settings to your environment.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJjYXV0aW9uIn1d">
  <p>Installing the agent using zip files is not supported.</p>
</div>
<h2>Update the agent [#update]</h2>
<p>To upgrade to the latest version, see <a href="/docs/infrastructure/new-relic-infrastructure/installation/update-infrastructure-agent">Update the infrastructure agent</a>.</p>
