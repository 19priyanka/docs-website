
<p>The Docs site does not support authenticating public users to particular docs. However, you can restrict access to docs to <a href="#restrict-direct-url">direct URL only</a> or to <a href="#restrict-nr-only">New Relic employees only</a>. Restricting access to a direct URL effectively minimizes the <a href="#access-points">access points</a> to a doc and provides more control in serving docs to a small subset of end-users only. For example, you can restrict docs for a private beta feature or product.</p>
<h2>Doc access points [#access-points]</h2>
<p>Users find docs in different ways. New Relic has some degree of control over the various access points. Access points include:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiQWxsIHRoZSBEb2NzIHBhZ2UgKG9yIG90aGVyIGF1dG8tZ2VuZXJhdGVkIGluZGV4IHBhZ2VzKSJ9XQ==">
    <div data-prop-text="title">All the Docs page (or other auto-generated index pages)</div>
    <p>The <a href="/docs/allthedocs">All the Docs</a> page lists and links to all the docs on the site by the Primary Navigation taxonomy.</p>
    <p>Controls include:</p>
    <ul>
      <li>Exclude unpublished docs</li>
      <li>Exclude empty categories</li>
      <li>Exclude categories with New Relic Only restriction</li>
      <li>Exclude docs with New Relic Only restriction</li>
    </ul>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiRGlyZWN0IFVSTCJ9XQ==">
    <div data-prop-text="title">Direct URL</div>
    <p>Users may receive this from a product manager (as part of a beta), coworker, or someone using a site such as the New Relic Explorer's Hub. Users may also bookmark a doc link.</p>
    <p>Controls include:</p>
    <ul>
      <li>Changing the doc URL</li>
      <li>Changing doc permissions to <strong>New Relic Only</strong></li>
    </ul>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiRHJ1cGFsIHNpZGViYXIgbWVudXMsIG1lbnUgcGFnZXMifV0=">
    <div data-prop-text="title">Drupal sidebar menus, menu pages</div>
    <p>Users can browse links in the sidebar. Search engines also find links here. Sidebars are automatically generated based on what is most relevant to the page being viewed. Menu pages list links to all the docs in the specified category and sub-categories.</p>
    <p>The sidebar menus are generated from a PHP template, which gives optimal control over query and output. The menu pages are generated from the <strong>Views</strong> module settings, which is not always intuitive.</p>
    <p>Controls include:</p>
    <ul>
      <li>Exclude unpublished docs</li>
      <li>Exclude docs restricted to authenticated users (New Relic employees)</li>
      <li>Do not place docs in any Primary Navigation category</li>
    </ul>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiRHJ1cGFsIHNpdGUgc2VhcmNoICh2aWEgU3dpZnR5cGUpIn1d">
    <div data-prop-text="title">Drupal site search (via Swiftype)</div>
    <p>The Docs site's Drupal search uses a service called Swiftype to index and serve up search results based on their query. Swiftype crawls the site, like Google, to index and analyze each page. The Docs team has more control in what Swiftype indexes and serves up as search results than with other search engines like Google.</p>
    <p>Controls include:</p>
    <ul>
      <li>Use robust Swiftype meta tags and search results API</li>
      <li>Deny access via authentication (currently, the Docs site can only authenticate New Relic employees)</li>
      <li>Hide it by not providing a link to the doc anywhere on the site and excluding it from the site map served to it</li>
      <li>Use the <a href="https://app.swiftype.com/engines/new-relic/overview">Swiftype admin app</a> to force crawl or remove links from search results</li>
    </ul>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiU2VhcmNoIGVuZ2luZXMgKEdvb2dsZSwgWWFob28sIEJpbmcsIGV0YykifV0=">
    <div data-prop-text="title">Search engines (Google, Yahoo, Bing, etc)</div>
    <p>Third party search engines crawl the site and follow every link they find to index it, analyze it, and serve it up to users based on their search query.</p>
    <p>Controls include:</p>
    <ul>
      <li>Use meta tags (up to search engine to honor it)</li>
      <li>Deny access via authentication (currently, we can only authenticate New Relic employees)</li>
      <li>Hide it by not providing a link to the doc anywhere on the site and excluding it from the sitemap we serve to it</li>
      <li>Use <a href="https://www.google.com/webmasters/tools/dashboard?hl=en&#x26;siteUrl=https%3A%2F%2Fdocs.newrelic.com%2F">Google Search Console</a> to remove link from Google search results or force a crawl (by far the top source of search engine referral traffic to the Docs site)</li>
    </ul>
  </div>
</div>
<h2>Restrict access to New Relic employees only [#restrict-nr-only]</h2>
<p>You can restrict access to a single doc or an entire category of docs to New Relic employees only. This is useful if you want to:</p>
<ul>
  <li>Utilize the Primary Navigation taxonomy for docs in advance of feature/product release</li>
  <li>Have internal SMEs review and edit the docs before release</li>
  <li>Create an internal facing doc alongside its relevant, public category</li>
</ul>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiUmVzdHJpY3Qgc2luZ2xlIGRvYyB0byBOZXcgUmVsaWMgT25seSJ9XQ==">
    <div data-prop-text="title">Restrict single doc to New Relic Only</div>
    <p>To restrict access to a <strong>single doc</strong> to New Relic employees only:</p>
    <ol>
      <li>
        <p>From the <strong>Create/Edit</strong> page, change <strong>User Access</strong> to <code>New Relic Only</code>.</p>
      </li>
      <li>
        <p>Publish the doc when it's ready for end-user consumption.</p>
      </li>
      <li>
        <p>As an anonymous user, check the following access points to ensure the link does not surface:</p>
        <ul>
          <li>Relevant sidebar menus</li>
          <li>Menu pages</li>
          <li>Drupal site search (24 hours after publication)</li>
          <li><a href="/docs/allthedocs">All the Docs page</a></li>
        </ul>
      </li>
    </ol>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiUmVzdHJpY3QgZW50aXJlIGRvYyBjYXRlZ29yeSB0byBOZXcgUmVsaWMgZW1wbG95ZWVzIG9ubHkifV0=">
    <div data-prop-text="title">Restrict entire doc category to New Relic employees only</div>
    <p>To restrict an <strong>entire doc category</strong> to New Relic employees only:</p>
    <ol>
      <li>Create the category via <a href="/admin/structure/taxonomy_manager/voc/docs">Taxonomy Manager</a> (see <a href="/docs/new-relic-only/drupal-configuration/drupal-taxonomy/primary-navigation-taxonomy-management#tax-manager-module">Adding a term with taxonomy manager</a> for detailed instructions).</li>
      <li>Edit the newly created category and set its <strong>Restrictions</strong> to <code>New Relic Only</code>.</li>
      <li>From <a href="/admin/config/people/taxonomy_access/role/1/edit">Taxonomy Access Control > Access rules for anonymous user</a>, add the newly created category to the Primary Navigation permissions table by selecting <strong>Add term</strong> at the bottom and setting <code>Deny</code> for all permissions.</li>
      <li>Select <strong>Save</strong>.</li>
      <li><a href="https://docs.newrelic.com/node/add/page">Create a new Basic Page</a>.</li>
      <li>Set the <strong>Page Location</strong> to the category you created in step 1.</li>
      <li>Set the <strong>User Access</strong> to <code>New Relic Only</code>.</li>
      <li>Set the <strong>XML sitemap</strong> <strong>> Inclusion</strong> to <code>Excluded</code>.</li>
      <li>Publish the doc when it's ready for end-user consumption.</li>
    </ol>
  </div>
</div>
<h2>Restrict public access to direct URL only (betas) [#restrict-direct-url]</h2>
<p>Docs that are restricted to direct URL only are still publicly accessible, but much harder to find unless the user has the direct link (typically communicated to them by a product manager). This is useful for features or products in a private beta or limited release where only a small subset of users have access to it, and New Relic only wants to serve those users with certain docs.</p>
<p>Restricting public access to docs to direct URL excludes them from all the other <a href="#access-points">access points</a>. To restrict public doc access to direct URL only:</p>
<ol>
  <li><a href="https://docs.newrelic.com/node/add/page">Create a new Basic Page</a>.</li>
  <li>Do not set <strong>Page Location</strong>. Ensure dropdown remains as <code>None</code>.</li>
  <li>Check all boxes under <strong>(Meta) Robots</strong> (<code>noarchive</code>, <code>nofollow</code>, <code>noindex</code>).</li>
  <li>Change <strong>XML sitemap > Inclusion</strong> at bottom of page to <code>Excluded</code>.</li>
  <li>Ensure there are no incoming links to the doc in other public docs.</li>
  <li>Include a table of contents with <code>&#x3C;h2 id="in-page-toc">Contents&#x3C;/h2></code>.</li>
  <li>Publish doc when it is ready for end-user consumption.</li>
  <li><strong>Optional:</strong> If there are multiple related hidden docs (for example, multiple docs covering a new product being released into a private beta), maintain and link to a hidden Table of Contents doc that manually indexes all relevant docs.</li>
</ol>
<h2>Recover after hidden content surfaces</h2>
<p>If you are notified that hidden content surfaces or is accessed by someone who should not have access, notify a Drupal admin and perform the following steps:</p>
<ol>
  <li>
    <p>Determine the access point (Google search result, Drupal site search, site menu, etc).</p>
  </li>
  <li>
    <p>Verify and correct access settings for the doc(s) or doc category in question.</p>
  </li>
  <li>
    <p>Remove the content from the <a href="#access-points">access point</a> using the available controls.</p>
    <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
      <p>Removing content from a search engine's index like Google may take up to 24 hours. Removing content from a Drupal sidebar menu or menu page requires clearing site cache to see immediate results.</p>
    </div>
  </li>
  <li>
    <p>As an anonymous user, ensure the doc(s) are hidden from the identified access point(s).</p>
  </li>
</ol>
<h2>Delete or archive content [#delete]</h2>
<p>Follow the procedures to <a href="/docs/new-relic-only/advanced-style-guide/processes-procedures/delete-document">delete a document</a> only if you are certain that the document will never be of use again and you do not want to preserve its redirects. If you want to preserve the content of the doc or its redirects, you can create a new redirect (if there is a logical doc to redirect to) and effectively archive the doc by moving into the Draft moderation state.</p>
