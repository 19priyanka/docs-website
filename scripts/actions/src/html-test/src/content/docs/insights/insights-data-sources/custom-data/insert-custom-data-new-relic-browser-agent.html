
<p>You can use New Relic Browser to add <a href="/docs/insights/insights-data-sources/custom-data/report-custom-event-data">custom events and attributes</a>.</p>
<h2>Overview of creating custom events/attributes with Browser [#overview]</h2>
<p>Use the Browser API's <a href="/docs/browser/new-relic-browser/browser-agent-spa-api/add-page-action"><code>addPageAction</code></a> call to capture events, actions, route changes, or any end-user interactions with your application. The <code>addPageAction</code> call adds an event named <code>PageAction</code> that contains the action name and any custom attribute names and values you capture along with it. The <code>PageAction</code> event also contains any custom attributes you added to the <code>PageView</code> event.</p>
<p>Add custom attributes to the <code>PageView</code> event so you can query or filter your data to answer more questions about your application.</p>
<h2>Requirements</h2>
<p>In order to report <code>PageAction</code> events, you must meet these requirements:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p><strong>Requirement</strong></p>
      </div>
      <div>
        <p><strong>Comments</strong></p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>Subscription level</p>
      </div>
      <div>
        <p>This feature requires a Browser Pro subscription. The <a href="/docs/browser/new-relic-browser/installation-configuration/browser-settings-ui-options-browser-monitoring#enabling">instrumentation level setting for an application</a> does not affect the availability of JavaScript API functions.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Agent version</p>
      </div>
      <div>
        <p>Your New Relic Browser agent version must be <a href="/docs/browser/new-relic-browser/installation-configuration/upgrading-browser-agent#checking">593 or higher</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Client browser version</p>
      </div>
      <div>
        <p>To record <code>PageAction</code> events, the browser must <a href="/docs/browser/new-relic-browser/getting-started/compatibility-requirements#browser-types">support cross-domain XHRs</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Max events per cycle</p>
      </div>
      <div>
        <p><code>PageAction</code> events are reported every 30 seconds, with a maximum of 60 events per 30-second harvest cycle, per browser. After the 60-event limit is reached, additional events are not captured for that cycle.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Event/attribute naming, data type, size</p>
      </div>
      <div>
        <p>Ensure you follow <a href="/docs/insights/insights-data-sources/custom-data/data-requirements#general">general requirements</a> around event/attribute naming syntax, data types, and size.</p>
      </div>
    </div>
  </div>
</div>
<h2>Create PageAction events [#creating-pageactions]</h2>
<p>To create a <code>PageAction</code> event:</p>
<ol>
  <li>Ensure the <a href="/docs/browser/new-relic-browser/installation/install-new-relic-browser-agent">Browser agent is installed</a> for your app.</li>
  <li>Call the <a href="/docs/browser/new-relic-browser/browser-agent-spa-api/newrelicaddpageaction-browser-agent-api"><code>newrelic.addPageAction</code></a> function in the relevant part of your application's JavaScript.</li>
  <li>Wait a couple minutes for the application to run and report relevant <code>PageAction</code> events.</li>
  <li>Run a <a href="/docs/query-data/nrql-new-relic-query-language/nrql-query-examples/insights-query-examples-new-relic-browser-spa">NRQL query</a> of the <code>PageAction</code> event that includes the <code>actionName</code> attribute you used to capture the event (and any associated attributes you sent along with the action).</li>
</ol>
<h2>Add custom attributes to PageView event [#custom-attributes]</h2>
<p>The <code>PageView</code> event is a default Browser-reported event. You can add custom attributes to the <code>PageView</code> event. Any custom attributes you add to the <code>PageView</code> event are also automatically added to the <code>PageAction</code> event.</p>
<p>There are two ways to add custom attributes to the <code>PageView</code> event:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY3VzdG9tLWF0dHJpYnV0ZS12aWEtYnJvd3Nlci1hcGkifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6eyJ0eXBlIjoibWR4VmFsdWVFeHByZXNzaW9uIiwidmFsdWUiOiI8PlVzZSA8TGluayB0bz1cIi9kb2NzL2Jyb3dzZXIvbmV3LXJlbGljLWJyb3dzZXIvYnJvd3Nlci1hZ2VudC1zcGEtYXBpL25ld3JlbGljc2V0Y3VzdG9tYXR0cmlidXRlLWJyb3dzZXItYWdlbnQtYXBpXCI+PElubGluZUNvZGU+c2V0Q3VzdG9tQXR0cmlidXRlPC9JbmxpbmVDb2RlPjwvTGluaz4gQnJvd3NlciBBUEkgY2FsbDwvPiIsInBvc2l0aW9uIjp7InN0YXJ0Ijp7ImxpbmUiOjEyMSwiY29sdW1uIjoxMSwib2Zmc2V0Ijo1MzI3fSwiZW5kIjp7ImxpbmUiOjEyMSwiY29sdW1uIjoxOTksIm9mZnNldCI6NTUxNX19fX1d">
    <div data-prop-text="title">[object Object]</div>
    <p>To add a custom attribute to the <code>PageView</code> event via the Browser agent, use the <a href="/docs/browser/new-relic-browser/browser-agent-spa-api/newrelicsetcustomattribute-browser-agent-api"><code>setCustomAttribute</code></a> Browser API call. This allows you to capture an attribute to be annotated on any <code>PageAction</code> event.</p>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY3VzdG9tLWF0dHJpYnV0ZS1mb3J3YXJkLWFwbSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiRm9yd2FyZCBjdXN0b20gYXR0cmlidXRlcyBmcm9tIEFQTSBkYXRhIn1d">
    <div data-prop-text="title">Forward custom attributes from APM data</div>
    <p>If you added custom attributes to the APM <code>Transaction</code> event via an APM agent, you can forward those custom attributes to the <code>PageView</code> event automatically:</p>
    <ol>
      <li>
        <p>Insert custom attributes by following the <a href="/docs/insights/insights-data-sources/custom-data/add-custom-attributes-apm-data">agent-specific instructions</a>.</p>
      </li>
      <li>
        <p>Enable attribute forwarding in your agent configuration file:</p>
        <div data-component="Table" data-prop="W10=">
          <div>
            <div>
              <div>
                <p>Agent</p>
              </div>
              <div>
                <p>Enable attribute forwarding</p>
              </div>
            </div>
          </div>
          <div>
            <div>
              <div>
                <p>C SDK</p>
              </div>
              <div>
                <p>Not supported.</p>
              </div>
            </div>
            <div>
              <div>
                <p>Go</p>
              </div>
              <div>
                <p>To enable attributes, add this to your config (disabled by default):</p>
                <pre><code>cfg.BrowserMonitoring.Attributes.Enabled = true

</code></pre>
                <pre><code>
cfg.BrowserMonitoring.Attributes.Include = []string{"request.*"}

</code></pre>Then add the attributes you want to include:
              </div>
            </div>
            <div>
              <div>
                <p>Java</p>
              </div>
              <div>
                <p>Add the <a href="/docs/agents/java-agent/configuration/java-agent-configuration-config-file#cfg-browser-attributes-enabled"><code>attributes.enabled</code></a> option in the <code>browser_monitoring</code> stanza and set it to <code>true</code>.</p>
              </div>
            </div>
            <div>
              <div>
                <p>.NET</p>
              </div>
              <div>
                <p>Add the <a href="/docs/agents/net-agent/installation-configuration/net-agent-configuration#browser-attributes"><code>&#x3C;attributes enabled="true"></code></a> element as a child of the <code>browserMonitoring</code> element:</p>
                <pre><code>&#x3C;configuration xmlns="urn:newrelic-config">
  ...
  &#x3C;browserMonitoring autoInstrument="true">
    ...
    &#x3C;attributes enabled="true">
      ...
    &#x3C;/attributes>
  &#x3C;/browserMonitoring>
  ...
&#x3C;/configuration>

</code></pre>If you are using [manual Browser instrumentation](/docs/agents/net-agent/features/page-load-timing-net#manual_instrumentation) the attribute needs to be created before the `GetBrowserTimingHeader()` call.
              </div>
            </div>
            <div>
              <div>
                <p>Node.js</p>
              </div>
              <div>
                <p>Add <a href="/docs/agents/nodejs-agent/installation-configuration/nodejs-agent-configuration#browser-debug-enabled"><code>attributes: {enabled: true}</code></a> to the <code>browser_monitoring: {</code> section of your app's <code>newrelicjs</code> configuration file.</p>
              </div>
            </div>
            <div>
              <div>
                <p>PHP</p>
              </div>
              <div>
                <p>Add the <a href="https://docs.newrelic.com/docs/agents/php-agent/attributes/enabling-disabling-attributes#cfg-browser-attributes-enabled"><code>newrelic.browser_monitoring.attributes.enabled</code></a> option and set it to <code>true</code>.</p>
              </div>
            </div>
            <div>
              <div>
                <p>Python</p>
              </div>
              <div>
                <p>Add the <a href="https://docs.newrelic.com/docs/agents/python-agent/installation-configuration/python-agent-configuration#cfg-browser-attributes-enabled"><code>browser_monitoring.attributes.enabled</code></a> option and set it to <code>true</code>.</p>
              </div>
            </div>
            <div>
              <div>
                <p>Ruby</p>
              </div>
              <div>
                <p>Add the <a href="https://docs.newrelic.com/docs/agents/ruby-agent/installation-configuration/ruby-agent-configuration#browser_monitoring-attributes-enabled"><code>browser_monitoring.attributes.enabled</code></a> option and set it to <code>true</code>.</p>
              </div>
            </div>
          </div>
        </div>
      </li>
    </ol>
  </div>
</div>
<h2>PageAction and PageView attributes [#default-attributes]</h2>
<p>To see the default attributes of <code>PageAction</code> and <code>PageView</code>, see <a href="/docs/insights/insights-data-sources/default-events-attributes/browser-default-events-attributes-insights">Browser events</a>.</p>
<h2>Troubleshooting</h2>
<p>Here are some troubleshooting tips:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p><strong>Problem</strong></p>
      </div>
      <div>
        <p><strong>Comments</strong></p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>Custom attributes missing</p>
      </div>
      <div>
        <p>If your custom attributes do not appear on <code>PageView</code> events, verify you are calling <code>setCustomAttribute</code> before the Load event on your page. If the custom attribute is called after the page load occurs, it will not be visible on <code>PageView</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>PageAction events</p>
      </div>
      <div>
        <p>If your PageAction events do not appear when you query, check that your account <a href="#requirements">is compatible</a>.</p>
        <p>If your account is compatible, check that you are not using <a href="/docs/insights/new-relic-insights/adding-querying-data/inserting-custom-events-insights-api#limits">reserved attribute names or invalid values</a>.</p>
      </div>
    </div>
  </div>
</div>
