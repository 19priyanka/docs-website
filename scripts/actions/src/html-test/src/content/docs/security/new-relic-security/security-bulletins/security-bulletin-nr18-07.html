
<h2>Summary</h2>
<p>A security update for the Java, Python, and .NET agents corrects an issue where the agent may report DB query results to New Relic or re-issue an SQL statement.</p>
<p><strong>Release date:</strong> Mar 7, 2018</p>
<p><strong>Vulnerability identifier:</strong> NR18-07</p>
<p><strong>Priority:</strong> High</p>
<h2>Affected software [#affected]</h2>
<p>The following New Relic agent versions are affected:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p><strong>Name</strong></p>
      </div>
      <div>
        <p><strong>Affected version</strong></p>
      </div>
      <div>
        <p><strong>Notes</strong></p>
      </div>
      <div>
        <p><strong>Remediated version</strong></p>
      </div>
    </div>
    <div>
      <div>
        <p>Java agent</p>
      </div>
      <div>
        <p><a href="https://docs.newrelic.com/docs/release-notes/agent-release-notes/java-release-notes/java-agent-3261">3.26.1</a> to <a href="https://docs.newrelic.com/docs/release-notes/agent-release-notes/java-release-notes/java-agent-3470">3.47.0</a></p>
      </div>
      <div>
        <p>SQL query</p>
      </div>
      <div>
        <p><a href="https://docs.newrelic.com/docs/release-notes/agent-release-notes/java-release-notes">3.47.1</a></p>
      </div>
    </div>
    <div>
      <div>
        <p>Python agent</p>
      </div>
      <div>
        <p><a href="https://docs.newrelic.com/docs/release-notes/agent-release-notes/python-release-notes/python-agent-110192">1.1.0.192</a> to <a href="https://docs.newrelic.com/docs/release-notes/agent-release-notes/python-release-notes/python-agent-2106087">2.106.0.87</a></p>
      </div>
      <div>
        <p>SQL query</p>
      </div>
      <div>
        <p><a href="https://docs.newrelic.com/docs/release-notes/agent-release-notes/python-release-notes/python-agent-2106188">2.106.1.88</a></p>
      </div>
    </div>
    <div>
      <div>
        <p>.NET agent</p>
      </div>
      <div>
        <p><a href="https://docs.newrelic.com/docs/release-notes/agent-release-notes/net-release-notes/net-agent-251120">2.5.112.0</a> to <a href="https://docs.newrelic.com/docs/release-notes/agent-release-notes/net-release-notes/net-agent-62100">6.21.0.0</a></p>
        <p><a href="https://docs.newrelic.com/docs/release-notes/agent-release-notes/net-release-notes/net-agent-7020">7.0.2.0</a> to <a href="https://docs.newrelic.com/docs/release-notes/agent-release-notes/net-release-notes/net-agent-712290">7.1.229</a></p>
      </div>
      <div>
        <p>SQL query with MySQL</p>
      </div>
      <div>
        <p><a href="https://docs.newrelic.com/docs/release-notes/agent-release-notes/python-release-notes">8.0 or 6.22 (For .NET Framework 3.5)</a></p>
      </div>
    </div>
  </div>
</div>
<h2>Vulnerability information [#vuln-info]</h2>
<p>New Relic agents run explain plans for <a href="https://docs.newrelic.com/docs/apm/applications-menu/monitoring/viewing-slow-query-details">Slow Transaction Traces</a> and Slow SQL Queries. Previous versions of the agents would run an explain plan on the SQL query by prepending the query with <code>explain</code>. This may cause an issue when there are multiple statements separated by semicolons in a single query. The first statement in the string returns its explain plan, but any subsequent statement after that may execute as a general SQL statement. Depending on the language, library, and database, the agent may return the results of the additional statements to New Relic. It is also possible that the additional statements could execute an additional <code>INSERT</code> or <code>UPDATE</code> command. With this security update, New Relic agents will no longer run explain plans on any query that contains a semicolon as a statement separator.</p>
<h3>Mitigating factors [#factors]</h3>
<ul>
  <li>Many SQL libraries and language frameworks prevent various forms of executing multiple statements with <code>explain</code>.</li>
  <li>Explain plans are off for newer versions of the .NET agent.</li>
</ul>
<h2>Workarounds</h2>
<p>Disable <code>explain</code> plans with transaction tracer in the agent configuration:</p>
<ul>
  <li><a href="/docs/agents/java-agent/configuration/java-agent-configuration-config-file#h2-Transaction-tracer"><code>transaction_tracer</code></a> for Java</li>
  <li><a href="/docs/agents/net-agent/configuration/net-agent-configuration#transaction_tracer"><code>transactiontracer</code></a> for .NET</li>
  <li><a href="/docs/agents/python-agent/configuration/python-agent-configuration#txn-tracer-settings"><code>transaction_tracer</code></a> for Python</li>
</ul>
<h2>Report security vulnerabilities to New Relic [#report]</h2>
<p>New Relic is committed to the security of our customers and their data. If you believe you have found a security vulnerability in one of our products or websites, we welcome and greatly appreciate you reporting it to New Relic's coordinated disclosure program. For more information, see <a href="/docs/security/new-relic-security/data-privacy/reporting-security-vulnerabilities">Reporting security vulnerabilities</a>.</p>
<h2>For more help [#more_help]</h2>
<p>Additional documentation resources include:.</p>
<ul>
  <li><a href="https://docs.newrelic.com/docs/agents/net-agent/installation/update-net-agent">Upgrade the .NET agent</a></li>
  <li><a href="https://docs.newrelic.com/docs/agents/java-agent/installation/upgrade-java-agent">Upgrade the Java agent</a></li>
  <li><a href="https://docs.newrelic.com/docs/agents/python-agent/installation-configuration/upgrade-python-agent">Upgrade the Python agent</a></li>
  <li><a href="https://newrelic.com/why-new-relic/security" title="Link opens in a new window.">NR Security</a></li>
</ul>
