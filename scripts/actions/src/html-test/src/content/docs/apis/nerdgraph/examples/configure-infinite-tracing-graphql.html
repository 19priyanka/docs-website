
<p>You can configure many of the settings for <a href="/docs/understand-dependencies/distributed-tracing/get-started/how-new-relic-distributed-tracing-works#tail-based">Infinite Tracing</a> with the <a href="https://one.newrelic.com/launcher/mtb-nerdlets.edge-launcher">New Relic Edge app</a>. You can also perform a variety of these configuration tasks using GraphQL. With our <a href="https://api.newrelic.com/graphiql">NerdGraph GraphiQL explorer</a> you can execute and see the results of queries and mutations for Infinite Tracing configuration. This document explains some of the options that are available.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>If you need help getting started with GraphQL, check out <a href="docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph">Introduction to New Relic NerdGraph</a>.</p>
</div>
<h2>Update the random sampler on a trace observer [#updating-the-random-sampler]</h2>
<p>As described in our <a href="/docs/understand-dependencies/distributed-tracing/get-started/how-new-relic-distributed-tracing-works#tail-based">docs on the tail-based sampling algorithms</a> there are several ways Infinite Tracing chooses to sample a trace. The random sampler is configurable, allowing you to control the percent of traces kept.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>If you need help about when it's appropriate to change the random filter, see <a href="/docs/understand-dependencies/distributed-tracing/other-requirements/infinite-tracing-random-trace-filter">Infinite Tracing: Random trace filter</a>.</p>
</div>
<p>The following example shows you how to update the value from the default of 1%:</p>
<ol>
  <li>
    <p>Go to the NerdGraph GraphiQL explorer at <a href="https://api.newrelic.com/graphiql">https://api.newrelic.com/graphiql</a>.</p>
  </li>
  <li>
    <p>Execute the following query to find the trace observer that contains the random sampler to modify:</p>
    <pre><code>{
  actor {
    account(id: YOUR_ACCOUNT_ID) {
      edge {
        tracing {
          traceObservers {
            id
            name
            providerRegion
            status
            traceFilters {
              randomTraceFilter {
                percentKept
              }
            }
            endpoints {
              agent {
                host
              }
            }
          }
        }
      }
    }
  }
}
</code></pre>
  </li>
  <li>
    <p>In the response, find the trace observer <code>id</code>. Here is an example where the value is <code>123456789</code>:</p>
    <pre><code>{
  "data": {
    "actor": {
      "account": {
        "edge": {
          "tracing": {
            "traceObservers": [
              {
                "endpoints": [
                  {
                    "agent": {
                      "host": "your-uuid-goes-here.aws-us-east-1.tracing.edge.nr-data.net"
                    }
                  }
                ],
                "id": 123456789,
                "name": "Production Workload, US-EAST-1",
                "providerRegion": "AWS_US_EAST_1",
                "status": "CREATED",
                "traceFilters": {
                  "randomTraceFilter": {
                    "percentKept": 1
                  }
                }
              }
            ]
          }
        }
      }
    }
  }
}
</code></pre>
  </li>
  <li>
    <p>Execute a mutation using the <code>id</code> and the percent you want to keep. For example, to raise the value to 50% for the trace observer with id <code>123456789</code> that we found in the previous step, run the following:</p>
    <pre><code>mutation {
  edgeUpdateTraceObservers(
    accountId: YOUR_ACCOUNT_ID
    traceObserverConfigs: { id: 123456789, randomTraceFilterConfig: { percentKept: 50 } }
  ) {
    responses {
      errors {
        message
        type
      }
      traceObserver {
        traceFilters {
          randomTraceFilter {
            percentKept
          }
        }
        id
        endpoints {
          agent {
            host
          }
        }
        name
        status
      }
    }
  }
}
</code></pre>
  </li>
</ol>
<p>Here's the response confirming the change:</p>
<pre><code>{
  "data":{
    "edgeUpdateTraceObservers":{
      "responses":[
        {
          "errors":null,
          "traceObserver":{
            "endpoints":[
              {
                "agent":{
                  "host":"your-uuid-goes-here.aws-us-east-1.tracing.edge.nr-data.net"
                }
              }
            ],
            "id":123456789,
            "name":"Production Workload, US-EAST-1",
            "status":"CREATED",
            "traceFilters":{
              "randomTraceFilter":{
                "percentKept":50
              }
            }
          }
        }
      ]
    }
  }
}
</code></pre>
<h2>Update the name on a trace observer [#updating-trace-observer-name]</h2>
<p>Here's how you can change the name of a trace observer:</p>
<ol>
  <li>
    <p>Go to the NerdGraph GraphiQL explorer at <a href="https://api.newrelic.com/graphiql">https://api.newrelic.com/graphiql</a>.</p>
  </li>
  <li>
    <p>Find the trace observer whose name you'd like to update:</p>
    <pre><code>{
  actor {
    account(id: YOUR_ACCOUNT_ID) {
      edge {
        tracing {
          traceObservers {
            id
            name
            providerRegion
            status
            endpoints {
              agent {
                host
              }
            }
          }
        }
      }
    }
  }
}
</code></pre>
  </li>
  <li>
    <p>In the response, find the trace observer <code>id</code> that is returned:</p>
    <pre><code>{
  "data": {
    "actor": {
      "account": {
        "edge": {
          "tracing": {
            "traceObservers": [
              {
                "endpoints": [
                  {
                    "agent": {
                      "host": "your-uuid-goes-here.aws-us-east-1.tracing.edge.nr-data.net"
                    }
                  }
                ],
                "id": 123456789,
                "name": "Production Workload, US-EAST-1",
                "providerRegion": "AWS_US_EAST_1",
                "status": "CREATED"
              }
            ]
          }
        }
      }
    }
  }
}
</code></pre>
  </li>
  <li>
    <p>Execute a mutation that includes the new value for the name. For example, to change the name to Global Workload, US-EAST-1 for the trace observer with id <code>123456789</code>, run the following:</p>
    <pre><code>mutation {
  edgeUpdateTraceObservers(
    accountId: YOUR_ACCOUNT_ID
    traceObserverConfigs: { id: 123456789, name: "Global Workload, US-EAST-1" }
  ) {
    responses {
      errors {
        message
        type
      }
      traceObserver {
        id
        endpoints {
          agent {
            host
          }
        }
        name
        status
      }
    }
  }
}
</code></pre>
  </li>
</ol>
<p>Here's the response confirming the change:</p>
<pre><code>{
  "data":{
    "edgeUpdateTraceObservers":{
      "responses":[
        {
          "errors":null,
          "traceObserver":{
            "endpoints":[
              {
                "agent":{
                  "host":"your-uuid-goes-here.aws-us-east-1.tracing.edge.nr-data.net"
                }
              }
            ],
            "id":123456789,
            "name":"Global Workload, US-EAST-1",
            "status":"CREATED"
          }
        }
      ]
    }
  }
}
</code></pre>
