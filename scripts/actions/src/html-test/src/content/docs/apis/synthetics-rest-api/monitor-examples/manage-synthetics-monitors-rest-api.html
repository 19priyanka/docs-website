
<p>Use the Synthetics REST API to create and manage <a href="/docs/synthetics/new-relic-synthetics/using-monitors/add-edit-monitors#types-monitors">synthetic monitors</a> of all types: ping, simple browser, scripted browser, and API test monitors. All synthetic monitoring data is available via the REST API.</p>
<p>To use the Synthetics REST API, you must have a user role that allows that capability and a <a href="/docs/apis/rest-api-v2/getting-started/introduction-new-relic-rest-api-v2#api_key">user key</a>.</p>
<p>For an overview of all available New Relic APIs, see <a href="/docs/apis/getting-started/introduction-new-relic-apis">Intro to APIs</a>.</p>
<h2>Features [#changelog]</h2>
<p>The newest version of the Synthetics API (v3) adds these features:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p><strong>Synthetics API (v3)</strong></p>
      </div>
      <div>
        <p><strong>Features</strong></p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>Options field for POST and PUT request</p>
      </div>
      <div>
        <p>You can specify the options for <code>SIMPLE</code> and <code>BROWSER</code> type monitors, similar to the way these options are available in the UI.</p>
      </div>
    </div>
    <div>
      <div>
        <p>PATCH request</p>
      </div>
      <div>
        <p>You can update only the fields of a monitor you want to change, rather than having to specify the entire monitor entity in a PUT. You can also specify the <code>OPTION</code>, assuming you are using the appropriate type of monitor.</p>
      </div>
    </div>
    <div>
      <div>
        <p>More detail with 400 <code>Bad Request</code> errors</p>
      </div>
      <div>
        <p>As of v3, the Synthetics API attempts to return as much information as possible when a validation failure occurs. This will help you figure out what might be wrong with the request. The API runs all validations and returns any failed validation messages, rather than failing on the first validation error as occurred in previous API versions.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Pagination</p>
      </div>
      <div>
        <p>Large API responses are properly paginated.</p>
      </div>
    </div>
  </div>
</div>
<p>You can also <a href="/docs/synthetics/new-relic-synthetics/administration/audit-synthetics-account-changes">use NRQL queries to analyze past changes made via the API</a>.</p>
<h2>Monitor types in API [#api-names]</h2>
<p>These are the <a href="/docs/synthetics/new-relic-synthetics/using-monitors/add-edit-monitors#types-monitors">monitor types</a> and how they're referred to in the API:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Monitor type</p>
      </div>
      <div>
        <p>API name</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>Ping</p>
      </div>
      <div>
        <p><code>SIMPLE</code></p>
      </div>
    </div>
    <div>
      <div>
        <p>Simple browser</p>
      </div>
      <div>
        <p><code>BROWSER</code></p>
      </div>
    </div>
    <div>
      <div>
        <p>Scripted browser</p>
      </div>
      <div>
        <p><code>SCRIPT_BROWSER</code></p>
      </div>
    </div>
    <div>
      <div>
        <p>API test</p>
      </div>
      <div>
        <p><code>SCRIPT_API</code></p>
      </div>
    </div>
  </div>
</div>
<h2>Use the API [#use-api]</h2>
<p>To use the <a href="/docs/apis/synthetics-rest-api">Synthetics REST API</a>, you must have the ability to manage synthetics monitors and use a <a href="/docs/apis/rest-api-v2/getting-started/introduction-new-relic-rest-api-v2#api_key">user key</a> (the REST API key won't work).</p>
<p>This API can be used for all Synthetics monitors. (Additional API methods for <a href="/docs/apis/synthetics-rest-api/monitor-examples/manage-synthetics-monitors-via-rest-api#scripted-api-monitors-api">scripted browser and API test monitors</a> are also available to update the script associated with those monitors.) All Synthetics data is available via the API. API examples show cURL commands.</p>
<p>For US-based accounts, use the following endpoint:</p>
<pre><code>https://synthetics.newrelic.com/synthetics/api
</code></pre>
<p>For <a href="https://docs.newrelic.com/docs/using-new-relic/welcome-new-relic/get-started/introduction-eu-region-data-center#partner-hierarchy">EU-based accounts</a>, use the following endpoint:</p>
<pre><code>https://synthetics.eu.newrelic.com/synthetics/api
</code></pre>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJjYXV0aW9uIn1d">
  <p>The Synthetics REST API limits an account's rate of requests to three requests per second. Requests made in excess of this threshold will return a <code>429</code> response code.</p>
</div>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJjbGFzc05hbWUiLCJ2YWx1ZSI6ImZyZXEtbGluayJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZ2V0LWFsbC1tb25pdG9ycyJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiR2V0IGFsbCBtb25pdG9ycyJ9XQ==">
    <div data-prop-text="title">Get all monitors</div>
    <p>To view a list of all the monitors in your New Relic account, send a GET request to <code>$API_ENDPOINT/v3/monitors</code>. For example:</p>
    <pre><code>curl -v \
     -H 'Api-Key:$API_KEY' $API_ENDPOINT/v3/monitors

</code></pre>
    <pre><code>
&#x3C;https://synthetics.newrelic.com/synthetics/api/v3/monitors/?offset=0&#x26;limit=20>; rel="first", &#x3C;https://synthetics.newrelic.com/synthetics/api/v3/monitors/?offset=40&#x26;limit=20>; rel="last"

</code></pre>The headers include a `Link` to help you easily [page your monitors](/docs/apis/rest-api-v2/requirements/pagination-api-output). For example:
    <pre><code>
curl -v \
     -H 'Api-Key:$API_KEY' $API_ENDPOINT/v3/monitors \
     -G -d 'offset=20&#x26;limit=100'

</code></pre>Query arguments:
    * `offset`: The monitor count offset. Defaults to 0. For example, if you have 40 monitors and you use an offset value of 20, it will return monitors 21-40.
    * `limit`: The number of results per page, maximum 100. Defaults to 20.
    You can include these in your cURL command as follows:
    <pre><code>
{
	"monitors": [
		{
		"id": "2a1bc369-7654-489d-918e-f6g135h7i2jk",
		"name": "monitor1",
		"type": "BROWSER",
		"frequency": 60,
		"uri": "http://example.com",
		"locations": [
			"AWS_US_WEST_1"
				],
		"status": "DISABLED",
		"slaThreshold": 7,
		"options": {},
		"modifiedAt": "2016-09-26T23:12:46.981+0000",
		"createdAt": "2016-09-26T23:12:46.981+0000",
		"userId": 0,
		"apiVersion": "0.2.2"
		}
	],
	"count": 1
}

</code></pre>A successful request will return a `200 OK` response. The [data returned](/docs/apis/synthetics-rest-api/monitor-examples/payload-attributes-synthetics-rest-api#api-attributes) will be a JSON object in the following format:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJjbGFzc05hbWUiLCJ2YWx1ZSI6ImZyZXEtbGluayJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZ2V0LXNwZWNpZmljLW1vbml0b3IifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkdldCBhIHNwZWNpZmljIG1vbml0b3IifV0=">
    <div data-prop-text="title">Get a specific monitor</div>
    <p>To view a single Synthetics monitor, send a GET request to <code>$API_ENDPOINT/v3/monitors/$MONITOR_ID</code>.</p>
    <pre><code>curl -v \
     -H 'Api-Key:$API_KEY' $API_ENDPOINT/v3/monitors/$MONITOR_ID

</code></pre>An invalid monitor ID will return `404 Not Found: The specified monitor doesn't exist`.
    <pre><code>
{
  "id": UUID,
  "name": string,
  "type": string,
  "frequency": integer,
  "uri": string,
  "locations": array of strings,
  "status": string,
  "slaThreshold": double,
  "userId": integer,
  "apiVersion": string
}

</code></pre>A successful request will return a `200 OK` response. The [data returned](/docs/apis/synthetics-rest-api/monitor-examples/payload-attributes-synthetics-rest-api#api-attributes) will be a JSON object in the following format:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJjbGFzc05hbWUiLCJ2YWx1ZSI6ImZyZXEtbGluayJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY3JlYXRlLW1vbml0b3IifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkNyZWF0ZSBhIG1vbml0b3IifV0=">
    <div data-prop-text="title">Create a monitor</div>
    <p>To add a new monitor to your Synthetics account, send a POST request to <code>$API_ENDPOINT/v3/monitors</code> with a JSON payload that describes the monitor.</p>
    <p>All fields in the following example are required unless stated otherwise:</p>
    <pre><code>{
"name": string [required],
"type": string (SIMPLE, BROWSER, SCRIPT_API, SCRIPT_BROWSER) [required],
"frequency": integer (minutes) [required, must be one of 1, 5, 10, 15, 30, 60, 360, 720, or 1440],
"uri": string [required for SIMPLE and BROWSER type],
"locations": array of strings [at least one required],
"status": string (ENABLED, MUTED, DISABLED) [required],
"slaThreshold": double,
"options": {
  "validationString": string [only valid for SIMPLE and BROWSER types],
  "verifySSL": boolean (true, false) [only valid for SIMPLE and BROWSER types],
  "bypassHEADRequest": boolean (true, false) [only valid for SIMPLE types],
  "treatRedirectAsFailure": boolean (true, false) [only valid for SIMPLE types]
  }
}

</code></pre>A successful request will return a `201 Created` response, with the URI of the newly-created monitor specified in the `location` header. Possible error codes include:
    * `400 Bad Request`: One or more of the monitor values is invalid, or the format of the request is invalid. For example: the frequency is out of bounds or one or more of the specified locations is invalid. (See the error message in the body of the response.)
    * `402 Payment Required`: Creating the monitor will increase your scheduled checks past your account's purchased check limit.
    <pre><code>
curl -v \
     -X POST -H 'Api-Key:$API_KEY' \
     -H 'Content-Type: application/json' $API_ENDPOINT/v3/monitors \
     -d '{ "name" : "monitor1", "frequency" : 15, "uri" : "http://my-uri.com", "locations" : [ "AWS_US_WEST_1" ], "type" : "browser", "status" : "enabled", "slaThreshold" : "1.0"}'

</code></pre>In addition, to **add the script for a scripted monitor** via the REST API, call an [additional API endpoint](/docs/apis/synthetics-rest-api/monitor-examples/manage-synthetics-monitor-scripts-rest-api) to send the script for the monitor just created. If you are using private locations with [verified script execution](/docs/synthetics/new-relic-synthetics/private-locations/verified-script-execution-private-locations) enabled, see [script locations with verified script execution](#scriptlocations).
    Replace the [Synthetics REST API attributes](/docs/apis/synthetics-rest-api/monitor-examples/payload-attributes-synthetics-rest-api) in the following example with your specific values:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJjbGFzc05hbWUiLCJ2YWx1ZSI6ImZyZXEtbGluayJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidXBkYXRlLW1vbml0b3IifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IlVwZGF0ZSBhbiBleGlzdGluZyBtb25pdG9yIn1d">
    <div data-prop-text="title">Update an existing monitor</div>
    <p>To update an existing monitor in New Relic, send a PUT request to <code>$API_ENDPOINT/v3/monitors/$MONITOR_ID</code>. In addition, for scripted monitors, follow the procedures to <a href="/docs/apis/synthetics-rest-api/monitor-examples/manage-synthetics-monitor-scripts-rest-api">update the BASE64 encoded script</a>.</p>
    <p>All fields are required. However, the <code>TYPE</code> of the monitor <strong>cannot</strong> be changed.</p>
    <p>Use a specific monitor ID, and replace the <a href="/docs/apis/synthetics-rest-api/monitor-examples/payload-attributes-synthetics-rest-api">Synthetics REST API attributes</a> with your specific values.</p>
    <pre><code>curl -v \
     -X PUT -H 'Api-Key:$API_KEY' \
     -H 'Content-Type: application/json' $API_ENDPOINT/v3/monitors/$MONITOR_ID \
     -d '{ "name" : "updated monitor name", "type": "monitor type", "frequency" : 15, "uri" : "http://my-uri.com/", "locations" : [ "AWS_US_WEST_1" ], "status" : "enabled", "slaThreshold": "7.0" }'

</code></pre>PUT requests are intended to replace target entities, so all attributes required in the JSON payload when [creating a new monitor](/docs/apis/synthetics-rest-api/monitor-examples/manage-synthetics-monitors-via-rest-api#add-simple-ping-monitor) are also required when updating an existing monitor.
    A successful request will return a `204 No Content` response, with an empty body. Possible error codes include:
    * `400 Bad Request`: One or more of the monitor values is invalid, or the format of the request is invalid. For example, the frequency is out of bounds or one or more of the specified locations is invalid. (See the error message in the body of the response.)
    * `404 Not Found`: The specified monitor does not exist.
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJjbGFzc05hbWUiLCJ2YWx1ZSI6ImZyZXEtbGluayJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicGF0Y2gtbW9uaXRvciJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiUGF0Y2ggYW4gZXhpc3RpbmcgbW9uaXRvciJ9XQ==">
    <div data-prop-text="title">Patch an existing monitor</div>
    <p>To patch an existing monitor in New Relic, send a PATCH request to <code>$API_ENDPOINT/v3/monitors/$MONITOR_ID</code>.</p>
    <p>Use a specific monitor ID, and replace the <a href="/docs/apis/synthetics-rest-api/monitor-examples/payload-attributes-synthetics-rest-api">Synthetics REST API attributes</a> with your specific values.</p>
    <pre><code>curl -v \
     -X PATCH -H 'Api-Key:$API_KEY' \
     -H 'Content-Type: application/json' $API_ENDPOINT/v3/monitors/$MONITOR_ID \
     -d '{ "name" : "updated monitor name" }'

</code></pre>PATCH requests are intended to update individual attributes of your New Relic Synthetics monitor rather than updating the entire entity, so you may provide only the attributes you want to update.
    A successful request will return a `204 No Content` response, with an empty body. Possible error codes include:
    * `400 Bad Request`: One or more of the monitor values is invalid, or the format of the request is invalid. For example, the frequency is out of bounds, or one or more of the specified locations is invalid. (See the error message in the body of the response.)
    * `404 Not Found`: The specified monitor does not exist.
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJjbGFzc05hbWUiLCJ2YWx1ZSI6ImZyZXEtbGluayJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZGVsZXRlLW1vbml0b3IifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkRlbGV0ZSBhbiBleGlzdGluZyBtb25pdG9yIn1d">
    <div data-prop-text="title">Delete an existing monitor</div>
    <p>To delete an existing monitor in New Relic Synthetics, send a DELETE request to $API_ENDPOINT<code>/v3/monitors/$MONITOR_ID</code>:</p>
    <pre><code>curl -v \
     -H 'Api-Key:$API_KEY' \
     -X DELETE $API_ENDPOINT/v3/monitors/$MONITOR_ID

</code></pre>A successful request will return a `204 No Content` response, with an empty body. An unsuccessful request will return the response `404 Not Found`: The specified monitor does not exist.
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJjbGFzc05hbWUiLCJ2YWx1ZSI6ImZyZXEtbGluayJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibGlzdC1sb2NhdGlvbnMifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkdldCBhIGxpc3Qgb2YgdmFsaWQgbG9jYXRpb25zIn1d">
    <div data-prop-text="title">Get a list of valid locations</div>
    <p>To retrieve the list of valid locations in New Relic Synthetics, use the following command:</p>
    <pre><code>curl -v \
     -X GET -H 'Api-Key:$API_KEY' $API_ENDPOINT/v1/locations

</code></pre>
  </div>
</div>
<h2>Script API for scripted browser and API test monitors [#scripted-api-monitors-api]</h2>
<p>In addition to the general API, there are several API methods for the scripted Browsers (<code>SCRIPT_BROWSER</code>) and API test browsers (<code>SCRIPT_API</code>). These examples show cURL commands.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZ2V0LWFsbC1tb25pdG9ycyJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiR2V0IG1vbml0b3Igc2NyaXB0In1d">
    <div data-prop-text="title">Get monitor script</div>
    <p>To view the script associated with a specific <code>SCRIPT_BROWSER</code> or <code>SCRIPT_API</code> monitor in New Relic Synthetics for your account, send a GET request to $API_ENDPOINT<code>/v3/monitors/$MONITOR_ID/script</code>. For example:</p>
    <pre><code>curl -v
     -H 'Api-Key: $API_KEY' 
     $API_ENDPOINT/v3/monitors/$MONITOR_ID/script

</code></pre>Possible error codes include:
    * `403 Forbidden:` The specified monitor is not of type SCRIPT_BROWSER or SCRIPT_API.
    * `404 Not Found:` The specified monitor doesn't exist or the script associated with the monitor doesn't exist.
    <pre><code>
{
  "scriptText": BASE64 encoded string
}

</code></pre>A successful request will return a `200 OK` response. The data returned will be a JSON object in the following format:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicHJvY2VkdXJlIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJBZGQgc2NyaXB0ZWQgbW9uaXRvciJ9XQ==">
    <div data-prop-text="title">Add scripted monitor</div>
    <p>To add a new scripted monitor to New Relic Synthetics with the REST API:</p>
    <ol>
      <li>
        <p>Follow <a href="/docs/apis/synthetics-rest-api/monitor-examples/manage-synthetics-monitors-rest-api#create-monitor">standard API procedures to add a new monitor</a>, and identify the <code>type</code> as a <code>SCRIPT_BROWSER</code> or <code>SCRIPT_API</code>.</p>
      </li>
      <li>
        <p>Update the new monitor with a BASE64 encoded version of the script to the <code>$MONITOR_UUID/script</code> endpoint.</p>
        <p>For more information, refer to the <a href="#sample-script">example</a>.</p>
        <p>If you are using private locations with <a href="/docs/synthetics/new-relic-synthetics/private-locations/verified-script-execution-private-locations">verified script execution</a> enabled, see <a href="#scriptlocations">script locations with verified script execution</a>.</p>
      </li>
    </ol>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidXBkYXRlLW1vbml0b3Itc2NyaXB0In0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJVcGRhdGUgbW9uaXRvciBzY3JpcHQifV0=">
    <div data-prop-text="title">Update monitor script</div>
    <p>To update the script associated with a specific <code>SCRIPT_BROWSER</code> or <code>SCRIPT_API</code> monitor in New Relic Synthetics for your account, send a PUT request to $API_ENDPOINT<code>/v3/monitors/$MONITOR_ID/script</code> with a JSON payload that contains the <code>scriptText</code> (required).</p>
    <pre><code>scriptPayload='{"scriptText":BASE64 encoded string}'


curl -v -X PUT \
     -H 'Api-Key:$API_KEY' \
     -H 'Content-Type: application/json' \
     $API_ENDPOINT/v3/monitors/$MONITOR_UUID/script \
     -d $scriptPayload

</code></pre>If you are using private locations with [verified script execution](/docs/synthetics/new-relic-synthetics/private-locations/verified-script-execution-private-locations) enabled, see [script locations with verified script execution](#scriptlocations).
    A successful request will return a `204 No Content` response with an empty body. Possible error codes include:
    * `400 Bad Request:` Invalid BASE64 encoded string for `scriptText` or `hmac`.
    * `403 Forbidden:` The specified monitor is not of the type `SCRIPT_BROWSER` or `SCRIPT_API`.
    * `404 Not Found:` The specified monitor does not exist.
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoic2NyaXB0bG9jYXRpb25zIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJVc2luZyBwcml2YXRlIGxvY2F0aW9uIHNjcmlwdHMgd2l0aCB2ZXJpZmllZCBzY3JpcHQgZXhlY3V0aW9uIn1d">
    <div data-prop-text="title">Using private location scripts with verified script execution</div>
    <p>When creating or updating monitors for private locations that have <a href="/docs/synthetics/new-relic-synthetics/private-locations/verified-script-execution-private-locations">verified script execution</a> turned on, you must use <code>scriptLocations</code> to set the password:</p>
    <pre><code>{
  "scriptText": BASE64 encoded String,
  "scriptLocations": [
    {
      "name": Location name,
      "hmac" BASE64 encoded String of SHA256 HMAC for location
    }
  ]
}

</code></pre>&#x3C;Callout variant="important">
    You must remove the last newline character from both the script and the calculated HMAC value before encoding in BASE64.
    &#x3C;/Callout>
    Calculation steps:
    1. Calculate the HMAC value from the script. One way is to use:
    `cat script | openssl dgst -sha256 -hmac "password" > hmac`
    2. Remove the newline character if one was added by openssl.
    3. Encode the HMAC in BASE64 without line breaks.
    <pre><code>
curl -v
	-X PUT -H 'Api-Key: '$API_KEY'
	-H 'content-type: application/json'
	$API_ENDPOINT}/v3/monitors/$MONITOR_ID/script
	-d '{ "scriptText": "dmFyIGFzc2VydCA9IHJlcXVpcmUoJ2Fzc2VydCcpOw0KYXNzZXJ0LmVxdWFsKCcxJywgJzEnKTs=","scriptLocations": [ { "name": "my_vse_enabled_location", "hmac": "MjhiNGE4MjVlMDE1N2M4NDQ4MjNjNDFkZDEyYTRjMmUzZDE3NGJlNjU0MWFmOTJlMzNiODExOGU2ZjhkZTY4ZQ=="} ]}'

</code></pre>This example uses `password` as the password for the `scriptLocation`:
    <pre><code>
var assert = require('assert');
assert.equal('1', '1');

</code></pre>The password used to generate the HMAC string must match the password set for the private location. If you have multiple locations with [Verified script execution](/docs/synthetics/new-relic-synthetics/private-locations/verified-script-execution-private-locations) enabled each location must have the [HMAC](https://en.wikipedia.org/wiki/Hash-based_message_authentication_code) calculated. When generating the HMAC string, use the SHA256 algorithm with the script and password.
    Here's an example for the script:
  </div>
</div>
<h2>Scripted browser example</h2>
<p>Here is an example of using New Relic's REST API and the bash script to create a scripted browser monitor.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoic2FtcGxlLXNjcmlwdCJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiU2NyaXB0ZWQgYnJvd3NlciBBUEkgZXhhbXBsZSJ9XQ==">
    <div data-prop-text="title">Scripted browser API example</div>
    <p>The following example shows cURL commands to create a scripted browser monitor.</p>
    <ul>
      <li>
        <p>At the top of the script, replace the variables with your specific values.</p>
      </li>
      <li>
        <p>For the <code>scriptfile</code> variable, identify the filename for the script to be created. Here is a sample script that can be saved as <code>sample_synth_script.js</code> to use in the example:</p>
        <pre><code>var assert = require("assert");
$browser.get("http://example.com").then(function(){ 
  // Check the H1 title matches "Example Domain" 
  return $browser.findElement($driver.By.css("h1")).then(function(element){ 
    return element.getText().then(function(text){ 
      assert.equal("Example Domain", text, "Page H1 title did not match"); 
    }); 
  }); 
}).then(function(){ 
  // Check that the external link matches "http://www.iana.org/domains/example" 
  return $browser.findElement($driver.By.css("div > p > a")).then(function(element){ 
    return element.getAttribute("href").then(function(link){ 
      assert.equal("http://www.iana.org/domains/example", link, "More information link did not match"); 
    }); 
  }); 
});
</code></pre>
      </li>
    </ul>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiYmFzaC1zY3JpcHQifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkJhc2ggc2NyaXB0IGV4YW1wbGUifV0=">
    <div data-prop-text="title">Bash script example</div>
    <p>This example shows the bash script that will create the <code>SCRIPTED_BROWSER</code> monitor.</p>
    <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
      <p>In some cases you may want to use <code>-w 0</code>, which will disable line wrapping: <code>base64 -w 0 $scriptfile</code></p>
    </div>
    <pre><code>#!/bin/bash

# Admin API key from your account settings
adminAPIKey=''
# Other attributes found at https://docs.newrelic.com/docs/apis/synthetics-rest-api/monitor-examples/attributes-synthetics-rest-api#api-attributes
monitorName='Test API Script'
monitorType='SCRIPT_BROWSER'
frequency=1440
locations='"AWS_US_WEST_1", "AWS_US_EAST_1"'
slaThreshold=7.0
# Location of the file with your script
scriptfile=sample_synth_script.js

# Test that the script file exists (does not validate content)
if [ -e "$scriptfile" ]
then
  script=$(cat "$scriptfile")

  payload="{  \"name\" : \"$monitorName\", \"frequency\" : $frequency,    \"locations\" : [ $locations ],   \"status\" : \"ENABLED\",  \"type\" : \"$monitorType\", \"slaThreshold\" : $slaThreshold, \"uri\":\"\"}"
  echo "Creating monitor"

  # Make cURL call to API and parse response headers to get monitor UUID
  shopt -s extglob # Required to trim whitespace; see below
  while IFS=':' read key value; do
    # trim whitespace in "value"
    value=${value##+([[:space:]])}; value=${value%%+([[:space:]])}
    case "$key" in
        Location) LOCATION="$value"
                ;;
        HTTP*) read PROTO STATUS MSG &#x3C;&#x3C;&#x3C; "$key{$value:+:$value}"
                ;;
    esac
  done &#x3C; &#x3C;(curl -sS -i  -X POST -H "Api-Key:$API_KEY" -H 'Content-Type: application/json' https://synthetics.newrelic.com/synthetics/api/v3/monitors -d "$payload")

  # Validate monitor creation &#x26; add script unless it failed
  if [ $STATUS = 201 ]; then
    echo "Monitor created, $LOCATION "
    echo "Uploading script"
      # base64 encode script
      encoded=`echo "$script" | base64`
      scriptPayload='{"scriptText":"'$encoded'"}'
        curl -s -X PUT -H "Api-Key:$API_KEY" -H 'Content-Type: application/json' "$LOCATION/script" -d $scriptPayload
        echo "Script uploaded"
  else
    echo "Monitor creation failed"
  fi

else
  echo "script file not found, not creating monitor"
fi

</code></pre>
  </div>
</div>
