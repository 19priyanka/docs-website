
<p>New Relic has a <a href="http://www.simplecloud.info/">System for Cross-domain Identity Management (SCIM)</a> service provider to easily manage the users in your New Relic account. If your identity provider supports SCIM, it can be configured to send SCIM requests to New Relic, automatically provisioning your groups and users. When you add a new user or remove a user from your identity provider, those same actions will be performed in your New Relic account.</p>
<h2>SCIM service provider [#scim-provider]</h2>
<p>New Relic’s SCIM service provider follows the <a href="http://www.simplecloud.info/">SCIM 2.0 API</a> as described in <a href="https://tools.ietf.org/html/rfc7643">RFCs 7643</a> and <a href="https://tools.ietf.org/html/rfc7644">7644</a>. You do not need to implement all aspects of the SCIM 2.0 specification to integrate your user information with New Relic. In fact, the New Relic service provider itself does not implement all aspects of the specification. This document describes the features from the specification available for an integration with New Relic.</p>
<h2>Authentication</h2>
<p>Authentication is done using a bearer token. Your New Relic account representative will give you the bearer token to use as part of the setup process, or can provide a new one if your existing token is lost.</p>
<h2>Supported resources</h2>
<p>The New Relic service provider supports the following SCIM resources: <code>Group</code> , <code>User</code> , <code>Service provider config</code> , <code>Resource type</code> and <code>Schema</code>. <code>Bulk</code> and <code>Search</code> are not supported. For more information on how the RFC describes the resource endpoints, see <a href="https://tools.ietf.org/html/rfc7644#section-3.2">RFC 7644 SCIM Protocol Specification</a>.</p>
<h2>Schemas</h2>
<p>New Relic uses a subset of the available fields in the SCIM core schema. Other SCIM fields are ignored if they are included in incoming requests. The fields used by New Relic are:</p>
<p><code>Group</code>:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>SCIM Field Name</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>displayName</code></p>
      </div>
      <div>
        <p><strong>Required.</strong> Name of the group.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>members</code></p>
      </div>
      <div>
        <p>List of users in the group.</p>
      </div>
    </div>
  </div>
</div>
<p><code>User</code>:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>SCIM Field Name</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>externalId</code></p>
      </div>
      <div>
        <p>Unique identifier for the user used by your system.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>userName</code></p>
      </div>
      <div>
        <p><strong>Required.</strong> Unique identifier for the user within New Relic’s system. Use the user’s email address.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>name.familyName</code></p>
      </div>
      <div>
        <p>Last name of the user.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>name.givenName</code></p>
      </div>
      <div>
        <p>First name of the user.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>emails</code> or <code>emails.value</code></p>
      </div>
      <div>
        <p><strong>Required.</strong> Email address of the user.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>timezone</code></p>
      </div>
      <div>
        <p><strong>Required.</strong> Time zone of the user in IANA Time Zone database format, also known as the "Olson" time zone database format (e.g., "America/Los_Angeles").</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>active</code></p>
      </div>
      <div>
        <p><strong>Required.</strong> Boolean indicating whether or not the user should be active or inactive within New Relic.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>members</code></p>
      </div>
      <div>
        <p>List of groups to which the user belongs.</p>
      </div>
    </div>
  </div>
</div>
<h2>Supported actions</h2>
<p>SCIM provides several options for manipulating groups and users. The New Relic service provider supports the following options.</p>
<p>When configuring, be aware that:</p>
<ul>
  <li>Only simple filtering is supported. The <code>eq</code> operator may be used with a basic filter expression. For example, <code>“displayName eq "Example Group 1”</code>. Other operators are not supported.</li>
  <li><code>PUT</code> updates do not require that all fields be included. Fields that are not included will not be changed. When doing a <code>PUT</code>, if a required field already has the appropriate value, it is not necessary to include the field.</li>
</ul>
<p>Supported actions are:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY3JlYXRlLWdyb3VwIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJDcmVhdGUgZ3JvdXAifV0=">
    <div data-prop-text="title">Create group</div>
    <p>Example request:</p>
    <pre><code>POST /Groups

{
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:Group"
  ],
  "displayName": "Example Group 1",
  "members": []
}

</code></pre>
    <pre><code>
201 Created

{
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:Group"
  ],
  "id": "d0652232-b14f-434d-9c6f-36de7e1ab010",
  "displayName": "Example Group 1",
  "meta": {
    "resourceType": "Group",
    "created": "2019-11-08T21:33:13.055Z",
    "lastModified": "2019-11-08T21:33:13.055Z"
  },
  "members": []
}

</code></pre>Example response:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZ2V0LWdyb3VwIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJHZXQgZ3JvdXAifV0=">
    <div data-prop-text="title">Get group</div>
    <p>Example request:</p>
    <pre><code>GET /Groups/YOUR_GROUP_ID

</code></pre>
    <pre><code>
200 OK

{
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:Group"
  ],
  "id": "d0652232-b14f-434d-9c6f-36de7e1ab010",
  "displayName": "Example Group 1",
  "meta": {
    "resourceType": "Group",
    "created": "2019-11-08T21:33:13.055Z",
    "lastModified": "2019-11-08T21:33:13.055Z"
  },
  "members": []
}

</code></pre>Example response:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZ2V0LWdyb3VwLXF1ZXJ5In0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJHZXQgZ3JvdXAgYnkgcXVlcnkifV0=">
    <div data-prop-text="title">Get group by query</div>
    <p>Example request:</p>
    <pre><code>GET /Groups?filter=displayName eq "Example Group 1"

</code></pre>
    <pre><code>
200 OK

{
  "totalResults": 1,
  "schemas": [
    "urn:ietf:params:scim:api:messages:2.0:ListResponse"
  ],
  "Resources": [{
    "schemas": [
      "urn:ietf:params:scim:schemas:core:2.0:Group"
    ],
    "id": "d0652232-b14f-434d-9c6f-36de7e1ab010",
    "displayName": "Example Group 1",
    "meta": {
      "resourceType": "Group",
      "created": "2019-11-08T21:33:13.055Z",
      "lastModified": "2019-11-08T21:33:13.055Z"
    },
    "members": []
  }]
}

</code></pre>Example response:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidXBkYXRlLWdyb3VwLXB1dCJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiVXBkYXRlIGdyb3VwIHdpdGggUFVUIn1d">
    <div data-prop-text="title">Update group with PUT</div>
    <p>In the request, include the fields that you want to change. If you include the <code>members</code> field, the group’s users will be adjusted to match the contents of the members field. Example request:</p>
    <pre><code>PUT /Groups/YOUR_GROUP_ID

{
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:Group"
  ],
  "displayName": "Example Group 1a"
}

</code></pre>
    <pre><code>
200 OK

{
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:Group"
  ],
  "id": "d0652232-b14f-434d-9c6f-36de7e1ab010",
  "displayName": "Example Group 1a",
  "meta": {
    "resourceType": "Group",
    "created": "2019-11-08T21:33:13.055Z",
    "lastModified": "2019-11-08T22:47:14.019Z"
  },
  "members": []
}

</code></pre>Example response:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidXBkYXRlLWdyb3VwLXBhdGNoLW5vbi1tZW1iZXIifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IlVwZGF0ZSBncm91cCB3aXRoIFBBVENIIChOb24tbWVtYmVyIGZpZWxkcykifV0=">
    <div data-prop-text="title">Update group with PATCH (Non-member fields)</div>
    <p>Example request:</p>
    <pre><code>PATCH /Groups/YOUR_GROUP_ID

{
  "schemas": [
    "urn:ietf:params:scim:api:messages:2.0:PatchOp"
  ],
  "Operations": [{
    "op": "Replace",
    "path": "displayName",
    "value": "Example Group 1b"
  }]
}

</code></pre>
    <pre><code>
204 No Content

</code></pre>Example response:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidXBkYXRlLWdyb3VwLXBhdGNoLWFkZC1tZW1iZXJzIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJVcGRhdGUgZ3JvdXAgd2l0aCBQQVRDSCAoQWRkIG1lbWJlcnMpIn1d">
    <div data-prop-text="title">Update group with PATCH (Add members)</div>
    <p>Example request:</p>
    <pre><code>PATCH /Groups/YOUR_GROUP_ID

{
  "schemas": [
    "urn:ietf:params:scim:api:messages:2.0:PatchOp"
  ],
  "Operations": [{
    "op": "Add",
    "path": "members",
    "value": [{
      "value": "f0cbc276-16c9-4d1a-abc0-1856b0c74224"
    }]
  }]
}

</code></pre>
    <pre><code>
204 No Content

</code></pre>Example response:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidXBkYXRlLWdyb3VwLXBhdGNoLXJlbW92ZS1tZW1iZXJzIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJVcGRhdGUgZ3JvdXAgd2l0aCBQQVRDSCAoUmVtb3ZlIG1lbWJlcnMpIn1d">
    <div data-prop-text="title">Update group with PATCH (Remove members)</div>
    <p>Example request:</p>
    <pre><code>PATCH /Groups/YOUR_GROUP_ID

{
  "schemas": [
    "urn:ietf:params:scim:api:messages:2.0:PatchOp"
  ],
  "Operations": [{
    "op": "Remove",
    "path": "members",
    "value": [{
      "value": "f0cbc276-16c9-4d1a-abc0-1856b0c74224"
    }]
  }]
}

</code></pre>
    <pre><code>
204 No Content

</code></pre>Example response:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZGVsZXRlLWdyb3VwIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJEZWxldGUgZ3JvdXAifV0=">
    <div data-prop-text="title">Delete group</div>
    <p>Example request:</p>
    <pre><code>DELETE /Groups/YOUR_GROUP_ID

</code></pre>
    <pre><code>
204 No Content

</code></pre>Example response:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY3JlYXRlLXVzZXIifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkNyZWF0ZSB1c2VyIn1d">
    <div data-prop-text="title">Create user</div>
    <p>Example request:</p>
    <pre><code>POST /Users

{
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:User"
  ],
  "externalId": "external-id-1",
  "userName": "example-user-1@test.com",
  "name": {
    "familyName": "User 1",
    "givenName": "Example"
  },
  "emails": [{
    "value": "example-user-1@test.com",
    "primary": true
  }],
  "timezone": "America/Los_Angeles",
  "active": true,
  "members": []
}

</code></pre>
    <pre><code>
201 Created

{
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:User"
  ],
  "id": "f0cbc276-16c9-4d1a-abc0-1856b0c74224",
  "externalId": "external-id-1",
  "userName": "example-user-1@test.com",
  "name": {
    "familyName": "User 1",
    "givenName": "Example"
  },
  "emails": [{
    "value": "example-user-1@test.com",
    "primary": true
  }],
  "timezone": "America/Los_Angeles",
  "active": true,
  "meta": {
    "resourceType": "User",
    "created": "2019-11-08T22:07:12.477Z",
    "lastModified": "2019-11-08T22:07:12.477Z"
  },
  "members": []
}

</code></pre>Example response:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZ2V0LXVzZXIifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkdldCB1c2VyIn1d">
    <div data-prop-text="title">Get user</div>
    <p>Example request:</p>
    <pre><code>GET /Users/YOUR_USER_ID

</code></pre>
    <pre><code>
200 OK

{
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:User"
  ],
  "id": "f0cbc276-16c9-4d1a-abc0-1856b0c74224",
  "externalId": "external-id-1",
  "userName": "example-user-1@test.com",
  "name": {
    "familyName": "User 1",
    "givenName": "Example"
  },
  "emails": [{
    "value": "example-user-1@test.com",
    "primary": true
  }],
  "timezone": "America/Los_Angeles",
  "active": true,
  "meta": {
    "resourceType": "User",
    "created": "2019-11-08T22:07:12.477Z",
    "lastModified": "2019-11-08T22:07:12.477Z"
  },
  "members": []
}

</code></pre>Example response:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZ2V0LXVzZXItcXVlcnkifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkdldCB1c2VyIGJ5IHF1ZXJ5In1d">
    <div data-prop-text="title">Get user by query</div>
    <p>Example request:</p>
    <pre><code>GET /Users?filter=externalId eq "external-id-1"

</code></pre>
    <pre><code>
200 OK

{
  "totalResults": 1,
  "schemas": [
    "urn:ietf:params:scim:api:messages:2.0:ListResponse"
  ],
  "Resources": [{
    "schemas": [
      "urn:ietf:params:scim:schemas:core:2.0:User"
    ],
    "id": "f0cbc276-16c9-4d1a-abc0-1856b0c74224",
    "externalId": "external-id-1",
    "userName": "example-user-1@test.com",
    "name": {
      "familyName": "User 1",
      "givenName": "Example"
    },
    "emails": [{
      "value": "example-user-1@test.com",
      "primary": true
    }],
    "timezone": "America/Los_Angeles",
    "active": true,
    "meta": {
      "resourceType": "User",
      "created": "2019-11-08T22:07:12.477Z",
      "lastModified": "2019-11-08T22:07:12.477Z"
    },
    "members": []
  }]
}

</code></pre>Example response:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidXBkYXRlLXVzZXItcHV0In0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJVcGRhdGUgdXNlciB3aXRoIFBVVCJ9XQ==">
    <div data-prop-text="title">Update user with PUT</div>
    <p>In the request, include the fields that you want to change. If you include the <code>members</code> field, the user’s groups will be adjusted to match the contents of the members field. Example request:</p>
    <pre><code>PUT /Users/YOUR_USER_ID

{
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:User"
  ],
  "name": {
    "familyName": "User 1A",
    "givenName": "Example"
  }
}

</code></pre>
    <pre><code>
200 OK

{
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:User"
  ],
  "id": "f0cbc276-16c9-4d1a-abc0-1856b0c74224",
  "externalId": "external-id-1",
  "userName": "example-user-1@test.com",
  "name": {
    "familyName": "User 1A",
    "givenName": "Example"
  },
  "emails": [{
    "value": "example-user-1@test.com",
    "primary": true
  }],
  "timezone": "America/Los_Angeles",
  "active": true,
  "meta": {
    "resourceType": "User",
    "created": "2019-11-08T22:07:12.477Z",
    "lastModified": "2019-11-08T22:28:33.552Z"
  },
  "members": []
}

</code></pre>Example response:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidXBkYXRlLXVzZXItcGF0Y2gifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IlVwZGF0ZSB1c2VyIHdpdGggUEFUQ0gifV0=">
    <div data-prop-text="title">Update user with PATCH</div>
    <p>Example request:</p>
    <pre><code>PATCH /Users/YOUR_USER_ID

{
  "schemas": [
    "urn:ietf:params:scim:api:messages:2.0:PatchOp"
  ],
  "Operations": [{
    "op": "Replace",
    "path": "active",
    "value": "false"
  }]
}

</code></pre>
    <pre><code>
204 No Content

</code></pre>Example response:
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZGVsZXRlLXVzZXIifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkRlbGV0ZSB1c2VyIn1d">
    <div data-prop-text="title">Delete user</div>
    <p>Example request:</p>
    <pre><code>DELETE /Users/YOUR_USER_ID

</code></pre>
    <pre><code>
204 No Content

</code></pre>Example response:
  </div>
</div>
<h2>Deviations from the RFC [#rfc-deviations]</h2>
<p>This section describes areas where the New Relic SCIM service provider deviates from the SCIM protocol <a href="https://tools.ietf.org/html/rfc7644">RFC 7644</a>. Section numbers refer to RFC section numbers.</p>
<p>Items in this section could change as we work to bring our service provider into full compliance with the RFC.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>RFC section name</p>
      </div>
      <div>
        <p>RFC section number</p>
      </div>
      <div>
        <p>Deviation description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>Creating Resources</p>
      </div>
      <div>
        <p><a href="https://tools.ietf.org/html/rfc7644#section-3.3">3.3.</a></p>
      </div>
      <div>
        <ul>
          <li>The <code>meta.location</code> field is not set.</li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p>Filtering</p>
      </div>
      <div>
        <p><a href="https://tools.ietf.org/html/rfc7644#section-3.4.2.2">3.4.2.2.</a></p>
      </div>
      <div>
        <ul>
          <li>The only currently supported operator is <code>eq</code>.</li>
          <li>Field names are case sensitive.</li>
          <li>String attributes are compared in a case sensitive manner.</li>
          <li>Prefixing the field name with the schema is not supported. For example, <code>filter=urn:ietf:params:scim:schemas:core:2.0:User:userName eq "johnsmith"</code> will not work.</li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p><code>/Me</code> Authenticated Subject Alias</p>
      </div>
      <div>
        <p><a href="https://tools.ietf.org/html/rfc7644#section-3.11">3.11.</a></p>
      </div>
      <div>
        <ul>
          <li><code>GET</code> with the <code>/Me</code> resource returns a <code>404 Not Found</code>.</li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p>Service Provider Configuration Endpoints</p>
      </div>
      <div>
        <p><a href="https://tools.ietf.org/html/rfc7644#section-4">4.</a></p>
      </div>
      <div>
        <ul>
          <li>The service provider feature discovery endpoints do not support filtering.</li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p>Bearer Token and Cookie Considerations</p>
      </div>
      <div>
        <p><a href="https://tools.ietf.org/html/rfc7644#section-7.4">7.4.</a></p>
      </div>
      <div>
        <ul>
          <li>Bearer tokens do not have a set expiration date.</li>
        </ul>
      </div>
    </div>
  </div>
</div>
