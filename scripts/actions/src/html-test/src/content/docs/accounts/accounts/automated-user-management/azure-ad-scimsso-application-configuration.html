
<p>This guide provides Azure AD-specific details on how to configure the New Relic Azure AD SCIM/SSO application. This connects your organization's users to New Relic, and allows them to use single sign-on into New Relic. This guide is meant to be used along with the <a href="https://docs.newrelic.com/docs/assign-users-automated-provisioning-allow-single-sign">main automated provisioning guide</a>.</p>
<h2>Add SCIM/SSO application [#add-app]</h2>
<p>Azure AD provides an application gallery, which includes various integrations for Azure AD, including the ones that New Relic offers. Add the New Relic SCIM/SSO application to your list of applications.</p>
<ol>
  <li>Go to the Azure Active Directory admin center, and sign in if necessary. <a href="https://aad.portal.azure.com/">https://aad.portal.azure.com/</a></li>
  <li>Click on <strong>All services</strong> in the left hand menu.</li>
  <li>In the main pane, click on <strong>Enterprise applications</strong>.</li>
  <li>Click on <strong>+New Application</strong>.</li>
  <li>Find our SCIM/SSO application by entering <strong>New Relic</strong> in the name search box, and click on the application <strong>New Relic by Organization</strong>.</li>
  <li>Click on <strong>Add</strong>.</li>
</ol>
<p>Continue with the following section to connect the New Relic SCIM/SSO application to New Relic.</p>
<h2>Configure connection [#configure]</h2>
<p>Configure the New Relic SCIM/SSO application to automatically provision your users to New Relic.</p>
<ol>
  <li>From the New Relic SCIM/SSO application page, click on the <strong>Provisioning</strong> link in the sidebar.</li>
  <li>In the main pane, click on <strong>Get started</strong>.</li>
  <li>In the <strong>Provisioning Mode</strong> pick-list, choose <strong>Automatic</strong>.</li>
  <li>In the <strong>Admin credentials</strong> section, fill the <strong>Tenant URL</strong> and <strong>Secret token</strong> field with the values provided to you by New Relic. (If you don't have the secret token, you can get that from your New Relic account representative.)</li>
  <li>To verify you can connect to New Relic, click <strong>Test Connection</strong>.</li>
  <li>When you see a message indicating verification success, click <strong>Save</strong>.</li>
</ol>
<p>The New Relic SCIM/SSO application can now connect with New Relic. Continue with the following section to configure the provisioning rules.</p>
<h2>Configure provisioning rules</h2>
<p>Initially, nothing is configured to be sent to New Relic. You must configure Azure AD to send changes for user creation, updates, and deactivation.</p>
<p>Go to the <strong>Provisioning</strong> page and complete the following:</p>
<ol>
  <li>
    <p>Expand the <strong>Mappings</strong> section.</p>
  </li>
  <li>
    <p>Click <strong>Provision Azure Active Directory Users</strong>.</p>
  </li>
  <li>
    <p>Verify the <strong>Target Object Actions</strong> <strong>Create</strong> <strong>Update</strong> and <strong>Delete</strong> checkboxes are all checked.</p>
  </li>
  <li>
    <p>Verify the <strong>Attribute Mappings</strong> look correct for your environment. Each of the New Relic attributes shown in the list must receive a value.</p>
    <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
      <p>Ensure that the Azure Active Directory attributes shown in the list on the left are good sources for the information to send to New Relic. In particular, not all environments set the <strong>mail</strong> attribute. If your environment does not set the <strong>mail</strong> attribute, <strong>userPrincipalName</strong> could be a good alternative.</p>
    </div>
  </li>
  <li>
    <p>Leave the switch for <strong>Enabled</strong> set to <strong>Off</strong> until you're done with the user and group configuration in the next section. Once all configuration is ready, return to this page and set the switch to <strong>On</strong>.</p>
  </li>
  <li>
    <p>Click <strong>Save</strong>.</p>
  </li>
</ol>
<p>Here's an example of a filled-in attribute mapping page with the default values. Your values may be configured differently depending on your situation.</p>
<p>
  <img src="./images/Azure_AD_Provisioning_Attribute_Mapping_2_0.png" alt="Screen capture showing how to set attributes." title="Azure_AD_Provisioning_Attribute_Mapping.png">
</p>
<p>After saving the provisioning rules, the New Relic SCIM/SSO application is ready to provision any changes made to users assigned to the application. Continue with the following section to assign users and groups to the New Relic SCIM/SSO application.</p>
<h2>Assign users and groups [#assign-users]</h2>
<p>After the New Relic SCIM/SSO application configuration and the New Relic side configuration is finished, you can assign users and groups to the application.</p>
<ol>
  <li>From the New Relic SCIM/SSO application page, click on <strong>Users and groups</strong> in the sidebar.</li>
  <li>Click <strong>+Add user</strong>.</li>
  <li>From the <strong>Add Assignment</strong> page, click on <strong>Users and groups,</strong> and select the appropriate users or groups that you'd like to provision. Then click <strong>Select</strong> and <strong>Assign</strong>.</li>
  <li>The selected users and groups appear on the <strong>Users and groups</strong> page, indicating that they're candidates for provisioning.</li>
  <li>Repeat the steps to add users and groups until all desired entities have been assigned to the application.</li>
</ol>
