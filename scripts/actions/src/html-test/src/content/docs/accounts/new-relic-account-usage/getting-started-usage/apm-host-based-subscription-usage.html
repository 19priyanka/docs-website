
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>This doc is for accounts on our original <a href="/docs/accounts/original-accounts-billing/product-pricing/product-based-pricing">Product-based pricing</a>. If you're on the newer pricing plan, see <a href="/docs/accounts/accounts-billing/new-relic-one-pricing-users/pricing-billing">New Relic One pricing plan</a>. Not sure which you're on? See <a href="/docs/transition-guide-our-new-pricing-plan-user-model">Overview of pricing plans</a>.</p>
</div>
<p>For accounts on our <a href="/docs/accounts/original-accounts-billing/product-pricing/product-based-pricing">original pricing plan</a>, this doc explains how New Relic calculates billable usage for APM accounts that have <a href="/docs/accounts/accounts/subscription-pricing/compute-unit-cu-pricing-vs-host-based-pricing-apm-infrastructure#host-based">host-based pricing</a> (not <a href="/docs/apm-cu-based-usage-attributes-queries">CU-based pricing</a>). This document also provides available subscription usage attributes and <a href="#query-examples">example NRQL queries</a> to use in the New Relic UI or with API calls.</p>
<h2>Data generation [#details]</h2>
<p>Once per day, an APM account will generate an <code>NrDailyUsage</code> <a href="/docs/insights/use-insights-ui/getting-started/introduction-new-relic-insights#event-type">event</a> for:</p>
<ul>
  <li>Every application instance that existed during the last 24 hours</li>
  <li>Every unique host on which an application instance ran during the last 24 hours</li>
</ul>
<p>These two types of events allow your usage data to be queried and analyzed in many different ways. To query the application events, use a <code>usageType</code> attribute value of <code>Application</code>. To query the host events, use a <code>usageType</code> attribute value of <code>Host</code>.</p>
<p>All APM events use a <code>productLine</code> attribute value of <code>APM</code>. For more information, see <a href="#query-examples">APM query examples</a>.</p>
<h2>Usage calculations [#calculation]</h2>
<p>For host-based APM pricing, monthly billable usage is determined by the number of <strong>equivalent hosts</strong> used during that month. An <strong>equivalent host</strong> is defined as: 750 hours (standardized number of monthly hours) of connection to New Relic by a host or multiple hosts. For more on this calculation, see <a href="/docs/accounts/accounts/subscription-pricing/compute-unit-cu-pricing-vs-host-based-pricing-apm-infrastructure#host-based">host-based pricing</a>.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>Only the account <strong>Owner</strong> and <strong>Admins</strong> can view the usage UI. However, anyone in your account can query usage data using the <code>NrDailyUsage</code> <a href="https://docs.newrelic.com/docs/insights/use-insights-ui/getting-started/introduction-new-relic-insights#event-type">event</a>.</p>
</div>
<p>To get an estimate of the current month's billable usage:</p>
<ol>
  <li>Go to: <strong><a href="/docs/using-new-relic/welcome-new-relic/get-started/glossary#account-dropdown">account dropdown</a> > Account settings > Usage</strong>.</li>
  <li>On the <strong>APM usage</strong> page, set the time picker to <strong>Current month</strong>.</li>
  <li>See the <strong>Avg daily equivalent hosts</strong> for an account or grouping of accounts.</li>
</ol>
<p>The UI is meant to estimate your host usage but, especially for cloud environments, your usage may go up or down over time. For more information about the usage UI, see <a href="/docs/accounts/new-relic-account-usage/getting-started-usage/introduction-new-relic-subscription-usage-data">Introduction to New Relic subscription usage data</a>.</p>
<h2>Table definitions [#details]</h2>
<p>Here are definitions of the column headers in the UI table and CSV files. The columns you see depend on the <strong>Group by</strong> option selected at the top of the page.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Header</p>
      </div>
      <div>
        <p>Definition</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>Account name</p>
      </div>
      <div>
        <p>The name of the account. This can be a standalone account, a <a href="/docs/accounts/install-new-relic/account-setup/manage-apps-or-users-sub-accounts">master account</a> or a <a href="/docs/new-relic-partnerships/partner-integration-guide/partner-account-maintenance/partnership-accounts-users-subscriptions">customer partnership</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Account ID</p>
      </div>
      <div>
        <p>New Relic <a href="/docs/accounts-partnerships/accounts/account-setup/account-id">account ID</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Host ID</p>
      </div>
      <div>
        <p>The unique identifier for that host. If the host is in AWS, we use the AWS-provided instance ID. For other hosts, New Relic assigns a host ID. For more about how this value is created, see <a href="/docs/apm-cu-based-usage-attributes-queries#hostid"><code>hostID</code></a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Agent hostname</p>
      </div>
      <div>
        <p>The name of the host, as reported by the agent. For more about this value, see <a href="/docs/apm-cu-based-usage-attributes-queries#agenthostname"><code>agentHostname</code></a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Average daily equivalent hosts</p>
      </div>
      <div>
        <p>Average equivalent hosts for that day. Calculated as the total number of hours reported for all unique hosts in a day, divided by 24. For more on how this is calculated, see <a href="/docs/accounts/accounts/subscription-pricing/compute-unit-cu-pricing-vs-host-based-pricing-apm-infrastructure#host-based">Host-based pricing</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>% of total usage</p>
      </div>
      <div>
        <p>The percentage of the total usage used.</p>
      </div>
    </div>
  </div>
</div>
<h2>General attributes [#attributes]</h2>
<p>The following are general (not APM-specific) account-related <a href="/docs/using-new-relic/welcome-new-relic/getting-started/glossary#attribute">attributes</a>. These attributes can help you understand how your accounts and sub-accounts are using New Relic products.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Attribute</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>consumingAccountId</code></p>
      </div>
      <div>
        <p><a href="/docs/accounts-partnerships/accounts/account-setup/account-id">ID of the New Relic account</a> that is directly responsible for the stored events, as determined from the <a href="/docs/accounts/install-new-relic/account-setup/license-key">license key used</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>consumingAccountName</code></p>
      </div>
      <div>
        <p>Name of the New Relic account that is directly responsible for the stored events, as determined from the <a href="/docs/accounts/install-new-relic/account-setup/license-key">license key used</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>masterAccountId</code></p>
      </div>
      <div>
        <p>The <a href="/docs/accounts-partnerships/accounts/account-setup/account-id">ID of the master account</a> that is either responsible for stored events or that is the parent of the consuming account. When a master account is the consuming account, <code>masterAccountId</code> is the <a href="#consumingAccountId"><code>consumingAccountId</code></a>.</p>
        <p>This attribute is present even for accounts that do not have a master account. This is to ensure continued reporting if the account is later made a master account.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>masterAccountName</code></p>
      </div>
      <div>
        <p>Name of the master account that is either responsible for stored events, or that is the parent of the consuming account. When a master account is the consuming account, <code>masterAccountName</code> is the <a href="#consumingAccountName"><code>consumingAccountName</code></a>.</p>
        <p>This attribute is present even for accounts that do not have a master account. This is to ensure continued reporting if the account is later made a master account.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>partnershipId</code></p>
      </div>
      <div>
        <p><a href="/docs/new-relic-partnerships/partnerships/partner-api/partner-api-reference#partner-id">Partner ID</a> of the <a href="/docs/accounts-partnerships/partner-integration-guide/partner-account-maintenance/partnership-accounts-users-subscriptions">New Relic customer partnership</a> associated with the account responsible for the stored events.</p>
        <p>This attribute is only present if the consuming account is associated with a New Relic customer partnership.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>partnershipName</code></p>
      </div>
      <div>
        <p>Name of the <a href="/docs/accounts-partnerships/partner-integration-guide/partner-account-maintenance/partnership-accounts-users-subscriptions">New Relic customer partnership</a> associated with the account responsible for the stored events.</p>
        <p>This attribute is only present if the consuming account is associated with a customer partnership.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>subAccountId</code></p>
      </div>
      <div>
        <p><a href="/docs/accounts-partnerships/accounts/account-setup/account-id">ID of the sub-account</a> that is responsible for the stored event. When this attribute is present, <code>subAccountId</code> is the <a href="#consumingAccountId"><code>consumingAccountId</code></a>.</p>
        <p>This attribute is only present if the consuming account is a <a href="/docs/accounts/install-new-relic/account-setup/manage-apps-or-users-sub-accounts#hierarchy">sub-account</a> (not a master account).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>subAccountName</code></p>
      </div>
      <div>
        <p>Name of the <a href="/docs/accounts-partnerships/accounts/account-setup/manage-apps-or-users-sub-accounts">sub-account</a> responsible for stored events. When present, this attribute is the same as the <a href="#consumingAccountName"><code>consumingAccountName</code></a>.</p>
        <p>This attribute is only present if the consuming account is a <a href="/docs/accounts/install-new-relic/account-setup/manage-apps-or-users-sub-accounts#hierarchy">sub-account</a> (not a master account).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>timestamp</code></p>
      </div>
      <div>
        <p>UNIX timestamp (seconds since epoch) of the day and time when event generation was initiated.</p>
      </div>
    </div>
  </div>
</div>
<h2>APM attributes (host-based) [#apm-attributes]</h2>
<p>The following are usage-related <a href="/docs/using-new-relic/welcome-new-relic/getting-started/glossary#attribute">attributes</a> generated by <a href="/docs/accounts/accounts/subscription-pricing/compute-unit-cu-pricing-vs-host-based-pricing-apm-infrastructure#host-based">host-based</a> APM accounts (not CU-based APM). To query APM-specific data, use a <code>productLine</code> attribute value of <code>APM</code>.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Attribute</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>agentHostname</code></p>
      </div>
      <div>
        <p>ID reported by the agent to uniquely identify the host for which this usage event is reported. This value can come from several sources in the application’s environment, but commonly is the value returned by the <code>gethostname</code> Linux syscall. In Docker environments, this attribute can take on the value (sometimes truncated) of the Docker container ID. <code>agentHostname</code> is one of three possible providers for the <a href="#hostid"><code>hostId</code></a> value.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>apmAgentVersion</code></p>
      </div>
      <div>
        <p>Version of the New Relic APM agent running in the application instance reporting this usage. Present only for events where <a href="#usageType"><code>usageType</code></a> equals <code>Application</code>.</p>
        <p>To update your agent version, see <a href="/docs/agents/manage-apm-agents/installation/update-new-relic-agent">Update the New Relic agent</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>apmAppId</code></p>
      </div>
      <div>
        <p>ID uniquely identifying the application that is reporting this usage, as it appears in the APM product. Present only for events where <a href="#usageType"><code>usageType</code></a> equals <code>Application</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>apmAppName</code></p>
      </div>
      <div>
        <p>Name of the application reporting this usage, as it appears in the APM product. Present only for events where <a href="#usageType"><code>usageType</code></a> equals <code>Application</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>apmHoursUsed</code></p>
      </div>
      <div>
        <p>Number of hours for which usage was recorded for the given entity. When an entity is connected to New Relic for any amount of time within a given hour, that hour is counted toward usage.</p>
        <p>When calculating monthly APM host usage, the calculation for equivalent hosts for a month assumes that a standard month has 750 hours: `apmHoursUsed / 750`.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>apmLanguage</code></p>
      </div>
      <div>
        <p>Name of the language that the usage-reporting application is written in, as reported by the New Relic agent. Examples: <code>ruby</code>, <code>java</code>, <code>python</code>. Present only for events where <a href="#usageType"><code>usageType</code></a> equals <code>Application</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bootId</code></p>
      </div>
      <div>
        <p>Linux boot ID of host for which this usage is reported, which is unique for each boot lifetime of each Linux operating system instance. Will only be present when the New Relic agent is one of the following versions:</p>
        <ul>
          <li>
            <p><a href="/docs/release-notes/agent-release-notes/go-release-notes">Go</a>: 1.11 or higher</p>
          </li>
          <li>
            <p><a href="/docs/release-notes/agent-release-notes/java-release-notes">Java</a>: 3.42.0 or higher</p>
          </li>
          <li>
            <p><a href="/docs/release-notes/agent-release-notes/net-release-notes">.NET</a>: 6.19.330.0 or higher</p>
          </li>
          <li>
            <p><a href="/docs/release-notes/agent-release-notes/nodejs-release-notes">Node.js</a>: 2.1.0 or higher</p>
          </li>
          <li>
            <p><a href="/docs/release-notes/agent-release-notes/php-release-notes">PHP</a>: 7.5.0.199 or higher</p>
          </li>
          <li>
            <p><a href="/docs/release-notes/agent-release-notes/python-release-notes">Python</a>: 2.90.0.75 or higher</p>
          </li>
          <li>
            <p><a href="/docs/release-notes/agent-release-notes/ruby-release-notes">Ruby</a>: 4.4.0.336 or higher</p>
            <p><code>bootId</code> is one of three possible providers for the <a href="#hostid"><code>hostId</code></a> value.</p>
          </li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p><code>cloudInstanceId</code></p>
      </div>
      <div>
        <p>ID uniquely identifying the cloud host instance (example: an AWS EC2 instance) for which this usage is reported. (For example, for an AWS EC2 instance, the value would look like <code>i-1234abcd5678ef900</code>.) This is used to uniquely identify the host if the <code>apmComputeUnitRule</code> is <code>cloud_provider_data</code>. This will not be present if no cloud provider was detected by the agent.</p>
        <p>Agents with these versions will detect cloud provider data for AWS:</p>
        <ul>
          <li>
            <p><a href="/docs/release-notes/agent-release-notes/go-release-notes">Go</a>: 1.11 or higher</p>
          </li>
          <li>
            <p><a href="/docs/release-notes/agent-release-notes/java-release-notes">Java</a>: 3.18.0 or higher</p>
          </li>
          <li>
            <p><a href="/docs/release-notes/agent-release-notes/net-release-notes">.NET</a>: 5.1.72.0 or higher</p>
          </li>
          <li>
            <p><a href="/docs/release-notes/agent-release-notes/nodejs-release-notes">Node.js</a>: 1.21.0 or higher</p>
          </li>
          <li>
            <p><a href="/docs/release-notes/agent-release-notes/php-release-notes">PHP</a>: 5.5.0 or higher</p>
          </li>
          <li>
            <p><a href="/docs/release-notes/agent-release-notes/python-release-notes">Python</a>: 2.54.0.41 or higher</p>
          </li>
          <li>
            <p><a href="/docs/release-notes/agent-release-notes/ruby-release-notes">Ruby</a>: 3.12.1.298 or higher</p>
            <p><code>cloudInstanceId</code> is one of three possible providers for the <a href="#hostid"><code>hostId</code></a> value.</p>
          </li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p><code>cloudInstanceType</code></p>
      </div>
      <div>
        <p>Instance type of the host as defined by the cloud provider and detected by the agent. For example: <code>c4.2xlarge</code>. This will not be present if no cloud provider was detected by the agent.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>cloudProvider</code></p>
      </div>
      <div>
        <p>Name of the cloud provider for this host. Example values: <code>aws</code>, <code>azure</code>. This will not be present if no cloud provider was detected by the agent.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>cloudZone</code></p>
      </div>
      <div>
        <p>Name of the zone that a cloud provider host is located in. For example: <code>eu-central-1b</code>. This will not be present if no cloud provider was detected by the agent.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>containerId</code></p>
      </div>
      <div>
        <p>ID of the Docker or other Linux container in which the application instance is running. This will not be present if a container was not detected by the agent. Present only for events where <a href="#usageType"><code>usageType</code></a> equals <code>Application</code>. This attribute is <strong>not</strong> used to uniquely identify hosts for billing purposes.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>hostId</code></p>
      </div>
      <div>
        <p>ID used to uniquely identify the host for which this usage is reported. Any given hour of APM usage for this host will be counted only once when calculating <code>apmHoursUsed</code>. There are several possible host identifiers reported by the New Relic agent. The attributes, if present, will be chosen to use in this order of precedence: <code>cloudInstanceId</code>, <code>bootId</code>, <code>agentHostname</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>productLine</code></p>
      </div>
      <div>
        <p>The New Relic product the usage data is from. Always use the value <code>APM</code> when querying for APM CU usage data.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>usageType</code></p>
      </div>
      <div>
        <p>For APM, this value can be either <code>Application</code> or <code>Host</code>, depending on the type of entity this event records usage for (other New Relic products will have different values for <code>usageType</code>). Events with both values are recorded so that usage data can be analyzed in several ways.</p>
        <p>For <code>Application</code>: the event represents usage for a single unique application instance for that day. For <code>Host</code>: the event represents usage for a single unique host for that day.</p>
        <p>Only <code>Host</code> entities are used to calculate billable usage. <code>Application</code> entities are useful for comparing usage between applications, but are not used for billing or contract purposes.</p>
      </div>
    </div>
  </div>
</div>
<h2>Query examples</h2>
<p>Here are some examples of NRQL queries you can use with your account usage data. You can run NRQL queries and use the resulting charts in dashboards.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibGFzdC1tb250aC1xdWVyeSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiVXNhZ2UgZm9yIGxhc3QgbW9udGgifV0=">
    <div data-prop-text="title">Usage for last month</div>
    <p>This query uses New Relic’s standard number of hours per month (750) for the purpose of calculating APM equivalent hosts over the last month.</p>
    <pre><code>SELECT sum(apmHoursUsed)/750 
AS 'Equivalent hosts' 
FROM NrDailyUsage 
WHERE usageType='Host' 
AND productLine='APM' 
SINCE last month 
UNTIL this month

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicGVyLWhvc3QtYXBwLXF1ZXJ5In0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJVc2FnZSBwZXIgaG9zdCBwZXIgYXBwbGljYXRpb24ifV0=">
    <div data-prop-text="title">Usage per host per application</div>
    <p>New Relic records usage per application instance, not strictly per application. This query gives an approximation of the usage for a given application on a given host. If unique application instances run sequentially on a host within a given day, this query could return an underestimate (this would be likely, for example, in a container environment).</p>
    <pre><code>SELECT max(apmHoursUsed) 
FROM NrDailyUsage 
WHERE usageType='Application' 
AND productLine='APM' 
FACET consumingAccountName,consumingAccountId,apmAppName,hostId 
SINCE 1 day ago 
LIMIT 2000

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiaW5zdGFuY2UtaG91cnMtcGVyLWFwcC1xdWVyeSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiSW5zdGFuY2UtaG91cnMgcGVyIGFwcGxpY2F0aW9uIn1d">
    <div data-prop-text="title">Instance-hours per application</div>
    <p>This query measures the total number of hours used by all instances (processes) of an application in the last 24 hours. It's useful for determining which applications are responsible for APM usage, but does not return results that match precisely how New Relic prices APM usage.</p>
    <p>Each application instance is counted separately in this query, even if it runs concurrently with another application instance on the same host, so the number of application instance-hours is likely to be greater than the number of host-hours (the billable quantity).</p>
    <pre><code>SELECT sum(apmHoursUsed) 
FROM NrDailyUsage 
WHERE usageType='Application' 
AND productLine='APM' 
FACET consumingAccountName,consumingAccountId,apmAppName 
SINCE 1 day ago 
LIMIT 2000

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiYWdlbnQtdmVyc2lvbi1pbmZvIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJBZ2VudCB2ZXJzaW9uIGluZm9ybWF0aW9uIn1d">
    <div data-prop-text="title">Agent version information</div>
    <p>Use this query to see which agent versions are running on your applications in the last 24 hours. This information can be useful in determining whether the agent needs to be upgraded to report a more accurate host name in a Docker container environment (either a Linux boot ID or a cloud provider instance ID).</p>
    <pre><code>FROM NrDailyUsage 
SELECT count(*) 
WHERE productLine='APM' 
AND usageType='Application' 
FACET consumingAccountId, consumingAccountName, apmAppName, apmAgentVersion, apmLanguage 
SINCE 1 day ago 
LIMIT 2000

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiYWNjb3VudC1oaWVyYXJjaHktcXVlcnkifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkFjY291bnQgaGllcmFyY2h5In1d">
    <div data-prop-text="title">Account hierarchy</div>
    <p>This query is useful for seeing the account hierarchy (partnership, master, sub-accounts).</p>
    <pre><code>SELECT count(*) 
FROM NrDailyUsage 
FACET partnershipName,masterAccountName,masterAccountId,consumingAccountName,consumingAccountId 
LIMIT 2000 
SINCE 1 day ago

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibGVnYWN5LXVzYWdlLXJlcG9ydCJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiTGVnYWN5IHBlci1ob3N0IHVzYWdlIHJlcG9ydCJ9XQ==">
    <div data-prop-text="title">Legacy per-host usage report</div>
    <p>This query produces a close approximation of the CSV report you would have seen in the deprecated UI system:</p>
    <pre><code>FROM NrDailyUsage 
SELECT consumingAccountId 
AS 'Account ID', hostId, cloudProvider 
AS 'Host provider', cloudInstanceType 
AS 'Instance type', apmBillingInstanceSize 
AS 'Instance size', apmHoursUsed 
AS 'Hours used', apmComputeUnits 
AS 'Usage (CU)', apmMemoryBytes/(1024*1024*1024) 
AS 'Total RAM', apmProcessorCount 
AS 'Logical processors', apmContainerCount 
AS 'Container count', apmComputeUnitRule 
AS 'Business rule', missingCpuData, missingRamData, instanceSizeCapped, cloudZone, cloudInstanceId 
WHERE productLine='APM' 
AND usageType='Host' 
SINCE 1 day ago 
LIMIT 2000

</code></pre>This NRQL query is different than the legacy usage report:
    &#x3C;Table>
    &#x3C;thead>
    &#x3C;tr>
    &#x3C;th style={{ width: "200px" }}>
    Per-host query
    &#x3C;/th>
    &#x3C;th>
    Comments
    &#x3C;/th>
    &#x3C;/tr>
    &#x3C;/thead>
    &#x3C;tbody>
    &#x3C;tr>
    &#x3C;td>
    Time period
    &#x3C;/td>
    &#x3C;td>
    This query includes only the last 24 hours of usage. To see the usage aggregated over a longer time period, change the `SINCE` clause.
    &#x3C;/td>
    &#x3C;/tr>
    &#x3C;tr>
    &#x3C;td>
    Results limited to a maximum number of rows
    &#x3C;/td>
    &#x3C;td>
    NRQL limits the number of rows returned. If you have more hosts than the maximum number of rows returned and want to get the complete set of hosts, you can narrow your query with more `WHERE` clauses to return subsets of the data (for example `WHERE cloudInstanceId LIKE “%0”`) to divide the data into up to 16 groups, modulo the last character in the AWS instance ID.
    &#x3C;/td>
    &#x3C;/tr>
    &#x3C;tr>
    &#x3C;td>
    Docker container IDs
    &#x3C;/td>
    &#x3C;td>
    A single Docker container ID does not appear in this report. A Docker container ID is reported only at the application instance level of granularity (`usageType='Application'`).
    For the host (`usageType='Host'`), a count of unique containers is reported, since there are often very many. While choosing just one container ID to report for a host had been informative, now there is more data reported at the appropriate level of granularity.
    &#x3C;/td>
    &#x3C;/tr>
    &#x3C;tr>
    &#x3C;td>
    Business rule
    &#x3C;/td>
    &#x3C;td>
    `Business rule` has been replaced with other attributes. It no longer is used to describe whether the agent needs to be updated.
    &#x3C;/td>
    &#x3C;/tr>
    &#x3C;/tbody>
    &#x3C;/Table>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibGVnYWN5LWhvc3QtdXNhZ2UtcXVlcnkifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkxlZ2FjeSBob3N0IHVzYWdlIHJlcG9ydCAoYXBwbGljYXRpb24gbGlzdGluZykifV0=">
    <div data-prop-text="title">Legacy host usage report (application listing)</div>
    <p>This query returns data once provided in the "host usage report": a listing of applications running on each host. Note that while APM usage is counted on an hour-by-hour basis, per-hour usage data is no longer available via the API or UI.</p>
    <pre><code>FROM NrDailyUsage 
SELECT min(timestamp) 
AS 'Earliest reporting day',max(timestamp) 
AS 'Latest reporting day' 
FACET apmAppName,hostId,agentHostname,consumingAccountName,consumingAccountId 
WHERE usageType='Application' 
AND productLine='APM' 
SINCE 1 month ago 
LIMIT 2000

</code></pre>
  </div>
</div>
<h2>Use of Docker and other containers [#containers]</h2>
<p>Some previous New Relic APM agents may miscount containers as hosts, which may lead to over-reporting of host-based usage.</p>
<p>To fix this calculation for Linux-based containers (including Docker), <a href="/docs/agents/manage-apm-agents/installation/update-new-relic-agent">upgrade your APM agent</a> to these versions:</p>
<ul>
  <li><strong>Go</strong>: 1.11 or higher</li>
  <li><strong>Java</strong>: 3.42.0 or higher</li>
  <li><strong>.NET</strong>: 6.19.330.0 or higher</li>
  <li><strong>Node.js</strong>: 2.1.0 or higher</li>
  <li><strong>PHP</strong>: 7.5.0.199 or higher</li>
  <li><strong>Python</strong>: 2.90.0.75 or higher</li>
  <li><strong>Ruby</strong>: 4.4.0.336 or higher</li>
</ul>
