
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>This feature is being replaced by the advanced service called <strong>Incident Workflows</strong>. For updated docs, see <a href="https://docs.newrelic.com/docs/new-relic-one/use-new-relic-one/new-relic-ai/enhance-notifications-using-incident-workflows">Notifications using Incident Workflows</a>.</p>
</div>
<p>New Relic Connect enables you to customize New Relic webhooks to meet your team’s complex notification requirements. You can automatically send incident data to and from wherever you want, attaching relevant information. This way you no longer have to search for issues and can respond to incidents quickly. New Relic Connect enables you to:</p>
<ul>
  <li>Establish two-way integration with incident management tools.</li>
  <li>Connect to additional notification platforms.</li>
  <li>Customize webhook payloads with additional attributes.</li>
  <li>Enrich webhooks with database information.</li>
</ul>
<p>New Relic Connect can be used to build workflows that link your data from multiple tools and take intelligent actions. Currently supported destinations for New Relic Connect include <a href="https://aws.amazon.com/eventbridge/">Amazon EventBridge</a>, <a href="https://www.atlassian.com/software/jira">Atlassian Jira</a>, and other New Relic Alerts webhooks.</p>
<p>Connect with:</p>
<ul>
  <li><a href="#using_new_relic_connect_w_aws_eventbridge">Amazon EventBridge</a></li>
  <li><a href="#using_new_relic_connect_w_jira">Atlassian Jira</a></li>
  <li><a href="#using_new_relic_alert_webhooks">New Relic Alerts webhook</a></li>
  <li><a href="#servicenow">ServiceNow</a></li>
  <li><a href="#using_new_relic_alert_zapier">Zapier</a></li>
</ul>
<h2>Requirements for getting started with Connect</h2>
<p>To get access to this feature, contact your account representative or <a href="https://sgnf.typeform.com/to/V1QGhO">fill out this form</a>.</p>
<h2>Configure a New Relic Connect webhook [#configure_new_relic_webhook]</h2>
<p>To configure a webhook using New Relic Connect, go to <strong><a href="https://rpm.newrelic.com/apm">rpm.newrelic.com/apm</a> > Alerts > Notification channels > New notification channel</strong>. See the <a href="/docs/alerts/new-relic-alerts/managing-notification-channels/notification-channels-control-where-send-alerts#webhook">webhooks information</a> to learn more about these fields.</p>
<ol>
  <li>For the <strong>Base Url</strong>, add <code>https://connect.newrelic.com/YOUR_NEW_RELIC_ACCOUNT_ID</code></li>
  <li>In the <strong>Basic Auth</strong> area, set the username and password provided by your New Relic account representative. This is provided as an additional security measure and is required regardless of destination type.</li>
  <li>In the <strong>Custom Headers</strong> area, set the name to <code>account_id</code> and for <strong>Value</strong>, add your <a href="/docs/accounts/install-new-relic/account-setup/account-id">New Relic account ID</a>.</li>
</ol>
<h2>Connect webhook payload parameters</h2>
<p>In the <strong>Use</strong> <strong>Custom Payload</strong> area, you can add additional parameters to customize the webhook. Refer to the following table for a list of required and optional parameters to include for New Relic Connect incidents.</p>
<p>All of the default fields in the custom webhook payload are optional; if you leave the default fields, all of the information in those fields is included in the webhook. You can remove any fields you don't need.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Parameter</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>account_id</code></p>
      </div>
      <div>
        <p>Required if using <code>nrql_execution.</code> Your New Relic account ID.</p>
        <p><code>“account_id”: “YOUR_NEW_RELIC_ACCOUNT_ID”</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><code>email_status_report</code></p>
      </div>
      <div>
        <p>Optional. Specify an email address that will receive an error report if the webhook fails.</p>
        <p><code>“email_status_report”: “YOUR_EMAIL"</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><code>flatten_target</code></p>
      </div>
      <div>
        <p>Optional. Add a new root-level field to the webhook payload for each New Relic Alerts target that is associated with the incident. This can be helpful for parsing the payload in incident management tools with a rigid structure or predefined fields.</p>
        <p><code>“flatten_target”: “true”</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><code>map_attributes</code></p>
      </div>
      <div>
        <p>Optional. An object containing instructions for creating new fields required for the downstream notification channel. Use this field to populate webhook payload fields into new string fields. Each key in the <code>map_attributes</code> object specifies a new required field in the final payload, while each value contains a string template describing what original payload values to use while constructing the result.</p>
        <p>The <code>map_attributes</code> projection occurs after the NRQL query, and can then use NRQL results in the construction of new fields. In the example below, two new fields are defined to be added to the final webhook payload. <code>short_description</code>is copied from an existing field in the default webhook payload called <code>condition_name</code>. The second field, <code>description</code>, is combined from the static string <code>First event</code> and a dynamic value obtained from the first NRQL event. This is appended using the <code>nrql_execution</code> feature. To learn about the specific variable, make sure to run your NRQL query using the REST API and inspect the return answer to map all the available fields correctly.</p>
        <p><code>"map_attributes": { "short_description": "{{condition_name}}", "description":"First event: {{events[0].id}}", }</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><code>notification_channels</code></p>
      </div>
      <div>
        <p><strong>Required</strong>. This parameter replaces the functionality of the base URL originally specified in the webhook definition, and specifies the destinations for the enriched webhook. It has three fields: <code>type</code>, <code>endpoint</code>, and <code>credentials</code>.</p>
        <p>You can specify an unlimited number of destinations for a given webhook.</p>
        <pre><code>{
"notification_channels": [
   {
   "type": "webhook",
   "endpoint": "https://webhook.address.com",
   "credentials": {
      "api_key": "1234",
      "api_key_header": "MyHeader",
      “api_key_header_prefix”: “Bearer”
      "username": "user",
      "password": "pass"
   }
 ]
},

</code></pre>
      </div>
    </div>
    <div>
      <div>
        <p><code>notification_channels / type</code></p>
      </div>
      <div>
        <p><strong>Required.</strong> Set for the destination type you'd like to send the webhook to.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>notification_channels / endpoint</code></p>
      </div>
      <div>
        <p><strong>Required</strong>. The URL to send the event to.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>notification_channels / credentials</code></p>
      </div>
      <div>
        <p>Optional. Credentials are optional for webhooks; for Amazon EventBridge, this includes your <code>aws_account_id</code> and <code>aws_region.</code></p>
        <p>If the <code>credentials</code> field is not declared on a channel object, the webhook’s basic auth credentials (as defined in the customer setup section) are forwarded to the third-party channel.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>notification_channels / credentials / username</code></p>
      </div>
      <div>
        <p>Optional. Used for basic authentication. Required if <code>password</code> is specified.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>notification_channels / credentials / password</code></p>
      </div>
      <div>
        <p>Optional. Used for basic authentication. Required if <code>username</code> is specified.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>notification_channels / credentials / api_key</code></p>
      </div>
      <div>
        <p>Optional. A string token to pass in as an HTTP header. The default header is <code>Authorization</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>notification_channels / credentials / api_key_header</code></p>
      </div>
      <div>
        <p>Optional. Used to override which header sends the API key. Has no effect if the <code>api_key</code> field is not set.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>notification_channels / credentials / api_key_header_prefix</code></p>
      </div>
      <div>
        <p>Optional. Add an optional prefix before the API key. A common requirement is to use the prefix <code>Bearer</code> for JWT authentication. Has no effect if the <code>api_key</code> field is not set.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>nrql_execution</code></p>
      </div>
      <div>
        <p>Optional. Include an NRQL query that runs when a new incident is triggered; the query results are attached to the webhook payload. For guidance on writing NRQL queries for this field, see the <a href="/docs/query-data/nrql-new-relic-query-language/getting-started/introduction-nrql">New Relic Query Language documentation</a>. Review the query results in the <code>events</code> array field of the final webhook payload.</p>
        <p><code>"nrql_execution”: “SELECT * FROM Transaction where appName={{incident_id}} SINCE 1 hour ago”</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><code>nrql_credentials</code></p>
      </div>
      <div>
        <p>Required if using <code>nrql_execution.</code> Insights API key from New Relic.</p>
        <p><code>“nrql_credentials”: “YOUR_NEW_RELIC_INSIGHTS_API_KEY”</code></p>
      </div>
    </div>
  </div>
</div>
<h2>Use New Relic Connect with Amazon EventBridge [#using_new_relic_connect_w_aws_eventbridge]</h2>
<p>New Relic Connect makes it easy to hook New Relic events into AWS services with <a href="https://aws.amazon.com/eventbridge/">EventBridge</a>, Amazon's serverless event bus.</p>
<ol>
  <li>
    <p>Follow the steps to create a New Relic webhook with a custom payload configured for New Relic Connect. Under <code>notification_channels</code> in the custom payload:</p>
    <ul>
      <li>Set the type to <code>awseventbridge</code>.</li>
      <li>Set the endpoint to the name of the new event bus you want to create in EventBridge.</li>
      <li>Set the credentials to your <code>aws_account_id</code> and <code>aws_region</code>.</li>
    </ul>
    <p>Example</p>
    <pre><code>"notification_channels": [
   {
      "type": "awseventbridge",
      "endpoint": ""
      "credentials": {
         "aws_account_id": ""
         "aws_region": ""
      }
   }
]
</code></pre>
  </li>
  <li>
    <p>Save and send a test event. This first event creates a new <a href="https://docs.aws.amazon.com/eventbridge/latest/userguide/create-partner-event-bus.html">partner event source</a> in EventBridge automatically.</p>
  </li>
  <li>
    <p>In the Amazon EventBridge UI, click on the new <strong>Partner Event Source</strong> that was created by your test event, and follow the process to associate it with an event bus.</p>
  </li>
  <li>
    <p>
      Forward the EventBridge event to whatever AWS service you want. After EventBridge rules are configured, future events triggered by your New Relic webhook are pushed to those services automatically.
      To create more complex event filters, add a resources webhook field in the New Relic custom payload. EventBridge automatically gives you the option to use this field’s contents as filters in new rules. For more information about configuring EventBridge rules, see the <a href="https://docs.aws.amazon.com/eventbridge/index.html">EventBridge Documentation</a>.
    </p>
  </li>
</ol>
<h2>Use New Relic Connect with Atlassian Jira [#using_new_relic_connect_w_jira]</h2>
<p>Jira is a popular issue and project tracking software that many site reliability engineering (SRE) and DevOps teams use in their incident management and response cycles. New Relic Connect makes it easy to set up a two-way integration with Jira and enhance existing incidents with additional information from other services.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>Please note that currently, New Relic Connect is compatible with Jira Cloud. It does not work with Jira Server or Jira Data Center</p>
</div>
<ol>
  <li>
    <p>Follow the steps to create a New Relic webhook with a custom payload configured for New Relic Connect. Under <code>notification_channels</code> in the custom payload:</p>
    <ul>
      <li>Set the <code>type</code> to <code>Jira</code>.</li>
      <li>Set the <code>endpoint</code> to your Jira instance URL.</li>
      <li>Set the <code>credentials</code> using the email address for your Jira account as your <code>username</code> and a generic Jira token for your <code>password</code>.</li>
    </ul>
    <p>Example:</p>
    <pre><code>"notification_channels": [
   {
      "type": "jira",
      "endpoint": """
      "credentials": {
         "username": ""
         "password": """
      }
   }
]
</code></pre>
  </li>
  <li>
    <p>Set additional parameters in the webhook payload:</p>
    <ul>
      <li><code>incident_id</code>: (required) New Relic incident ID</li>
      <li><code>project</code>: (required) the Jira project ID for new tickets to be created in</li>
      <li><code>assignee</code>: (optional) the Jira username to assign new tickets to by default</li>
      <li><code>watchers</code>: (optional) array of Jira user names to be assigned as watchers for new incidents</li>
    </ul>
  </li>
  <li>
    <p>(Optional) Follow the above instructions to map attributes from the New Relic alert to Jira fields. All single-line text fields (default and custom) are supported; only default (not custom) multi-line text fields are supported.</p>
  </li>
  <li>
    <p>In the Jira UI, create a new field called <strong>new relic incident id</strong> for the New Relic incident ID to map to (required) and add it to the screen for the project you chose in step 2.</p>
  </li>
  <li>
    <p>To enable two-way integration between Jira and New Relic, in the Jira UI, under <strong>Settings > System > Webhooks (under “Advanced”) > Create New</strong>, turn on “updated” for the issue.</p>
  </li>
  <li>
    <p>In the <strong>URL</strong> field, enter <code>http://connect.newrelic.com/YOUR_NEW_RELIC_ACCOUNT_ID/jiraStatusChange</code> and append the following parameters:</p>
    <ul>
      <li>nrApiKey=”&#x3C;<a href="https://docs.newrelic.com/docs/apis/get-started/intro-apis/types-new-relic-api-keys#admin">ADMIN API key for New Relic</a>>"</li>
      <li>jiraApiKey=”&#x3C;generic Jira token>"</li>
      <li>username=”&#x3C;the email address for your Jira account>"</li>
    </ul>
  </li>
  <li>
    <p>Once this is configured, if the status of the Jira ticket changes to anything other than “Done,” the New Relic Alert status updates to “Acknowledged.” Once the Jira ticket is moved to “Done,” it is marked as “Closed” in the New Relic UI.</p>
    <h3>Full payload example</h3>
    <pre><code>{
  "incident_id": "$INCIDENT_ID",
  "condition_name": "$CONDITION_NAME",
  "short_description": "Example description",
  "email_status_report": "noreplay@connect.newrelic.com",
  "notification_channels": [
    {
      "type": "jira",
      "endpoint": "https://example-instance.atlassian.net/",
      "credentials": {
        "username": "example@youremail.com",
        "password": "examplepassword"
      },
      "project": "EXAMPLE",
      "assignee": "admin",
      "watchers": []
    }
  ],
  "i_will_be_used_in_query": "search",
  "flatten_target": true,
  "nrql_credentials": "",
  "nrql_execution": "SELECT * FROM Transaction where appName={{i_will_be_used_in_query}}",
  "map_attributes": {
    "short_description": "Example description here",
    "summary": "Example summary here",
    "description": "Last transaction: {{events[0].name}}"
  }
}
</code></pre>
  </li>
</ol>
<h2>Use New Relic Connect with ServiceNow [#servicenow]</h2>
<p><a href="https://www.servicenow.com/">ServiceNow</a> is a popular tool used for incident management and response. New Relic Connect makes it easy to set up a two-way integration with ServiceNow and enhance existing incidents with additional information from other services.</p>
<ol>
  <li>
    <p>Follow the steps above to create a New Relic webhook with a custom payload configured for New Relic Connect.</p>
  </li>
  <li>
    <p>Add <code>incident_id</code> as a root field in the custom payload (this field is in the custom payload by default; verify to make sure it’s there before saving the webhook since this is required).</p>
  </li>
  <li>
    <p>Under <code>notification_channels</code> in the custom payload:</p>
    <ul>
      <li>
        <p>Set the <code>type</code> to <code>servicenow</code></p>
      </li>
      <li>
        <p>Set the <code>endpoint</code> to your ServiceNow instance url</p>
      </li>
      <li>
        <p>Set the <code>credentials</code> to your username and password for ServiceNow. The account whose credentials you’re using should have permissions to create tickets and create new records in data dictionary tables.</p>
        <p>Example:</p>
        <pre><code>“incident_id”: “&#x3C;incident ID>”,
“notification_channels”: [
   {
      “type”: “servicenow”,
      “endpoint”: “http://example.yourdomain.com”
      “credentials”: {
         “username”: “&#x3C;your_servicenow_username>”
         “password”: “&#x3C;your_servicenow_password>”
      }
   }
]
</code></pre>
      </li>
    </ul>
  </li>
  <li>
    <p>Import the New Relic Connect XML files.</p>
    <ul>
      <li>Open <a href="https://docs.newrelic.com/sites/default/files/atoms/files/nr_standalone_combined_v1%20%282%29.xml" title="nr_standalone_combined_v1 (2).xml">this XML file</a> (which includes the business rule for New Relic Connect) Navigate to <strong>System Definition → Business Rule</strong> in the ServiceNow sidebar menu.</li>
      <li>Click the menu icon in one of the column headers, select <strong>Import XML</strong>, and upload the XML file you downloaded.</li>
    </ul>
  </li>
  <li>
    <p>Configure new system properties, which can be found by typing <code>sys_properties.list</code> in the ServiceNow search box (these were automatically created by the file you imported in step 4):</p>
    <ul>
      <li>
        <p><code>nr.newrelic_account_id</code>: Your New Relic Account ID</p>
      </li>
      <li>
        <p><code>nr.update_endpoint</code>: The URL of the “status update” webhook used for two-way incident synchronization. This URL will be provided by your account representative when you’re ready to get set up with Connect, and is required to update the originating New Relic incident’s status when the ServiceNow ticket tracking the incident is changed.</p>
      </li>
      <li>
        <p><code>nr.update_endpoint_username</code> / <code>nr.update_endpoint_password</code>: Basic auth credentials to be used with the webhook.</p>
      </li>
      <li>
        <p><code>nr.alerts_api_key</code>: REST API key used for interacting with the New Relic Alerts API.</p>
      </li>
      <li>
        <p><code>nr.ack_states</code>: Numeric ids of ServiceNow incident states that will trigger an acknowledgement of the tracked New Relic incident alert, separated by commas. Default values: 2,3 (In Progress, On Hold)</p>
      </li>
      <li>
        <p><code>nr.resolve_states</code>: Numeric ids of ServiceNow incident states that will trigger a resolution of the tracked New Relic incident alert, separated by commas. Default values: 6,7,8 (Resolved, Closed, Canceled)</p>
        <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
          <p>Numeric ids for incident states can be found in the <code>sys_choice_list</code> ServiceNow view, and filtering by <code>element=”incident_state”</code>.</p>
        </div>
        <p>
          <img src="./images/Servuce_Now_Connect.png" alt="This image shows how the Connect integration is displayed in the Service Now UI." title="Service_Now_Connect.png">
        </p>
        <p><strong>ServiceNow > All > Name > New Relic</strong></p>
      </li>
    </ul>
  </li>
  <li>
    <p>Optional: test the integration with New Relic Connect by configuring a webhook pointing to your ServiceNow installation. For example, <code>https://my-example.service-now.com</code>.</p>
  </li>
</ol>
<h2>Use New Relic Connect with New Relic Alerts webhooks [#using_new_relic_alert_webhooks]</h2>
<p>In addition to connecting to external sources, you can also use New Relic Connect to feed additional data back into New Relic Alerts webhooks. This can be especially useful when combined with the NRQL enrichment functionality to add more context to incoming alerts.</p>
<ol>
  <li>Follow the steps to create a New Relic webhook with a custom payload configured for New Relic Connect. Under <code>notification_channels</code> in the custom payload:
    <ul>
      <li>Set the <code>type</code> to <code>webhook</code>.</li>
      <li>Set the <code>endpoint</code> to the URL for the other New Relic Alerts webhook you’d like to forward to.</li>
      <li>Set Basic Authentication using your <code>username</code> and <code>password</code> for New Relic Alerts.</li>
    </ul>
  </li>
</ol>
<h2>Use New Relic Connect with Zapier [#using_new_relic_alert_zapier]</h2>
<p>Zapier allows users to integrate many different applications, sending information between them and triggering actions in one tool based on events from another. New Relic Connect makes it easy to send enhanced Alerts webhooks to Zapier, which then enables integration with 2000+ tools.</p>
<ol>
  <li>
    <p>Follow <a href="https://zapier.com/help/create/code-webhooks/trigger-zaps-from-webhooks">these instructions</a> to set up a new webhook trigger (zap) in Zapier. At the <strong>Customize your webhook trigger</strong> step, copy the provided webhook URL.</p>
  </li>
  <li>
    <p>Follow these steps to create a New Relic webhook with a custom payload configured for New Relic Connect. Under <code>notification_channels</code> in the custom payload:</p>
    <ul>
      <li>
        <p>Set the <code>type</code> to <code>zapier</code>.</p>
      </li>
      <li>
        <p>Set the <code>endpoint</code> to the Zapier webhook URL you copied in step 1.</p>
      </li>
      <li>
        <p>Set the <code>credentials</code> using your Zapier <code>username</code> and password.</p>
        <p>Example:</p>
        <pre><code>"notification_channels": [
   {
      "type": "zapier",
      "endpoint": "&#x3C;zapier webhook url here>"
      "credentials": {
         "username": "&#x3C;your username here>"
         "password": "&#x3C;your password here>"
      }
   }
]
</code></pre>
      </li>
    </ul>
  </li>
</ol>
