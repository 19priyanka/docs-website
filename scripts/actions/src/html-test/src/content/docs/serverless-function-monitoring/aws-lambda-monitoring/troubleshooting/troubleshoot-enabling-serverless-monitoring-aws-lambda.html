
<h2>Problem</h2>
<p>Youâ€™re attempting to enable <a href="/docs/serverless-function-monitoring/aws-lambda-monitoring/get-started/introduction-new-relic-monitoring-aws-lambda">serverless monitoring for AWS Lambda</a> and are having an issue or error.</p>
<h2>Solution</h2>
<p>There are two common problems related to not completing all of the <a href="/docs/serverless-function-monitoring/aws-lambda-monitoring/get-started/enable-new-relic-monitoring-aws-lambda">enablement procedures</a>:</p>
<ul>
  <li>Not seeing data on <strong>CloudWatch metrics</strong> UI page. This means the <a href="/docs/serverless-function-monitoring/aws-lambda-monitoring/get-started/enable-new-relic-monitoring-aws-lambda#connect-aws">AWS integration step</a> wasn't completed.</li>
  <li>Not seeing data on <strong>Troubleshooting</strong> category UI pages. If you aren't seeing data on the <strong>Distributed tracing</strong>, <strong>Errors</strong>, and <strong>Invocations</strong> UI tabs, this means the <a href="/docs/serverless-function-monitoring/aws-lambda-monitoring/get-started/enable-new-relic-monitoring-aws-lambda#instrument-lambda">APM agent instrumentation step</a> wasn't completed.</li>
</ul>
<p>Besides these basic enablement problems, there are some additional problems that may cause an issue:</p>
<ul>
  <li>
    <p>CloudWatch error "HTTP error 401: unauthorized." This is due to an incorrect API Key. The <code>--nr-api-key</code>argument in the <a href="/docs/serverless-function-monitoring/aws-lambda-monitoring/get-started/enable-new-relic-monitoring-aws-lambda#connect-aws">Configure AWS enable step</a> takes your <a href="/docs/apis/get-started/intro-apis/types-new-relic-api-keys#user-api-key">user key</a>, which is different from the REST API key.</p>
  </li>
  <li>
    <p>Custom metrics are missing. Lambda monitoring is not compatible with our <a href="/docs/agents/manage-apm-agents/agent-data/collect-custom-metrics">custom metrics</a>. Use <a href="/docs/agents/manage-apm-agents/agent-data/collect-custom-attributes">custom attributes</a> to add metadata.</p>
  </li>
  <li>
    <p>Invocations missing. To see invocation breakdown details, distributed tracing must be enabled as part of the <a href="/docs/serverless-function-monitoring/aws-lambda-monitoring/get-started/enable-new-relic-monitoring-aws-lambda#instrument-lambda">Lambda instrumentation step</a>. Distributed tracing is required so that span details can be displayed in the invocation details pane.</p>
  </li>
  <li>
    <p>You've completed the installation, integration, and instrumentation steps correctly, and your function is sending logs to CloudWatch but you're not seeing traces for specific dependencies (or any traces) in the UI. This may result from the order of layer merging (if you're using our Lambda layers) or from the order of import (if you're instrumenting manually):</p>
    <ul>
      <li>If you're instrumenting with layers: make sure in your function configuration that the New Relic layer is merged before other layers (though if your function uses webpack, the New Relic layer should be merged after the webpack layer).</li>
      <li>If you're instrumenting a Node function manually, make sure that your function imports <strong>newrelic</strong> and <strong>@newrelic/aws-sdk</strong> before it imports any dependencies you expect to monitor.</li>
    </ul>
  </li>
</ul>
<p>If none of these solutions help you, contact our <a href="https://support.newrelic.com/">support team</a>. The following information will help you when you talk to support technicians:</p>
<ul>
  <li>Has the Lambda function appeared in the UI before? If so, what is the name of the function?</li>
  <li>If some data for the Lambda function is appearing in the UI, what specific data is appearing?</li>
  <li>What APM language agent are you using to instrument the function?</li>
</ul>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiYXR0YWNoLWxvZ3MifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IlJlY29tbWVuZGVkOiBBdHRhY2ggeW91ciBDbG91ZFdhdGNoIGxvZ3MgdG8gdGhlIHRpY2tldCJ9XQ==">
    <div data-prop-text="title">Recommended: Attach your CloudWatch logs to the ticket</div>
    <p>To provide our support team with logging information when opening a ticket:</p>
    <ol>
      <li>
        <p>Invoke the function in AWS Lambda.</p>
      </li>
      <li>
        <p>Click on the <strong>logs</strong> link after your function runs.</p>
      </li>
      <li>
        <p>This will take you to the CloudWatch logs in AWS. On the left-hand sidebar in AWS, under <strong>Logs</strong>, click on <strong>Insights.</strong></p>
      </li>
      <li>
        <p>Select your <strong>function</strong> and also the <strong>newrelic-log-ingestion</strong> stream.</p>
      </li>
      <li>
        <p>Apply an appropriate <strong>Time Filter</strong>, and a log entry <strong>limit</strong> (the default of 20 may not be enough).</p>
      </li>
      <li>
        <p>Under <strong>Actions</strong> select <strong>Copy query results (ASCII)</strong>.</p>
      </li>
      <li>
        <p>Paste the copied text into a new text file, then <strong>save and upload the text file to the ticket.</strong></p>
        <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
          <p>The NR_LAMBDA_MONITORING payload contains all the information the agent attempts to send up, including metrics, events, some AWS account metadata, invocations and errors data. Note that some of that data (for example, our legacy metrics) will not make it to our UI because our ingest pipeline does not consume them.</p>
        </div>
      </li>
    </ol>
  </div>
</div>
