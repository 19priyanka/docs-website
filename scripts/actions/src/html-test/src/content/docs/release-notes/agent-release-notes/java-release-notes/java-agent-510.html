
<h3>Improvements</h3>
<ul>
  <li>
    <p>JAX-RS</p>
    <p>This release adds support for @PATCH JAX-RS annotation. The agent will create and name transactions based @PATCH annotations.</p>
  </li>
</ul>
<h3>Fixes</h3>
<ul>
  <li>Fixes an issue in the Scala instrumentation that would cause an <code>Java.lang.IllegalArgumentException:</code> to be thrown when the Lightbend Cinnamon agent is in use.</li>
  <li>Fixes an issue where <a href="https://docs.newrelic.com/docs/apm/transactions/cross-application-traces/introduction-cross-application-traces">Cross Application Tracing headers</a> were incorrectly parsed when <a href="https://docs.newrelic.com/docs/apm/distributed-tracing/getting-started/introduction-distributed-tracing">Distributed Tracing</a> is enabled. Applications that use both Distributed Tracing and Cross Application Tracing will no longer report external transaction breakdown metrics.</li>
  <li>Fixes an issue where the agentâ€™s Kafka instrumentation would report WakeupExceptions as errors in New Relic. These exceptions will no longer be reported.</li>
  <li>Fixes a Log4J ClassCastException for applications running on the IBM J9 JVM that set a custom logging manager via the <code>-Djava.util.logging.manager</code> system parameter.</li>
  <li>The agent now supports using the <a href="https://docs.newrelic.com/docs/apm/applications-menu/events/thread-profiler-tool">thread profiler</a> when the <a href="https://docs.newrelic.com/docs/agents/java-agent/configuration/java-agent-configuration-config-file#cfg-send_environment_info">send_environment_info configuration</a> is disabled.</li>
</ul>
<h3>Notes</h3>
<ul>
  <li>The agent now sends data to New Relic using gzip compression by default. To use the previous compression set the <code>compressed_content_encoding</code> configuration value to <code>deflate</code></li>
  <li>The jdbc-resultset instrumentation is now disabled by default in the newrelic.yml and will be disabled by default in all future releases.</li>
</ul>
<h3>Known Issues</h3>
<p>Fixed in 5.1.1</p>
<ul>
  <li>gRPC</li>
</ul>
<p>This release contains two bugs in the Java agent's gRPC instrumentation. We highly recommend customers using gRPC instrumentation to upgrade to this and or later agent versions.</p>
<ul>
  <li>References to transaction segments were not being removed correctly, which can cause a memory leak</li>
  <li>The agent could cause the gRPC server listeners to fail to execute its <code>completed</code> and/or <code>cancelled</code> methods, which can cause unexpected behavior</li>
</ul>
