
<h3>New features</h3>
<ul>
  <li>
    <p>Added an option for using the <code>finally</code> method on promises for instrumentation.</p>
    <p>The promise instrumentation would use <code>Promise#finally</code> if available. This change is in response to Node v10 promises calling <code>then</code> inside their <code>finally</code> method, which caused infinite recursion in the agent's promise instrumentation.</p>
  </li>
  <li>
    <p>Added seen/sent/dropped supportability metrics for all event collections.</p>
  </li>
</ul>
<h3>Improvements</h3>
<ul>
  <li>
    <p>Refactored harvest cycle into separate class.</p>
    <p>This refactoring eases managing harvested data and re-merging unharvested values on failure.</p>
  </li>
  <li>
    <p>No longer download gcc on test suites that do not require it.</p>
  </li>
</ul>
<h3>Bug fixes</h3>
<ul>
  <li>
    <p>Updated <code>WebFrameworkShim</code> to handle arrays of routes when wrapping middleware mounters.</p>
    <p>Previously, a transaction that hit a shared middleware (eg, <code>app.use(['/one', '/two'], ...)</code>) would always be tagged with <code>&#x3C;unknown></code> in its name, due to the agent not interpreting arrays of paths. Now transaction names will include all paths for a shared middleware, comma-delimited, followed by the current route (<code>'WebTransaction/Expressjs/GET//one,/two/one'</code>).</p>
  </li>
</ul>
