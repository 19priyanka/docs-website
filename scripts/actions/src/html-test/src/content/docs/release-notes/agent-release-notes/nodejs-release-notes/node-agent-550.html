
<h3>New features</h3>
<ul>
  <li>
    <p>Added <code>SNS</code> to message shim library names.</p>
  </li>
  <li>
    <p>Added check for <code>collect_span_events</code> in config sent from the server on connect.</p>
    <p>Collection of span events can be disabled from the server configuration, but not enabled.</p>
  </li>
</ul>
<h3>Improvements</h3>
<ul>
  <li>
    <p>Refactored <code>Segment#toJSON</code> to be more readable.</p>
  </li>
  <li>
    <p>Added a <code>try/catch</code> to config initialization to safely handle invalid setting combinations.</p>
    <p>When an error is caught the agent is marked as disabled, which ultimately returns a stub API and keeps the process running.</p>
  </li>
  <li>
    <p>String truncation is now done using a binary search over the byte length of the string.</p>
    <p>Previously this truncation was done using a linear search for the proper byte length.</p>
  </li>
  <li>
    <p>Optimized segment and span attribute filtering.</p>
  </li>
</ul>
<h3>Fixes</h3>
<ul>
  <li>
    <p>Fixed issue where <code>shim.createSegment()</code> could result in modifying the parent when opaque.</p>
  </li>
  <li>
    <p>Fixed issue where <code>http-outbound</code> would modify parent segments when parent is opaque.</p>
  </li>
  <li>
    <p>Moved processing of exclusive time attribute out of <code>toJSON</code> and into <code>finalize</code> to only be calculated once.</p>
    <p>Previously, serializing a segment would result in calculating and caching exclusive time which could result in issues if serialized prior to ending.</p>
  </li>
</ul>
