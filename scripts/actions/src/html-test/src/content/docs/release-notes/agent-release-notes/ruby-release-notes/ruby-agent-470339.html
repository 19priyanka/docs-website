
<h3>Notes</h3>
<ul>
  <li>
    <p>Expected Error API</p>
    <p>The agent now sends up <code>error.expected</code> as an intrinsic attribute on error events and error traces. When you pass <code>expected: true</code> to the <code>notice_error</code> method, both Insights and APM will indicate that the error is expected.</p>
  </li>
  <li>
    <p>Typhoeus Hydra Instrumentation</p>
    <p>The agent now has request level visibility for HTTP requests made using Typhoeus Hydra.</p>
  </li>
  <li>
    <p>Total Time Metrics are Recorded</p>
    <p>The agent now records Total Time metrics. In an application where segments execute concurrently, the total time can exceed the wall-clock time for a transaction. Users of the new Typhoeus Hydra instrumentation will notice this as changes on the overview page. Immediately after upgrading there will be an alert in the APM dashboard that states: "There are both old and new time metrics for this time window". This indicates that during that time window, some transactions report the total time metrics, while others do not. The message will go away after waiting for enough time to elapse and / or updating the time window.</p>
  </li>
  <li>
    <p>Add <code>:message</code> category to <code>set_transaction_name</code> public API method</p>
    <p>The agent now permits the <code>:message</code> category to be passed into the public API method <code>set_transaction_name</code>, which will enable the transaction to be displayed as a messaging transaction.</p>
  </li>
  <li>
    <p>Create <code>prepend_active_record_instrumentation</code> config option</p>
    <p>Users may now set the <code>prepend_active_record_instrumentation</code> option in their agent config to install Active Record 3 or 4 instrumentation using <code>Module.prepend</code> rather than <code>alias_method</code>.</p>
  </li>
  <li>
    <p>Use Lazy load hooks for <code>ActionController::Base</code> and <code>ActionController::API</code></p>
    <p>The agent now uses lazy load hooks to hook on <code>ActionController::Base</code> and <code>ActionController::API</code>. Thanks Edouard Chin for the contribution!</p>
  </li>
  <li>
    <p>Use Lazy load hooks for <code>ActiveRecord::Base</code> and <code>ActiveRecord::Relation</code></p>
    <p>The agent uses lazy load hooks when recording supportability metrics for <code>ActiveRecord::Base</code> and <code>ActiveRecord::Relation</code>. Thanks Joseph Haig for the contribution!</p>
  </li>
  <li>
    <p>Check that <code>Rails::VERSION</code> is defined instead of just <code>Rails</code></p>
    <p>The agent now checks that <code>Rails::VERSION</code> is defined since there are cases where <code>Rails</code> is defined but <code>Rails::VERSION</code> is not. Thanks to Alex Riedler and nilsding for the contribution!</p>
  </li>
  <li>
    <p>Support fast RPC/direct reply-to in RabbitMQ</p>
    <p>The agent can now handle the pseudo-queue 'amq.rabbitmq.reply-to' in its Bunny instrumentation. Previously, using fast RPC led to a <code>NoMethodError</code> because the reply-to queue was expected to be a <code>Queue</code> object instead of a string.</p>
  </li>
</ul>
