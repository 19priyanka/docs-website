
<h2>Notes</h2>
<p>This release of the Python agent includes an implementation for w3c trace context, support for uvloop, and various bug fixes.</p>
<p>The agent can be installed using easy_install/pip/distribute via the <a href="https://pypi.python.org/pypi/newrelic">Python Package Index</a> or can be downloaded directly from the New Relic <a href="http://download.newrelic.com/python_agent/release">download site</a>.</p>
<h2>New Features</h2>
<ul>
  <li>
    <p><strong>New APIs for creating / accepting distributed trace headers</strong></p>
    <p>This version of the agent deprecates <code>newrelic.agent.create_distributed_trace_payload</code> and <code>newrelic.agent.accept_distributed_trace_payload</code> in favor of <code>newrelic.agent.insert_distributed_trace_headers</code> and <code>newrelic.agent.accept_distributed_trace_headers</code>. See the Python agent API documentation for details.</p>
  </li>
  <li>
    <p><strong>Support for W3C Trace Context, with easy upgrade from New Relic Trace Context</strong></p>
    <p>Distributed Tracing now supports W3C Trace Context headers for HTTP and gRPC protocols when distributed tracing is enabled. Our implementation can accept and emit both W3C trace header format and New Relic trace header format. This simplifies agent upgrades, allowing trace context to be propagated between services with older and newer releases of New Relic agents. W3C trace header format will always be accepted and emitted. New Relic trace header format will be accepted, and you can optionally disable emission of the New Relic trace header format.</p>
    <p>When distributed tracing is enabled with <code>distributed_tracing.enabled = true</code>, the Python agent will now accept W3C's <code>traceparent</code> and <code>tracestate</code> headers when calling <code>accept_distributed_trace_headers</code>. When calling <code>insert_distributed_trace_headers</code>, the Python agent will include the W3C headers along with the New Relic distributed tracing header, unless the New Relic trace header format is disabled using <code>distributed_tracing.exclude_newrelic_header = true</code></p>
    <p>Also, see the "Known Issues and Workarounds" section of these Release notes.</p>
  </li>
</ul>
<h2>Improved Features</h2>
<ul>
  <li>
    <p><strong>Add support for uvloop</strong></p>
    <p>Transaction context may not have been propagated when using uvloop. This could have resulted in incomplete traces or instrumentation failures when using uvloop. uvloop is now supported.</p>
  </li>
</ul>
<h2>Bug Fixes</h2>
<ul>
  <li>
    <p><strong>Fix crash when using aiohttp_cors</strong></p>
    <p>Customers using the agent with aiohttp_cors may have experienced a crash when the aiohttp_cors framework was used in conjunction with aiohttp class based views. This crash has now been fixed.</p>
  </li>
  <li>
    <p><strong>Fix grpc v1.26 instrumentation errors</strong></p>
    <p>Customers using grpc v1.26 and above may have experienced an error message in the New Relic logs indicating there was an instrumentation error. Additionally, some data may have been missing when this error was encountered. This issue has now been fixed.</p>
  </li>
</ul>
<h2>Known Issues and Workarounds</h2>
<ul>
  <li>If a .NET agent is initiating distributed traces as the root service, you must update that .NET agent to version 8.24 or later before upgrading your downstream New Relic Python agents to this agent release.</li>
</ul>
