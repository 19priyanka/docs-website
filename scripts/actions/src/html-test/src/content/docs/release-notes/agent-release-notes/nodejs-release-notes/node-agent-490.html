
<h3>New features</h3>
<ul>
  <li>
    <p>Added <code>superagent</code> as built-in instrumentation.</p>
    <p>This instrumentation just maintains transaction state when using the <code>superagent</code> module to make HTTP requests with either callbacks or promises.</p>
  </li>
  <li>
    <p>Updated <code>noticeError</code> API method to be partially functional in High Security Mode.</p>
    <p>In HSM, any custom attributes will be ignored, but the error will still be tracked. This brings the Node agent in line with the behavior of other language agents.</p>
  </li>
  <li>
    <p>Added <code>PromiseShim</code> class for instrumenting promise libraries.</p>
  </li>
  <li>
    <p>Support for setting <code>transaction_tracer.transaction_threshold</code> to 0 has been added.</p>
  </li>
</ul>
<h3>Improvements</h3>
<ul>
  <li>Updated DT payload creation to use <code>primary_application_id</code> from connect response.</li>
  <li>Added protection against functions with modified prototypes in <code>shim.applySegment</code>.</li>
  <li>Replaced SQL ID hash generation algorithm with SHA1 instead of MD5 to allow usage in FIPS compliant environments.</li>
  <li>Leveraged 16 hex digits for creation of SQL ID.</li>
  <li>Upgraded ejs module to get rid of Github security warnings. The ejs module was only used for tests and not in main agent code.</li>
  <li>Changes DT payload configuration log messages to debug level as it is not uncommon for calls to occur before server configuration has been retrieved.</li>
  <li>Converted <code>net</code> instrumentation to use shim api.</li>
  <li>Converted child_process instrumentation to newer shim style.</li>
  <li>Converted Timers instrumentation to newer shim style.</li>
  <li>Converted zlib instrumentation to use shim API.</li>
</ul>
<h3>Bug fixes</h3>
<ul>
  <li>
    <p>Fixed <code>codec.decode()</code> callback bug that would re-call a callback with an error thrown within the callback.</p>
  </li>
  <li>
    <p>Fixed bug requiring Cross Application Tracing (CAT) to be enabled for Distributed Tracing (DT) <code>createDistributedTracePayload</code> and <code>acceptDistributedTracePayload</code> APIs to function. DT configuration will no longer consider CAT configuration.</p>
  </li>
  <li>
    <p>Fixed bug in wrap() that would fail to wrap callbacks if the callback index was 0.</p>
  </li>
  <li>
    <p>The agent now respects <code>NEW_RELIC_TRACER_THRESHOLD</code>.</p>
    <p>Previously, this environment variable was stored as a string. The environment variable is now stored as a float.</p>
  </li>
</ul>
