
<h3>Notes</h3>
<p>This release of the Python agent adds introductory support for instrumenting Tornado 4 applications.</p>
<p>The agent can be installed using easy_install/pip/distribute via the <a href="https://pypi.python.org/pypi/newrelic">Python Package Index</a> or can be downloaded directly from our <a href="http://download.newrelic.com/python_agent/release/">download site</a>.</p>
<p>For a list of known issues with the Python agent, see <a href="https://docs.newrelic.com/docs/python/status-of-python-agent">Status of the Python agent</a>.</p>
<h3>New Feature</h3>
<ul>
  <li>Introductory Support for Tornado 4. (See below for details.)</li>
</ul>
<h3>Bug Fix</h3>
<ul>
  <li>Django Template Tags for Browser Monitoring Fixed for Django 1.9</li>
</ul>
<p>For manual insertion of the browser monitoring javascript for page load timing, the Python agent offers two Django template tags: <code>newrelic_browser_timing_header</code> and <code>newrelic_browser_timing_footer</code>.</p>
<p>Starting in <a href="https://docs.djangoproject.com/en/1.9/releases/1.9/#simple-tag-now-wraps-tag-output-in-conditional-escape">Django version 1.9</a>, the output of <code>simple_tag</code> is now escaped, which results in the browser monitoring javascript being included as escaped text in the HTML output. To fix this issue, the agent now uses <code>django.utils.safestring:mark_safe()</code> to prevent automatic escaping for these two template tags.</p>
<h3>Introductory Support for Tornado 4</h3>
<p>New Relic is pleased to announce introductory support for Tornado 4. While not all features are supported at this point, providing it at an early stage allows interested customers to preview our Tornado 4 support, and provide feedback on what works well and what doesn't.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>We strongly advise running the introductory Tornado 4 instrumentation in a testing or staging environment before considering using it in a production environment.</p>
</div>
<p>For detailed information about the introductory Tornado 4 support, including Supported Features, Design Decisions, and Known Limitations, see <a href="https://docs.newrelic.com/docs/agents/python-agent/hosting-mechanisms/introductory-tornado-4-support">Introductory Tornado 4 support</a>.</p>
<h3>Status of Tornado 4 Support</h3>
<p>The following is a list of known limitations for our Tornado 4 support as it exists in the current version of the agent. In the next few releases, we plan to address these issues.</p>
<ul>
  <li>
    <p>If you use <code>psycopg2</code> in aynchronous mode, you must disable explain plans in the Python agent, or else the agent will throw an error when it attempts to run an explain plan query. Add this setting to your <code>newrelic.ini</code> configuration file:</p>
    <pre><code>transaction_tracer.explain_enabled = false
</code></pre>
  </li>
  <li>
    <p>Metric names should be more consistent. For a method of a class, the metric name should contain both the name of the class and the method, but sometimes, the metric name will be missing the class name.</p>
  </li>
  <li>
    <p>The nesting of segments in a Transaction Trace should be improved. Right now, transaction traces give a good indication of the order that callbacks run on the IOLoop, but they do not group together callbacks that belong to the same coroutine, nor do they show how callbacks relate to each other.</p>
  </li>
  <li>
    <p>Transaction Traces mislabel time spent in "Application code". Because the Tornado 4 instrumentation traces all callbacks that run on the IOLoop, nearly everything that happens in a transaction is recorded. Very little is uninstrumented "Application code". When you see "Application code" time in a transaction trace, that usually means that the IOLoop was either busy running callbacks belonging to another transaction, or was waiting and not doing any work. This will be made clearer in a future release.</p>
  </li>
  <li>
    <p>In the current version of the agent, the Total Time for a transaction will always equal the duration of the transaction. In future versions, we may begin measuring the time spent waiting for asynchronous External Traces and Datastore Traces to return results, which will increase the Total Time for a transaction, making it possible to have a Total Time greater than the duration of the transaction.</p>
  </li>
  <li>
    <p>When using <code>tornado.httpclient</code>, no Cross Application Tracing headers are added to the outgoing requests. (This is true for both <code>HTTPClient</code> and <code>AsyncHTTPClient</code>.) That means that the application that the <code>httpclient</code> connects to will not show up in any of the following: trace maps, transaction maps, and service maps.</p>
  </li>
  <li>
    <p>Asynchronous External Traces only trace the initial HTTP connection. They do not trace the time for the response to come back.</p>
  </li>
  <li>
    <p>If you monitor your Tornado 4 application with Synthetics, the Python agent will not capture transaction traces for Synthetics checks, so you will be unable to connect your Synthetics results to APM transaction traces.</p>
  </li>
  <li>
    <p>Measuring thread utilization is disabled for Tornado applications.</p>
  </li>
  <li>
    <p>Exceptions thrown in <code>RequestHandler.initialize()</code> are not recorded.</p>
  </li>
  <li>
    <p>Use of Tornado's built-in multi-process mode to start multiple processes and have them all share the same port is untested and unsupported.</p>
  </li>
  <li>
    <p>Use of <code>tornado.wsgi.WSGIAdapter</code> and <code>tornado.wsgi.WSGIContainer</code> is untested and unsupported.</p>
  </li>
  <li>
    <p>Use of <code>tornado.platform.asyncio</code> to bridge between <code>asyncio</code> and Tornado IOLoop is untested and unsupported. Currently, the agent only supports the use of the <code>tornado.ioloop.IOLoop</code>.</p>
  </li>
  <li>
    <p>Use of the <code>async</code> and <code>await</code> keywords is untested and unsupported.</p>
  </li>
  <li>
    <p>Integration with <code>Twisted</code> is untested and unsupported.</p>
  </li>
</ul>
