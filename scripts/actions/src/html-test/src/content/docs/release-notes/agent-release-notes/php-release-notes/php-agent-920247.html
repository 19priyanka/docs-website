
<h3>New features in 9.2</h3>
<p><strong>More flexibility for container deployments</strong></p>
<ul>
  <li>The PHP daemon and agent no longer have to reside on the same host and can now communicate over a IPv4 or IPv6 TCP socket. This can be configured via the <code>newrelic.daemon.address</code> setting in the agent and the <code>--address</code> command line option for the daemon.</li>
  <li>When terminating the New Relic PHP daemon via the <code>SIGTERM</code> signal (and/or the <code>SIGINT</code> signal if started with the <code>-f</code>, <code>--foreground</code> flag), the daemon will now send all buffered data to New Relic prior to exiting.</li>
  <li>The PHP daemon has introduced a new configuration <code>--watchdog-foreground</code>. This keeps the daemon watchdog process in the foreground, whereas the <code>--foreground</code> configuration keeps the daemon worker process in the foreground. The new configuration makes it possible to use the daemon in a blocking way, without losing the additional stability provided by the watchdog process.</li>
</ul>
<h3>Upgrade notices</h3>
<ul>
  <li>
    <p>The PHP agent has introduced a new configuration <code>newrelic.daemon.address</code> which serves as an alias to <code>newrelic.daemon.port</code>. You may use either to specify the location of the New Relic PHP daemon. If both values are set, <code>newrelic.daemon.address</code> takes precedence.</p>
    <p>Similarly, the PHP daemon has introduced a new configuration <code>--address</code> which serves as an alias to <code>--port</code>. Customers may use either to specify the location of the New Relic PHP daemon. If both values are set, <code>--address</code> takes precedence.</p>
  </li>
  <li>
    <p>When starting the daemon as an external process, the daemon will now wait for up to three seconds for the listening port to be ready to receive connections before forking into the background. This usually occurs in (much) less than a second, and most users with this configuration will notice no difference in practice.</p>
    <p>The time that the daemon will wait can be controlled by setting the <code>--wait-for-port</code> setting with a duration. This duration may be <code>0</code> to prevent any blocking. If the option is omitted, the default value is <code>3s</code>.</p>
    <p>Note that this is not the default configuration shipped with the PHP agent, and generally is only used in conjunction with the PHP agent configured with <code>newrelic.daemon.dont_launch</code> set to <code>3</code>.</p>
    <p>Daemons started in foreground mode (with the <code>--foreground</code> flag) are unaffected, and will behave as before.</p>
  </li>
</ul>
<h3>Bug fixes</h3>
<ul>
  <li>When duplicating database connections to generate explain plans, the agent will no longer make those connections persistent, even if the original connection was persistent.</li>
  <li>The daemon now synchronously handles critical code paths related to harvesting and merging transaction data. This prevents crashes caused by race conditions.</li>
  <li>Previously, the PHP agent was silently ignoring the setting <code>newrelic.daemon.port</code> if the value was outside of the range 1 - 65535. In this case, it used the default value of <code>/tmp/.newrelic.sock</code>. The PHP agent no longer silently ignores these port values; it now logs these errors in <code>php_agent.log</code>.</li>
</ul>
<h3>Known issues and workarounds</h3>
<ul>
  <li><strong>Potential memory exhaustion for long running transactions.</strong> See description under <strong>Known issues and workarounds</strong> in the <a href="https://docs.newrelic.com/docs/release-notes/agent-release-notes/php-release-notes/php-agent-900242">PHP 9.0.0.242 release notes</a>.</li>
</ul>
