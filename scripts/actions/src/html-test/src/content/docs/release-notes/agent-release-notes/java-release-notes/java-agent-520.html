
<h3>Improvements</h3>
<ul>
  <li>
    <p>MongoDB</p>
    <p>This release adds instrumentation for mongo-java-driver clients created using the <a href="https://mongodb.github.io/mongo-java-driver/3.10/javadoc/com/mongodb/client/MongoClients.html">MongoClients class</a> Previous versions of the agent only supported the <a href="https://mongodb.github.io/mongo-java-driver/3.10/javadoc/com/mongodb/MongoClient.html">MongoClient() constructor</a> Note: The MongoDB Asynchronous Java Drivers are not yet supported.</p>
  </li>
  <li>
    <p>Custom request header attributes</p>
    <p>The Java agent now provides a new configuration option to report HTTP request header(s) as <a href="https://docs.newrelic.com/docs/agents/manage-apm-agents/agent-data/agent-attributes">transaction attributes</a>. See <a href="https://docs.newrelic.com/docs/agents/java-agent/configuration/java-agent-configuration-config-file#tt-custom-request-headers">the documentation</a> for more details.</p>
  </li>
  <li>
    <p>Distributed tracing</p>
    <p>Datastore <a href="https://docs.newrelic.com/docs/apm/distributed-tracing/ui-data/span-event">span events</a> now include a db.collection attribute. This field represents the collection or primary table name for the associated query. It is accessible in Insights, Distributed Tracing, and anywhere you get your favorite spans.</p>
  </li>
  <li>
    <p>GC Time</p>
    <p>The Java agent now records time spent waiting for garbage collection during the duration of a transaction and includes the GC time on the corresponding transaction trace as well as the transactions time chart.</p>
    <p>This setting is configurable as follows in the newrelic.yml:</p>
  </li>
</ul>
<pre><code>transaction_tracer:
    gc_time_enabled: true
</code></pre>
<h3>Fixes</h3>
<ul>
  <li>Fixes an issue where very long-running transactions with a large number of <a href="https://docs.newrelic.com/docs/apm/transactions/intro-transactions/transactions-new-relic-apm#segments">segments</a> would cause an excessive amount of memory usage. The agent will no longer trace segments once the <a href="https://docs.newrelic.com/docs/agents/java-agent/configuration/java-agent-configuration-config-file#cfg-tt-segment_limit">segment_limit</a> has been reached.</li>
</ul>
<h3>Notes</h3>
<ul>
  <li>The Java agent now enforces a maximum of 10,000 <a href="https://docs.newrelic.com/docs/agents/java-agent/configuration/java-agent-configuration-config-file#ae-max_samples_stored">transaction events</a> per minute.</li>
</ul>
