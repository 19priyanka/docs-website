
<h3>Notes</h3>
<p>A new version of the agent has been released. Follow standard procedures to <a href="/docs/infrastructure/new-relic-infrastructure/installation/update-infrastructure-agent">update your Infrastructure agent</a>.</p>
<h3>Added</h3>
<p>Improved logging and troubleshooting features:</p>
<ul>
  <li>Logging agent config options at startup (with obfuscation of sensitive data).</li>
  <li>Logging all the config options of the loaded integrations at startup (with obfuscation of sensitive data).</li>
  <li>Improve log messages related to integrations.</li>
  <li>Integrations health checks</li>
  <li>New binary called newrelic-infra-ctl for sending notifications to the agent for:
    <ul>
      <li>Enabling verbose logs for 5 minutes</li>
      <li>Integrations health check</li>
    </ul>
  </li>
</ul>
<h3>Agent daemon notification</h3>
<p>For notifying the agent to perform actions, the newrelic-infra-ctl command was created. It has the sole responsibility of sending a notification to the agent process that's running inside the host.</p>
<p>In Linux this communication happens via POSIX signals. newrelic-infra-ctl first tries to find if there is an agent process running. If it finds it, it checks if the process is running inside a Docker container. This is because signals to Docker containers are sent with the docker kill command. Once it knows the pid and the signaling method to use, it sends a SIGUSR1 signal to the agent. The agent just has to set a signal handler for when it receives a SIGUSR1.</p>
<p>In Windows, things are a little different. The only signals that we could send to the process were exit signals. In Windows processes communicate by sending messages to their respective windows, but you might be wondering (as I was), the agent is a daemon process so it doesn't have a window. The solution, easy, a hidden window. On startup the agent creates a hidden window, and sets a handler that listens for messages that arrive in that window. newrelic-infra-ctl finds that windows and sends messages to it.</p>
<h3>Changed</h3>
<ul>
  <li>Decorate samples with reportingAgent attribute and replace loopback address if found in reportingEndpoint and reportingEntityKey samples attributes.</li>
  <li>Do not log config.pid_file property in the Windows agent.</li>
</ul>
