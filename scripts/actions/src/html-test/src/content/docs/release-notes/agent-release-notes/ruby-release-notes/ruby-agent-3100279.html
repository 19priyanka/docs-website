
<h3>Notes</h3>
<ul>
  <li>
    <p>Support for the Grape framework</p>
    <p>We now instrument the Grape REST API framework! To avoid conflicts with the third-party newrelic-grape gem, our instrumentation will not be installed if newrelic-grape is present in the Gemfile.</p>
    <p>For more details, see <a href="https://docs.newrelic.com/docs/agents/ruby-agent/frameworks/grape-instrumentation">https://docs.newrelic.com/docs/agents/ruby-agent/frameworks/grape-instru...</a></p>
  </li>
  <li>
    <p>Automatic Cross Application Tracing support for all Rack applications</p>
    <p>Previously Rack apps not using Rails or Sinatra needed to include the AgentHooks middleware to get Cross Application Tracing support. With these changes, this is no longer necessary. Any explicit references to AgentHooks can be removed unless the <code>disable_middleware_instrumentation</code> setting is set to <code>true</code>.</p>
  </li>
  <li>
    <p>Metrics no longer reported from Puma master processes</p>
    <p>When using Puma's cluster mode with the preload_app! configuration directive, the agent will no longer start its reporting thread in the Puma master process. This should result in more accurate instance counts, and more accurate stats on the Ruby VMs page (since the master process will be excluded).</p>
  </li>
  <li>
    <p>Better support for Sinatra apps used with Rack::Cascade</p>
    <p>Previously, using a Sinatra application as part of a Rack::Cascade chain would cause all transactions to be named after the Sinatra application, rather than allowing downstream applications to set the transaction name when the Sinatra application returned a 404 response. This has been fixed.</p>
  </li>
  <li>
    <p>Updated support for Rubinius 2.3+ metrics</p>
    <p>Rubinius 2.3 introduced a new system for gathering metrics from the underlying VM. Data capture for the Ruby VM's page has been updated to take advantage of these. Thanks Yorick Peterse for the contribution!</p>
  </li>
  <li>
    <p>Fix for missing ActiveJob traced errors</p>
    <p>ActiveJobs processed by backends where the Ruby agent lacked existing instrumentation missed reporting traced errors. This did not impact ActiveJobs used with Sidekiq or Resque, and has been fixed.</p>
  </li>
  <li>
    <p>Fix possible crash in middleware tracing</p>
    <p>In rare circumstances, a failure in the agent early during tracing of a web request could lead to a cascading error when trying to capture the HTTP status code of the request. This has been fixed. Thanks to Michal Cichra for the fix!</p>
  </li>
</ul>
