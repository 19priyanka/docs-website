
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>The end-of-life date for this agent version is July 29, 2019. To update to the latest agent version, see <a href="/docs/agents/manage-apm-agents/installation/update-new-relic-agent">Update the agent</a>. For more information, see <a href="/docs/agents/manage-apm-agents/maintenance/new-relic-agent-plugin-end-life-policy">End-of-life policy</a>.</p>
</div>
<h3>Notes</h3>
<p>This release of the Python agent includes fixes related to tracking of external web service calls and minor improvements to automatic real user monitoring HTML insertion for Django. An offline developer mode has also be added to verify the operation of the agent with your application in a development or test environment.</p>
<p>The agent can be installed using easy_install/pip/distribute via the <a href="https://pypi.python.org/pypi/newrelic">Python Package Index</a> or can be downloaded directly from our <a href="http://download.newrelic.com/python_agent/release/">download site</a>.</p>
<p>For a list of known issues with the Python agent see our online help article on the <a href="https://newrelic.com/docs/python/status-of-python-agent">status of the Python agent</a>.</p>
<h3>New Features</h3>
<ul>
  <li>
    <p>An offline developer mode for the agent now exists to allow for verification that the operation of the agent will not affect the monitored web application in a development or test environment, without sending any actual data to New Relic. As it is an offline mode, no additional hosts will be recorded against your New Relic account for billing purposes.</p>
    <p>The offline mode does not allow for any viewing of collected metric information and other data for the purposes of monitoring your application, so it is not a solution for running New Relic locally. Being able to run it however, will allow you determine if a newer version of the agent, or an upgrade of any third party package in conjunction with the agent, will still function correctly before you jump to upgrading the packages in your production environment.</p>
    <p>The offline developer mode can be enabled by setting the <code>developer_mode</code> setting in the agent configuration file, or the <code>NEW_RELIC_DEVELOPER_MODE</code> environment variable, to <code>true</code>.</p>
    <p>Audit logging can also be enabled in conjunction with the offline developer mode so as to allow for the investigation of what data would be set to New Relic, resulting from the monitoring of your application, without actually sending any data to New Relic.</p>
    <p>Audit logging itself can be enabled by setting the the <code>audit_log_file</code> setting in the agent configuration file, or the <code>NEW_RELIC_AUDIT_LOG</code> environment variable. It is not recommended that audit logging be enabled for any extended period as the resulting log file will be quite large.</p>
  </li>
</ul>
<h3>Bug fixes/Improvements</h3>
<ul>
  <li>When using the Bottle web framework, the setting <code>error_collector.ignore_status_codes</code>, for ignoring exceptions linked to specific HTTP response status codes, was being ignored in the case of using Bottle plugins and a plugin raised a <code>HTTPError</code> exception. This only affected Bottle versions 0.11 or higher.</li>
  <li>The New Relic feature for <a href="https://docs.newrelic.com/docs/traces/cross-application-traces">cross application tracing</a> between two monitored web applications was not working when a Python web application was using recent versions of the <code>urllib3</code> and <code>requests</code> modules for initiating the call to the back-end web application service. This affected version 1.8 or higher of <code>urllib3</code> and version 2.3.0 of the <code>requests</code> module.</li>
  <li>External web service calls were not being monitored when using the <a href="http://docs.python-requests.org/en/latest/user/advanced/#prepared-requests">prepared requests</a> feature of the <code>requests</code> module directly.</li>
  <li>When using the <code>urllib</code> or <code>urllib2</code> modules, if a URI of the form <code>file://...</code>, corresponding to a local file on the file system, was passed to any function monitored by our instrumentation, a metric and transaction trace node were being generated corresponding to an external web service with host name of 'unknown'. The instrumentation now correctly filters out URIs which do not correspond to an actual remote web service.</li>
  <li>The automatic means for inserting <a href="https://docs.newrelic.com/docs/python/page-load-timing-in-python">page load timing</a> tracking code for real user monitoring (RUM) into HTML page responses returned from a Django application now works no matter the case used for HTML elements. Previously automatic insertion would only be performed where HTML elements were lower case.</li>
  <li>RUM tracking code inserted automatically into HTML page responses from Django is now more optimally placed when a <code>X-UA-Compatible</code> meta tag appeared in the <code>head</code> element of the HTML page. Previously the RUM code was placed at the end of the <code>head</code> element when such a meta tag existed. This would have meant that page loading times would not have accurately reflected time spent in loading assets from any <code>script</code> elements appear after the meta tag. The RUM code is now placed immediately after the meta tag. Placement is not done before the meta tag as some browsers require that the meta tag appear prior to any <code>script</code> elements.</li>
  <li>RUM tracking code inserted automatucally into HTML page responses from Django is now placed after any <code>Content-Type</code> meta tag which also contains a <code>charset</code> attribute. This is necessary as some browsers will not recognise such a meta tag if it does not occur early in the page content. If a <code>script</code> tag was therefore placed before this meta tag it could have resulted in the meta tag being pushed down sufficiently far enough in the page content so as not to be recognised.</li>
  <li>Data corresponding to a long running transaction monitored by the agent, which spanned the time when a server side configuration change was made in the New Relic UI, will now be discarded. This is to avoid a problem where the response time average for web requests on the overview chart would be skewed so as to appear greater at the time a server side configuration change was made. This problem would result as when such a server side configuration change is made, the agent will momentarily disconnect and reregister. In that time, any short lived transactions would not be monitored, but the long running transaction which only completed after registration occurred was incorrecly being recorded, with an undue effect on average response times.</li>
</ul>
