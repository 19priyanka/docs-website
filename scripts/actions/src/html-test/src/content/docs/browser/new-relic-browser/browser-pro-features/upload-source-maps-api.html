
<p>Browser monitoring supports the uploading of <a href="/docs/new-relic-browser-source-maps">source maps</a>, which are used to un-minify error stack traces on the <a href="/docs/browser/new-relic-browser/browser-pro-features/javascript-errors-page-examining-errors-over-time"><strong>JS errors</strong> page</a>. This document explains how to use the API to publish (upload) source maps to Browser.</p>
<h2>Prepare for using the source map API [#questions]</h2>
<p>In order to upload source maps to Browser via the API, you'll need this information:</p>
<ul>
  <li>A <a href="/docs/apis/get-started/intro-apis/types-new-relic-api-keys#user-api-key">user API key</a> (before November 20, 2020, the <a href="/docs/apis/get-started/intro-apis/types-new-relic-api-keys#admin">Admin API key</a> was required; that will still work if already in place)</li>
  <li>The New Relic <a href="/docs/browser/new-relic-browser/installation-configuration/copy-browser-monitoring-license-key-app-id">application ID</a> for the deployed app</li>
  <li>The full <a href="#what-url">JavaScript file URL</a></li>
  <li>Optionally, if the JavaScript URL doesn't automatically have release info appended to it, the <a href="#release-id">release name and ID</a></li>
</ul>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoid2hhdC11cmwifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IldoYXQgaXMgdGhlIEphdmFTY3JpcHQgVVJMPyJ9XQ==">
    <div data-prop-text="title">What is the JavaScript URL?</div>
    <p>Every time the agent captures an error in your code, it's associated with the URL of the JavaScript in which it occurred. This is the <code>src</code> attribute of the script tag in your HTML. This full JavaScript URL is required when sending source maps to Browser.</p>
    <p>You can find the URL for an error's JavaScript file in Browser, on the <strong>JS errors</strong> page. See <a href="/docs/new-relic-browser-source-maps">Browser monitoring source maps</a> for more on finding these errors in the UI.</p>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicmVsZWFzZS1pZCJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiSXMgYSByZWxlYXNlIG5hbWUgYW5kIElEIHJlcXVpcmVkPyJ9XQ==">
    <div data-prop-text="title">Is a release name and ID required?</div>
    <p>Many organizations include a version number or hash in the JavaScript URL. This is generally added to "bust" caches to ensure your users get the most recent version of your code. This type of URL might look something like:</p>
    <ul>
      <li>
        <p><code>https://example.com/assets/application-59.min.js</code></p>
      </li>
      <li>
        <p><code>https://example.com/assets/bundle-d6d031.min.js</code></p>
      </li>
      <li>
        <p><code>https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.js</code></p>
        <p>If your app's URLs automatically have the version info appended to it, the Browser agent has everything it needs in order to match errors with your code. You can move ahead to <a href="#generate">generating source maps</a>.</p>
        <p>If this <strong>doesn't</strong> apply to you, and JS URLs do <strong>not</strong> have version info appended, you’ll have to assist the agent by specifying a <a href="https://docs.newrelic.com/docs/browser-api-newrelicaddrelease">release name and ID with the API</a>.</p>
      </li>
    </ul>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibGltaXRzIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJBcmUgdGhlcmUgbGltaXRzIHRvIHNvdXJjZSBtYXAgdXBsb2Fkcz8ifV0=">
    <div data-prop-text="title">Are there limits to source map uploads?</div>
    <p>There is no limit to the overall number of source maps you can upload. However, the API is rate-limited:</p>
    <ul>
      <li>
        <p>You can upload a maximum of 100 source maps per minute</p>
      </li>
      <li>
        <p>You can upload a maximum of 5,000 source maps per day</p>
        <p>Source map files can be a maximum of 50Mb in size.</p>
      </li>
    </ul>
  </div>
</div>
<h2>Push source maps to New Relic [#publish]</h2>
<p>Now that you have one or more source maps, you are ready to publish it to Browser. You can use any of these methods to send source maps to Browser:</p>
<ul>
  <li>Use the <a href="#npm">New Relic npm module</a> with the API via the command line or via a client-side JavaScript build/deploy script like Gulp or Grunt.</li>
  <li>Use <a href="#api">API curl commands</a>.</li>
  <li>Use the <a href="/docs/new-relic-browser-source-maps">Browser UI</a>.</li>
</ul>
<h2>Use npm module via command line or client-side script [#npm]</h2>
<p>The easiest and recommended way to upload source maps to Browser is to use the our new <a href="https://www.npmjs.com/package/@newrelic/publish-sourcemap">@newrelic/publish-sourcemap npm module</a>. It provides a command line tool and Javascript API to accomplish this task. More documentation is available in the npm repo.</p>
<p>Here are some examples of using the npm module via the command line.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>The following examples are for US accounts. For EU accounts, the endpoint is <code>https://sourcemaps.service.eu.newrelic.com</code>. For more information, see <a href="https://docs.newrelic.com/docs/using-new-relic/welcome-new-relic/getting-started/introduction-eu-region-data-center">Introduction to the EU region data center</a>.</p>
</div>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibnBtLXB1Ymxpc2gifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6Im5wbSBjb21tYW5kIGxpbmU6IFB1Ymxpc2gifV0=">
    <div data-prop-text="title">npm command line: Publish</div>
    <p>Here's an example of uploading source maps using the npm module via the command line. Note that the source map can come from a local file or a remote URL.</p>
    <pre><code>npm install -g @newrelic/publish-sourcemap
publish-sourcemap PATH_TO_SOURCE_MAP_FILE (local or remote) PATH_TO_ORIGINAL_FILE --apiKey=YOUR_NEW_RELIC_USER_API_KEY --applicationId=YOUR_NEW_RELIC_APP_ID

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibnBtLWxpc3QifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6Im5wbSBjb21tYW5kIGxpbmU6IExpc3QgcHVibGlzaGVkIG1hcHMifV0=">
    <div data-prop-text="title">npm command line: List published maps</div>
    <p>Here's an example of listing published source maps:</p>
    <pre><code>list-sourcemaps --applicationId=YOUR_APP_ID --apiKey=YOUR_NEW_RELIC_USER_KEY

Options:
  --applicationId  Browser application id
  --apiKey     New Relic user API key

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibnBtLWRlbGV0ZSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoibnBtIGNvbW1hbmQgbGluZTogRGVsZXRlIn1d">
    <div data-prop-text="title">npm command line: Delete</div>
    <p>Here's an example of deleting a source map:</p>
    <pre><code>delete-sourcemap --applicationId=YOUR_APP_ID --apiKey=YOUR_NEW_RELIC_USER_API_KEY --sourcemapId=YOUR_SOURCE_MAP_ID

Options:
  --applicationId  Browser application id
  --apiKey     New Relic user API key
  --sourcemapId    Unique id generated for a source map

</code></pre>
  </div>
</div>
<p>Here are some examples of using the npm module to publish from client-side JavaScript:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibnBtLWNsaWVudC1wdWJsaXNoIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJucG0gdmlhIE5vZGUuanMgc2NyaXB0OiBQdWJsaXNoIn1d">
    <div data-prop-text="title">npm via Node.js script: Publish</div>
    <p>Here's an example of publishing a source map via a Node.js script:</p>
    <pre><code>var publishSourcemap = require(‘@newrelic/publish-sourcemap’).publishSourcemap 

publishSourcemap({
  sourcemapPath: 'SOURCE_MAP_FULL_PATH',
  javascriptUrl: 'JS_URL',
  applicationId: YOUR_NEW_RELIC_APP_ID,
  apiKey: 'YOUR_NEW_RELIC_USER_API_KEY'
}, function (err) { console.log(err || 'Sourcemap upload done')})

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibnBtLWNsaWVudC1saXN0In0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJucG0gdmlhIE5vZGUuanMgc2NyaXB0OiBMaXN0IHB1Ymxpc2hlZCBtYXBzIn1d">
    <div data-prop-text="title">npm via Node.js script: List published maps</div>
    <p>Here's an example of listing all published source maps:</p>
    <pre><code>var listSourcemaps = require(‘@newrelic/publish-sourcemap’).listSourcemaps

listSourcemaps({
  sourcemapPath: 'SOURCE_MAP_FULL_PATH',
  javascriptUrl: 'JS_URL',
  applicationId: YOUR_NEW_RELIC_APP_ID,
  apiKey: 'YOUR_NEW_RELIC_USER_API_KEY',
}, function (err, res) { console.log(err || res.body)})

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibnBtLWNsaWVudC1kZWxldGUifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6Im5wbSB2aWEgTm9kZS5qcyBzY3JpcHQ6IERlbGV0ZSJ9XQ==">
    <div data-prop-text="title">npm via Node.js script: Delete</div>
    <p>Here's an example of deleting a source map file via a Node.js script:</p>
    <pre><code>var deleteSourcemap = require(‘@newrelic/publish-sourcemap’).deleteSourcemap

deleteSourcemap({
  sourcemapId: 'SOURCE_MAP_ID',
  applicationId: YOUR_NEW_RELIC_APP_ID,
  apiKey: 'YOUR_NEW_RELIC_USER_API_KEY',
}, function (err) { console.log(err || 'Deleted source map')})

</code></pre>
  </div>
</div>
<p>When you're done, go to the <a href="/docs/browser/new-relic-browser/browser-pro-features/javascript-errors-page-examining-errors-over-time"><strong>JS errors</strong> page</a> in Browser, select an error grouping, and see if your error stack traces have been un-minified.</p>
<h2>Use API via curl [#api]</h2>
<p>Below are some examples of using curl to publish, list, and delete source maps:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY3VybC1wb3N0In0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJjdXJsOiBVcGxvYWQgbWFwcyJ9XQ==">
    <div data-prop-text="title">curl: Upload maps</div>
    <p>An example of using API via curl to publish maps to Browser:</p>
    <pre><code>curl -H "Api-Key: YOUR_NEW_RELIC_USER_API_KEY" \ 
   -F "sourcemap=@SOURCE_MAP_PATH" \ 
   -F "javascriptUrl=JS_URL" \ 
   -F "releaseId=YOUR_RELEASE_ID" \ 
   -F "releaseName=YOUR_UI_PAGE" \

https://sourcemaps.service.newrelic.com/v2/applications/YOUR_NEW_RELIC_APP_ID/sourcemaps

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY3VybC1saXN0In0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJjdXJsOiBMaXN0IGV4aXN0aW5nIG1hcHMifV0=">
    <div data-prop-text="title">curl: List existing maps</div>
    <p>Below is an example of how to get a list of source maps previously uploaded to New Relic via curl. New Relic returns the source map's unique <code>SOURCEMAP_ID</code> and its components:</p>
    <pre><code>curl \ 
-H "Api-Key: YOUR_NEW_RELIC_USER_API_KEY" \ 
https://sourcemaps.service.newrelic.com/v2/applications/YOUR_NEW_RELIC_APP_ID/sourcemaps

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY3VybC1kZWxldGUifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6ImN1cmw6IERlbGV0ZSBtYXAifV0=">
    <div data-prop-text="title">curl: Delete map</div>
    <p>To delete a source map:</p>
    <ol>
      <li>
        <p>Use the GET endpoint to list existing source maps and locate the <code>SOURCEMAP_ID</code>.</p>
      </li>
      <li>
        <p>Run the following command via curl:</p>
        <pre><code>curl -X DELETE \
     -H "Api-Key: YOUR_NEW_RELIC_USER_API_KEY" \
https://sourcemaps.service.newrelic.com/v2/applications/YOUR_NEW_RELIC_APP_ID/sourcemaps/SOURCEMAP_ID
</code></pre>
      </li>
    </ol>
  </div>
</div>
<p>When you're done, go to the <a href="/docs/browser/new-relic-browser/browser-pro-features/javascript-errors-page-examining-errors-over-time"><strong>JS errors</strong> page</a> in Browser, select an error grouping, and see if your error stack traces have been un-minified.</p>
<h2>Troubleshoot source maps [#troubleshoot]</h2>
<p>If you are having trouble generating source maps from your build system, or if your errors in Browser are remaining minified, see the <a href="/docs/new-relic-browser-source-maps#troubleshoot">source maps troubleshooting</a> documentation.</p>
