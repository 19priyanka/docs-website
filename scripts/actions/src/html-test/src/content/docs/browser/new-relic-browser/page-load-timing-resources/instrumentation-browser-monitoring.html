
<p>For standard <a href="/docs/browser/new-relic-browser/page-load-timing/page-load-timing-process">page load timing</a>, sometimes referred to as real user monitoring (RUM), we measure the overall time to load the entire webpage. Additional monitoring after page load provides details on in-page AJAX calls, JavaScript errors, and other events and interactions.</p>
<p>Browser monitoring can leverage the New Relic agent to dynamically inject JavaScript into pages as they are built, in order to collect more detailed back-end timing information. Browser can also monitor apps with <a href="/docs/browser/single-page-app-monitoring/get-started/add-apps-single-page-app-monitoring">single-page application (SPA) architectures</a>.</p>
<h2>Instrumentation to collect browser data [#instrumentation]</h2>
<p>To collect data, Browser monitoring uses JavaScript elements pasted or injected into your webpages, typically as part of the HEAD of the page, containing configuration details and essential browser environment instrumentation. Once the page finishes loading, an additional script is downloaded from a CDN server. This additional script processes the collected data and reports it back to New Relic via <strong>bam.nr-data.net</strong> so that you can see the data in your New Relic account.</p>
<p>The script elements can be injected automatically or via the <a href="/docs/browser/new-relic-browser/installation-configuration/browser-settings-ui-options-browser-monitoring#agent-instrumentation">agent API</a> by an APM agent installed in the back-end application, or they can be <a href="/docs/browser/new-relic-browser/installation-configuration/adding-apps-new-relic-browser#copy-paste-app">inserted manually via copy/paste</a>. Both API calls and the copy/paste method allow you to control when and where the script elements are inserted.</p>
<p>We use these methods to collect the page load timing information:</p>
<div data-component="Table" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibmF2aWdhdGlvbi1hcGkifV0=">
  <div>
    <div>
      <div>
        <p><strong>Method</strong></p>
      </div>
      <div>
        <p><strong>Collecting page load timing information</strong></p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>Browsers <strong>with</strong> Navigation Timing Specification API</p>
      </div>
      <div>
        <p>For browsers that implement the <a href="http://www.w3.org/TR/navigation-timing/" title="Link opens in a new window">Navigation Timing Specification</a> API, page load timing information is read from the browser and reported to New Relic by the browser agent. The appropriate values simply are read from the webpage's performance timing object to capture the timing information.</p>
        <ul>
          <li><strong>Navigation start</strong>: <code>navigationStart</code></li>
          <li><strong>First byte</strong>: <code>responseStart</code></li>
          <li><strong>DOM ready</strong>: <code>DOMContentLoadedEventEnd</code></li>
          <li><strong>Page ready</strong>: <code>loadEventEnd</code></li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p>Browsers <strong>without</strong> Navigation Timing Specification API</p>
      </div>
      <div>
        <p>For browsers that do not implement the Navigation Timing Specification API, we rely on the <a href="/docs/browser/new-relic-browser/miscellaneous/new-relic-cookies#nreum">NREUM cookie</a> and the browser agent to collect timing information.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Additional instrumentation</p>
      </div>
      <div>
        <p>Browser also uses:</p>
        <ul>
          <li>Instrumentation of the <code>XMLHttpRequest</code> object to collect <a href="/docs/browser/new-relic-browser/browser-pro-features/ajax-dashboard-identifying-time-consuming-calls">AJAX timing data</a>.</li>
          <li>Instrumentation of JavaScript functions to collect uncaught <a href="/docs/browser/new-relic-browser/browser-pro-features/js-errors-dashboard-examining-errors-over-time">JavaScript errors</a>.</li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p>Resource Timing API</p>
      </div>
      <div>
        <p>For browsers that implement the <a href="http://www.w3.org/TR/resource-timing/">Resource Timing API</a>, the Browser agent reads and reports <a href="/docs/browser/new-relic-browser/browser-pro-features/session-traces-exploring-webpages-life-cycle">session trace</a> details.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Single page app (SPA) monitoring</p>
      </div>
      <div>
        <p>For <a href="https://docs.newrelic.com/docs/browser/single-page-app-monitoring/get-started/spa-compatibility-requirements">SPA monitoring</a>, we require the <a href="http://www.w3.org/TR/navigation-timing/">Navigation Timing Specification</a> API and the <code>addEventListener</code> API.</p>
      </div>
    </div>
  </div>
</div>
<h2>JavaScript placement requirements [#javascript-placement]</h2>
<p>Injecting the JavaScript inline in the HEAD is an unusual requirement for a JavaScript library, and different from how third-party scripts are typically included. We require this so that Browser provides accurate information without impacting page load performance.</p>
<p>The injected browser JavaScript elements wrap many of the browser's built in APIs to record information about JavaScript errors or callback timings. The unusual placement of the code element is necessary for the following reasons:</p>
<ul>
  <li>The inline HEAD placement ensures the instrumentation code is loaded before all other scripts so that wrapping will occur when other libraries are registered.</li>
  <li>Inline code placement also eliminates the network round trips caused by externally referenced scripts.</li>
</ul>
<h2>Data transmission [#transmission]</h2>
<p>For both https <strong>and</strong> http webpages, we transmit data via https. This summarizes when the data is transmitted to and from the webpage.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>New Relic requires support of the SHA256 hash function, which some older operating systems do not support. If an end user lacks SHA256, the Browser agent will not connect to New Relic and data will not be sent.</p>
</div>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p><strong>Data transmission</strong></p>
      </div>
      <div>
        <p><strong>Frequency</strong></p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>Fetch the agent script</p>
      </div>
      <div>
        <p>Once following page load via https</p>
      </div>
    </div>
    <div>
      <div>
        <p>Send page load timing data</p>
      </div>
      <div>
        <p>Once following page load via https</p>
      </div>
    </div>
    <div>
      <div>
        <p>Send AJAX and JavaScript error data</p>
      </div>
      <div>
        <p>Once per minute when there is activity via https</p>
      </div>
    </div>
    <div>
      <div>
        <p>Send session trace data</p>
      </div>
      <div>
        <p>Every ten seconds when there is activity and a session trace is occurring via https</p>
      </div>
    </div>
    <div>
      <div>
        <p>Send SPA data</p>
      </div>
      <div>
        <p>At the end of an interaction via https</p>
      </div>
    </div>
  </div>
</div>
<h2>For more help [#more_help]</h2>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>For an example of how our engineers used page load timing to improve our own app performance when developing Browser, read this <a href="http://blog.newrelic.com/?p=14625">blog post</a>.</p>
</div>
