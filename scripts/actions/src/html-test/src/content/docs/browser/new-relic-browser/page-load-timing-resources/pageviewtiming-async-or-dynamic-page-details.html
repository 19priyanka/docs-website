
<p>Browser monitoring's <a href="https://docs.newrelic.com/attribute-dictionary/pageview?attribute_name=&#x26;events_tids%5B%5D=10061"><code>PageViewTiming</code> event</a> sends each data point as a separate event as soon as it is available. Because we do not restrict the timing, you can receive first paint or first interaction data regardless of when it fires. This document describes why and how to use <code>PageViewTiming</code> and its attributes to query data about your site, component loading, and user performance metrics, both from visual and responsiveness standpoints.</p>
<h2>Why use PageViewTiming? [#why-pageviewtiming]</h2>
<p>If your application uses asynchronous or dynamic pages, you may need additional details about site or component loading. But pages can load content in many different ways, and users control when they interact with that content. This is why some user-centric performance metrics happen outside the standard window onload (page load time) in the Browser agent.</p>
<p>For example, users may become impatient and begin clicking as soon as content is on the webpage. Or, they may wait to use the page until long after content is loaded.</p>
<p>The <code>PageViewTiming</code> event provides a more real-time delivery mechanism that does not have a dependency on any other event. The additional metrics can help you understand how users experience your site, both from visual and responsiveness standpoints.</p>
<h2>Support for Google's Core Web Vitals</h2>
<p>We now, with the release of <a href="https://docs.newrelic.com/docs/release-notes/new-relic-browser-release-notes/browser-agent-release-notes/browser-agent-v1177">agent version 1177</a>, have full support for <a href="https://web.dev/vitals/">Google's Core Web Vitals</a> for 2020. The metrics that make up Core Web Vitals will <a href="https://web.dev/vitals/#evolving-web-vitals">evolve</a> over time. The current set for 2020 focuses on three aspects of the user experience—<em>loading</em>, <em>interactivity</em>, and <em>visual stability</em>—and includes the following metrics (and their respective thresholds):</p>
<p>
  <img src="./images/core-web-vitals_0.png" alt="A diagram showing the three components of the Core Web Vitals metrics." title="Core Web Vitals diagram">
</p>
<p>Core Web Vitals metrics include loading, interactivity, and visual stability.</p>
<ul>
  <li><strong><a href="https://web.dev/lcp/">Largest Contentful Paint (LCP)</a></strong>: measures <em>loading</em> performance. To provide a good user experience, LCP should occur within <strong>2.5 seconds</strong> of when the page first starts loading.</li>
  <li><strong><a href="https://web.dev/fid/">First Input Delay (FID)</a></strong>: measures <em>interactivity</em>. To provide a good user experience, pages should have a FID of less than <strong>100 milliseconds</strong>.</li>
  <li><strong><a href="https://web.dev/cls/">Cumulative Layout Shift (CLS)</a></strong>: measures <em>visual stability</em>. To provide a good user experience, pages should maintain a CLS of less than <strong>0.1.</strong></li>
</ul>
<p>For each of the above metrics, to ensure you're hitting the recommended target for most of your users, a good threshold to measure is the <strong>75th percentile</strong> of page loads, segmented across mobile and desktop devices.</p>
<h2>Detailed visual, interactivity, and responsiveness metrics [#interactivity-metrics]</h2>
<p>The <code>BrowserInteraction</code> and <code>PageView</code> events end their reporting when they receive the <a href="/docs/browser/new-relic-browser/page-load-timing-resources/page-load-timing-process">page window load</a> (or window load and AJAX) timing. However, paint and interactivity metrics can happen at any time. <code>PageViewTiming</code> delivers these metrics as a separate event to:</p>
<ul>
  <li>Account for the variability in this timing.</li>
  <li>Avoid setting an arbitrary timeout.</li>
  <li>Prevent holding <code>BrowserInteraction</code> and <code>PageView</code> events indefinitely.</li>
</ul>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Additional data</p>
      </div>
      <div>
        <p>Comments</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>firstPaint</code> and <code>firstContentfulPaint</code></p>
      </div>
      <div>
        <p>The <a href="https://docs.newrelic.com/attribute-dictionary/pageviewtiming/firstpaint"><code>firstPaint</code></a> and <a href="https://docs.newrelic.com/attribute-dictionary/pageviewtiming/firstContentfulPaint"><code>firstContentfulPaint</code></a> attributes already are available with <code>BrowserInteraction</code> and <code>PageView</code> events. However, they are not always reliably captured before the window onload event fires.</p>
        <p>Using <code>PageViewTiming</code> gives you a way to capture these metrics even if they happen after the original page load time. This gives you a better understanding of the correlation between responsiveness of that load event and the visual rendering of your content.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>largestContentfulPaint</code></p>
      </div>
      <div>
        <p>This new metric, available with <a href="https://docs.newrelic.com/docs/release-notes/new-relic-browser-release-notes/browser-agent-release-notes/browser-agent-v1163">agent version 1163</a>, <a href="https://docs.newrelic.com/attribute-dictionary/pageviewtiming/largestcontentfulpaint"><code>largestContentfulPaint</code></a>, reports the render time of the largest content element visible in the viewport. Google's research found looking at when the largest element was rendered was a more accurate way to measure when the main content of a page is loaded and useful. Details on this metric, including limitations and considerations can be found in the <a href="https://wicg.github.io/largest-contentful-paint/">w3c draft</a>.</p>
        <p>In addition, we now report the cumulative layout shift (CLS) score attribute with LCP. This attribute is reported as <code>cumulativeLayoutShift.</code></p>
        <p>Largest Contentful Paint is one of three metrics identified by Google as the <a href="https://web.dev/vitals/">Core Web Vitals</a>. LCP values up to 2.5 secs are considered "Good", between 2.5-4.0 secs considered "Needs Improvement", and above 4.0 secs considered "Poor."</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>firstInteraction</code> and <code>firstInputDelay</code></p>
      </div>
      <div>
        <p>With the addition of <a href="https://docs.newrelic.com/attribute-dictionary/pageviewtiming/firstinteraction"><code>firstInteraction</code></a> and <a href="https://docs.newrelic.com/attribute-dictionary/pageviewtiming/firstinputdelay"><code>firstInputDelay</code></a>, you can quickly determine the ways that your users are interacting with that visual content. These metrics tell you not only when they interacted, but what type of interaction (mousedown, pointerdown, etc.) and how long it took for them to receive a response from your site.</p>
        <p>The <code>firstInputDelay</code> metric lies in the middle of <code>FirstContentfulPaint</code> and Time to Interactive (TTI) metrics, measuring the time between when a first input can be made and when the browser's main thread is able to respond to any interactions.</p>
        <p>In addition, we now report the cumulative layout shift (CLS) score attribute at the moment of the user's first interaction. This attribute is reported as <code>cumulativeLayoutShift.</code></p>
        <p>First Input Delay is one of three metrics identified by Google as the <a href="https://web.dev/vitals/">Core Web Vitals</a>. FID values up to 100 ms are considered "Good", between 100-300 ms considered "Needs Improvement", and above 300 ms considered "Poor."</p>
        <p>For a more detailed explanation, see the <a href="/docs/release-notes/new-relic-browser-release-notes/browser-agent-release-notes/browser-agent-v1153">Browser release notes</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>cumulativeLayoutShift</code></p>
      </div>
      <div>
        <p><a href="https://web.dev/cls/">Cumulative Layout Shift (CLS)</a>, available with <a href="https://docs.newrelic.com/docs/release-notes/new-relic-browser-release-notes/browser-agent-release-notes/browser-agent-v1177">agent v1177</a>, is an important, user-centric metric for measuring <a href="https://web.dev/user-centric-performance-metrics/#types-of-metrics">visual stability</a> because it helps quantify how often users experience unexpected layout shifts—a low CLS helps ensure that the page is <a href="https://web.dev/user-centric-performance-metrics/#questions">delightful</a>. This is one of three metrics identified by Google as the <a href="https://web.dev/vitals/">Core Web Vitals</a>.</p>
        <p>Cumulative Layout Shift is one of three metrics identified by Google as the <a href="https://web.dev/vitals/">Core Web Vitals</a>. CLS scores up to 0.1 are considered "Good", between 0.1-0.25 considered "Needs Improvement", and above 0.25 considered "Poor."</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>timingName</code></p>
      </div>
      <div>
        <p>You can review different types of activities with the <code>timingName</code> attribute, such as <code>firstPaint</code>, <code>firstContentfulPaint</code>, <code>firstInteraction, largestContentfulPaint, pageHide and windowUnload</code>. For example, a <code>PageViewTiming</code> event may have a <code>timingName</code> of <code>firstPaint</code> and a <code>firstPaint</code> value of <code>.03</code>. The event will also include all default attributes included with the standard <code>BrowserInteraction</code> and <code>PageView</code> events.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>elementId</code></p>
      </div>
      <div>
        <p>This is the Id, if specified, of the <code>largestContentfulPaint</code> element. This value will only be reported with the LCP metric. This value can be <code>null</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>elementSize</code></p>
      </div>
      <div>
        <p>This is the reported size of the <code>largestContentfulPaint</code> element. This value will only be reported with the LCP metric.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>pageHide</code></p>
      </div>
      <div>
        <p>The <code>pageHide</code> event, available with <a href="https://docs.newrelic.com/docs/release-notes/new-relic-browser-release-notes/browser-agent-release-notes/browser-agent-v1177">agent v1177</a>, is sent when the browser hides the current page in the process of presenting a different page from the session's history. For example, when the user clicks the browser's Back button, the current page receives a <code>pageHide</code> event before the previous page is shown. Supporting documentation and browser compatibility for the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/pagehide_event">pageHide event can be found in MDN docs</a>.</p>
        <p>In addition, we now report the cumulative layout shift (CLS) score attribute with <code>pageHide</code>. This attribute is reported as <code>cumulativeLayoutShift.</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><code>windowLoad</code></p>
      </div>
      <div>
        <p>The windowLoad event, available with <a href="https://docs.newrelic.com/docs/release-notes/new-relic-browser-release-notes/browser-agent-release-notes/browser-agent-v1177">agent v1177</a>, is fired when the whole page has loaded, including all dependent resources such as stylesheets and images. Supporting documentation and browser compatibility for the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/load_event">Window Load event can be found in MDN docs</a>.</p>
        <p>In addition, we now report the cumulative layout shift (CLS) score attribute with <code>windowLoad</code>. This attribute is reported as <code>cumulativeLayoutShift.</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><code>windowUnload</code></p>
      </div>
      <div>
        <p>The <code>windowUnload</code> event, available with <a href="https://docs.newrelic.com/docs/release-notes/new-relic-browser-release-notes/browser-agent-release-notes/browser-agent-v1163">agent v1163</a>, is fired when a document or child resource is being unloaded. Supporting documentation and browser compatibility for the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/unload_event">Window Unload event can be found in MDN docs</a>.</p>
        <p>In addition, we now report the cumulative layout shift (CLS) score attribute with <code>windowUnload</code>. This attribute is reported as <code>cumulativeLayoutShift.</code></p>
      </div>
    </div>
  </div>
</div>
<h2>Compatibility and requirements [#requirements]</h2>
<p>In addition to Browser's <a href="/docs/browser/new-relic-browser/getting-started/compatibility-requirements-new-relic-browser">installation requirements</a>, the <code>PageViewTiming</code> event requires <a href="https://docs.newrelic.com/docs/release-notes/new-relic-browser-release-notes/browser-agent-release-notes">Browser agent version 1153 or higher</a> and a Browser Pro subscription. Follow our <a href="https://docs.newrelic.com/docs/release-notes/new-relic-browser-release-notes/browser-agent-release-notes">Browser agent release notes</a> to find out when new metrics are released.</p>
<p>These metrics are supported by the following browser versions. For unsupported browsers, no <code>PageViewTiming</code> events will be recorded.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Metrics</p>
      </div>
      <div>
        <p>Supported browser versions</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>cumulativeLayoutShift</code></p>
      </div>
      <div>
        <ul>
          <li>Chrome 79
            <ul>
              <li>Metric is elevated to stable; changes in metric definition will be reported in this log.</li>
            </ul>
          </li>
          <li>Chrome 77
            <ul>
              <li>Metric exposed via API: <a href="https://web.dev/cls/">Cumulative Layout Shift</a> available via <a href="https://github.com/WICG/layout-instability">Layout Instability API</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p><code>firstPaint</code></p>
        <p><code>firstContentfulPaint</code></p>
      </div>
      <div>
        <ul>
          <li>Chrome 60 or higher for desktop and mobile (Android webview and Chrome for Android)</li>
          <li>Opera 47 or higher for desktop</li>
          <li>Opera 44 or higher for Android mobile</li>
          <li>Samsung Internet for mobile</li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p><code>largestContentfulPaint</code></p>
      </div>
      <div>
        <ul>
          <li>Chrome 77 or higher for desktop and mobile</li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p><code>firstInteraction</code></p>
        <p><code>firstInputDelay</code></p>
      </div>
      <div>
        <p>These metrics require the <a href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener"><code>addEventListener</code> Browser API</a>. This API is available in all modern browsers, including:</p>
        <ul>
          <li>Apple Safari</li>
          <li>Google Chrome</li>
          <li>Microsoft Internet Explorer (IE) versions 9 or higher</li>
          <li>Mozilla Firefox</li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p><code>pageHide</code></p>
      </div>
      <div>
        <p>This metric is currently supported by all browsers on desktop and mobile. <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/pagehide_event#Browser_compatibility">Compatibility matrix via MDN documentation</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>windowLoad</code></p>
      </div>
      <div>
        <p>This metric is currently supported by all browsers on desktop and mobile. <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/load_event#Browser_compatibility">Compatibility matrix via MDN documentation</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>windowUnload</code></p>
      </div>
      <div>
        <p>This metric is currently supported by all browsers on desktop and mobile. <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/unload_event#Browser_compatibility">Compatibility matrix via MDN documentation</a>.</p>
      </div>
    </div>
  </div>
</div>
<h2>Query your event data [#insights-queries]</h2>
<p>Here are some sample queries for the event data to help you get started.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicGVyY2VudGlsZS10aW1lIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJQZXJjZW50aWxlIG92ZXIgdGltZXNlcmllcyJ9XQ==">
    <div data-prop-text="title">Percentile over timeseries</div>
    <p>Show the 95th percentile of first paint and first contentful paint over a time series:</p>
    <pre><code>SELECT FILTER(percentile(firstPaint, 95), where(timingName = 'firstPaint')) as 'fp', FILTER(percentile(firstContentfulPaint, 95), where(timingName = 'firstContentfulPaint')) as 'fcp' FROM PageViewTiming TIMESERIES 1 minute SINCE 1 hour ago

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicGVyY2VudGlsZS10cmFuc2FjdGlvbiJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiUGVyY2VudGlsZSBieSB0cmFuc2FjdGlvbiBhbmQgaW50ZXJhY3Rpb24ifV0=">
    <div data-prop-text="title">Percentile by transaction and interaction</div>
    <p>Show the 95th percentile of first input delay over a time series, faceted by transaction name and interaction type:</p>
    <pre><code>SELECT percentile(firstInputDelay, 95) as 'fid' FROM PageViewTiming WHERE timingName = 'firstInteraction' TIMESERIES 1 minute FACET browserTransactionName, interactionType SINCE 3 hours ago

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiaGlzdG9ncmFtLWRlbGF5In0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJIaXN0b2dyYW0gb2YgZGVsYXkgdGltaW5ncyJ9XQ==">
    <div data-prop-text="title">Histogram of delay timings</div>
    <p>Show a histogram of first input delay timings faceted by first interaction time ranges:</p>
    <pre><code>FROM PageViewTiming SELECT histogram(firstInputDelay, 1000, 10) SINCE 3 hours ago WHERE timingName = 'firstInteraction' FACET CASES (WHERE firstInteraction &#x3C; 1, WHERE firstInteraction >= 1 AND firstInteraction &#x3C; 5, WHERE firstInteraction >= 5)

</code></pre>
  </div>
</div>
