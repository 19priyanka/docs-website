
<p>New Relic mobile monitoring includes a number of ways to customize and extend the data your mobile app reports. We refer to this type of implementation as "custom instrumentation." This document explains how to get additional data into New Relic, and how to view that new data in the UI.</p>
<h2>Choose a custom data type [#choose-type]</h2>
<p>You can use these options to create your own data types for custom instrumentation for your mobile apps. Using these four options, you can get a wide range of data based on your needs for your apps.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Custom data options</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><a href="#custom-attributes">Session-level custom attributes</a></p>
      </div>
      <div>
        <p>In creating your own attributes, consisting of a key-value pair, you can add custom data for use in tracking session data.</p>
      </div>
    </div>
    <div>
      <div>
        <p><a href="#custom-breadcrumbs">Custom breadcrumbs</a></p>
      </div>
      <div>
        <p>Useful for troubleshooting crash causes, custom breadcrumb events track the user's code-level path through the app by seeing which breadcrumb API calls were reached and reporting app status details from those moments.</p>
      </div>
    </div>
    <div>
      <div>
        <p><a href="#custom-interactions">Custom interactions</a></p>
      </div>
      <div>
        <p>Custom interactions give you tracing power so you can debug method timings and improve network call efficiency. A common use of interactions is to understand the underlying activity associated with loading a particular app screen.</p>
      </div>
    </div>
    <div>
      <div>
        <p><a href="#custom-events">Custom events</a></p>
      </div>
      <div>
        <p>You can instrument custom events to collect data about user activity as a user navigates through your app. That user activity will in turn trigger other data collection: a collection of breadcrumbs, auto-instrumented HTTP requests and errors, auto-instrumented interactions, and custom interactions.</p>
      </div>
    </div>
  </div>
</div>
<h2>Add session-level custom attributes [#custom-attributes]</h2>
<p>Custom attributes annotate (or "tag") your mobile monitoring data. A custom attribute consists of a key-value pair. For example, you might create the key <code>userEmail</code> with values such as <code>alice@bigcorp.test</code> and <code>bob@example.com</code>. The agent automatically attaches custom attributes to <a href="/docs/insights/insights-data-sources/default-data/mobile-default-event-attributes-insights">default mobile monitoring data</a>, and to any breadcrumbs or custom events you create.</p>
<p>You can use custom attributes to capture usage data that's relevant to your business. Common examples include account names or IDs, user emails, and subscription levels. You can then filter and facet in the <a href="/docs/mobile-monitoring/mobile-monitoring-ui/crashes/crash-analysis-group-filter-your-crashes">Crash analysis page</a> and via NRQL query.</p>
<p>Setting custom attributes will add the key-value pair information at the session level. All <a href="/docs/insights/insights-data-sources/default-data/mobile-default-event-attributes-insights">default mobile monitoring events</a> inherit these session-level custom attributes.</p>
<p>As a best practice, use custom attributes to track a single value for a key that can be true across a session (for example, a user's subscription level, or whether SAML was used to log in).</p>
<p>To track the change of a value over the course of a session, like a change in connection type, you would instead record a <a href="#custom-breadcrumbs">breadcrumb</a> and its own custom attributes. To track a series of discrete user actions that occur across the course of a session, use <a href="#custom-events">custom events</a>.</p>
<p>To add custom attributes, see:</p>
<ul>
  <li><strong>Android</strong>: Use <a href="/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/set-attribute"><code>setAttribute()</code></a> and <a href="/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/increment-attribute"><code>incrementAttribute()</code></a>.</li>
  <li><strong>iOS</strong>: Use <a href="/docs/mobile-monitoring/new-relic-mobile-ios/ios-sdk-api/set-attribute"><code>setAttribute()</code></a> and <a href="/docs/mobile-monitoring/new-relic-mobile-ios/ios-sdk-api/increment-attribute"><code>incrementAttribute()</code></a>.</li>
</ul>
<h2>Record breadcrumbs [#custom-breadcrumbs]</h2>
<p>Breadcrumbs track the state of your app as it runs, then report a snapshot of that state if your app crashes. This allows you to debug your mobile app crashes more easily.</p>
<p><a href="#custom-interactions">Custom interactions</a> only inherit custom attributes created at the session level. Breadcrumbs will inherit those same session-level custom attributes, but optionally you can also report additional custom attributes specific to each <code>recordBreadcrumb()</code> API call.</p>
<p>You can use breadcrumbs in several ways:</p>
<ul>
  <li>You could record a breadcrumb event when your app receives an HTTP response, and also record the values in that response as custom attributes (for example, the response might tell the app what screen to display next or recording unique timestamps for each change in the course of a session). If the app crashes or throws errors, you will be able to see invalid data from the HTTP response.</li>
  <li>You could track the success of each step of your user login process, with perhaps a <code>status</code> attribute recording a <code>success</code> or <code>failure</code> key for each step. This would let you debug which step is causing issues.</li>
</ul>
<p>Once you have released a version of your app that creates <code>MobileBreadcrumb</code> custom events, you can see them in the <a href="/docs/mobile-monitoring/mobile-monitoring-ui/crashes/mobile-crash-event-trail">crash event trail</a> whenever they appear in the app's code path as part of a crashed session. You can also <a href="/docs/insights/nrql-new-relic-query-language/using-nrql/introduction-nrql">query them using NRQL</a> and query either all breadcrumbs or just breadcrumbs from crashed sessions. This lets you see the frequency of app paths that include that particular breadcrumb.</p>
<p>To add custom breadcrumbs, see:</p>
<ul>
  <li><strong>Android</strong>: Use <a href="/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/recordbreadcrumb"><code>recordBreadcrumb()</code></a>.</li>
  <li><strong>iOS</strong>: Use <a href="/docs/mobile-monitoring/new-relic-mobile-ios/ios-sdk-api/record-breadcrumb"><code>recordBreadcrumb()</code></a>.</li>
</ul>
<h2>Create custom interactions [#custom-interactions]</h2>
<p>Our mobile monitoring agent begins instrumenting an interaction when it detects a screen load or partial screen load (such as fragments for Android or view controllers for iOS). New Relic automatically traces slow interactions, providing a complete, in-depth picture of a single slow interaction, including the methods that were called, what network requests were made, and the CPU and memory usage once that interaction started.</p>
<p>Our mobile monitoring automatically selects data-rich traces. The specific criteria the agent looks for are interactions whose instrumented methods account for at least 30% of the overall interaction time.</p>
<p>In addition to the auto-instrumentation, you can start a custom interaction to force the agent to start recording a trace beginning at that point in your app code and continuing across the subsequent methods and network calls. Custom interaction traces provide deep information. However, they increase the overhead of the agent compared to other custom data collection methods because of the large amount of data collected for the entire duration of an interaction.</p>
<p>When associated with a crash, custom interactions show up in the <a href="/docs/mobile-monitoring/mobile-monitoring-ui/crashes/mobile-crash-event-trail">crash event trail</a>. You can also <a href="/docs/insights/nrql-new-relic-query-language/using-nrql/introduction-nrql">query them with NRQL</a> for flexible analysis.</p>
<p>Interactions are powerful for tracing but are less flexible in other ways than other custom data types: While custom breadcrumbs and custom events let you optimize your <a href="/docs/insights/insights-data-sources/custom-events/insert-custom-events-attributes-mobile-data">custom attributes</a> to specific events, interactions can only inherit session-level attributes.</p>
<p>You can also manually end a custom interaction. However, ensure that the interaction includes enough method activity to be recorded. If the agent does not detect any traced activity for 0.5 seconds, the agent stops the interaction tracing because it is assumed no interesting data remains. In addition, the agent can only trace one interaction at a time, so if a new interaction is triggered the current trace will automatically be stopped in preference for the new trace.</p>
<p>To add custom interaction traces, see:</p>
<ul>
  <li><strong>Android</strong>: Use <a href="/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/start-interaction"><code>startInteraction()</code></a> and <code>endInteraction().</code></li>
  <li><strong>iOS</strong>: <a href="/docs/mobile-monitoring/new-relic-mobile-ios/api-guides/work-ios-sdk-api#objc-interactions">Create and complete interactions</a>.</li>
</ul>
<p>You can also configure interaction tracing globally:</p>
<ul>
  <li><strong>Android</strong>: Disable entirely with <a href="/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/with-interaction-tracing"><code>withInteractionTracing()</code></a>, or disable only auto-instrumented traces with <a href="/docs/mobile-monitoring/new-relic-mobile-android/install-configure/android-agent-configuration-feature-flags#ff-withDefaultInteractions"><code>withDefaultInteractions()</code></a>.</li>
  <li><strong>iOS</strong>: Disable entirely with <a href="/docs/mobile-monitoring/new-relic-mobile-ios/api-guides/ios-agent-configuration-feature-flags#interactionTracing"><code>NRFeatureFlag_InteractionTracing()</code></a>, or disable only auto-instrumented traces with <a href="/docs/mobile-monitoring/new-relic-mobile-ios/api-guides/ios-agent-configuration-feature-flags#defaultInteractions"><code>NRFeatureFlag_DefaultInteractions()</code></a>.</li>
</ul>
<h2>Record custom events [#custom-events]</h2>
<p>Custom events are a powerful tool for reporting arbitrary user activity to New Relic. When associated with a crash, custom events show up in the <a href="/docs/mobile-monitoring/mobile-monitoring-ui/crashes/mobile-crash-event-trail">crash event trail</a>. You can also <a href="/docs/insights/nrql-new-relic-query-language/using-nrql/introduction-nrql">query them with NRQL</a> for flexible analysis. Unlike custom interactions, custom events allow you to add custom attributes to a particular event within the user session.</p>
<p>For example, you could record a custom event each time a user taps a button or accesses a certain feature, and then use NRQL to track how often that feature was used. Beyond a simple count, you can <a href="/docs/insights/nrql-new-relic-query-language/nrql-resources/nrql-syntax-components-functions#sel-facet"><code>FACET</code></a> on <a href="/docs/insights/insights-data-sources/default-data/mobile-default-event-attributes-insights">default mobile app attributes</a> such as location, device, or carrier to analyze usage. Adding session-level custom attributes would let you further examine usage based on the criteria important to you, such as user subscription level or other user characteristics. Adding additional attributes for that custom event would allow you to track user behavior more closely: What data did they enter or what option did they select, for example.</p>
<p>To add custom events, see:</p>
<ul>
  <li><strong>Android</strong>: Use <a href="/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/record-custom-event"><code>recordCustomEvent()</code></a>.</li>
  <li><strong>iOS</strong>: Use <a href="/docs/mobile-monitoring/new-relic-mobile-ios/ios-sdk-api/record-custom-event"><code>recordCustomEvent()</code></a>.</li>
</ul>
