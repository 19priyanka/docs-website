
<h2>Problem</h2>
<p>You start up a Java process running with the New Relic Java agent, but <a href="/docs/agents/java-agent/troubleshooting/no-data-appears-java">data fails to report</a> to the APM UI. You see an <code>Error bootstrapping New Relic agent</code> message in the stack trace in your application logs.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>The message <code>Error bootstrapping New Relic agent</code> can indicate multiple failure modes. The stack trace is also key in diagnosing this issue.</p>
</div>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoic3RhY2stdHJhY2UtZXhhbXBsZSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiRXhhbXBsZSBzdGFjayB0cmFjZSB3aGVuIGJvb3RzdHJhcHBpbmcgdGhlIEphdmEgYWdlbnQifV0=">
    <div data-prop-text="title">Example stack trace when bootstrapping the Java agent</div>
    <pre><code>Error bootstrapping New Relic agent: java.lang.RuntimeException: java.io.IOException: No such file or directory

java.lang.RuntimeException: java.io.IOException: No such file or directory

at com.newrelic.bootstrap.BootstrapLoader.load(BootstrapLoader.java:136)

at com.newrelic.bootstrap.BootstrapAgent.startAgent(BootstrapAgent.java:100)

at com.newrelic.bootstrap.BootstrapAgent.premain(BootstrapAgent.java:68)

at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)

at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

at java.lang.reflect.Method.invoke(Method.java:606)

at sun.instrument.InstrumentationImpl.loadClassAndStartAgent(InstrumentationImpl.java:382)

at sun.instrument.InstrumentationImpl.loadClassAndCallPremain(InstrumentationImpl.java:397)

Caused by: java.io.IOException: No such file or directory

at java.io.UnixFileSystem.createFileExclusively(Native Method)

at java.io.File.createNewFile(File.java:1006)

at java.io.File.createTempFile(File.java:1989)

at com.newrelic.bootstrap.EmbeddedJarFilesImpl$1.load(EmbeddedJarFilesImpl.java:36)

at com.newrelic.bootstrap.EmbeddedJarFilesImpl$1.load(EmbeddedJarFilesImpl.java:26)

at com.newrelic.agent.deps.com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3542)

at com.newrelic.agent.deps.com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2323)

at com.newrelic.agent.deps.com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2286)

at com.newrelic.agent.deps.com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2201)

at com.newrelic.agent.deps.com.google.common.cache.LocalCache.get(LocalCache.java:3953)

at com.newrelic.agent.deps.com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3957)

at com.newrelic.agent.deps.com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4875)

at com.newrelic.bootstrap.EmbeddedJarFilesImpl.getJarFileInAgent(EmbeddedJarFilesImpl.java:66)

at com.newrelic.bootstrap.BootstrapLoader.addBridgeJarToClassPath(BootstrapLoader.java:73)

at com.newrelic.bootstrap.BootstrapLoader.load(BootstrapLoader.java:129)

... 8 more

</code></pre>
  </div>
</div>
<h2>Solution</h2>
<p>If the Java agent cannot create the temporary <code>jar</code> files, it will fail to start up and will return the <code>Error bootstrapping New Relic agent</code> line preceding the stack trace to <code>System.err</code>. If you are using an app server, this usually appears in your app server's error logs.</p>
<p>Here are common reasons for this failure and the solution.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidGVtcC1ub3QtZGVmYXVsdCJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiVGVtcCBkaXJlY3RvcnkgaXMgZGlmZmVyZW50IGZyb20gamF2YS5pby50ZW1wZGlyIHN5c3RlbSBwcm9wZXJ0eSJ9XQ==">
    <div data-prop-text="title">Temp directory is different from java.io.tempdir system property</div>
    <p>This failure can occur when you specify a temporary directory location for the Java process that is not the default location specified by <code>java.io.tmpdir</code>. To solve this problem, pass in the system property <code>-Dnewrelic.tempdir=/path/to/tmpdir</code> to the JVM at startup.</p>
    <p>New Relic's Java agent will try to use the default temporary directory location for Java (<code>java.io.tempdir</code>) unless this system property is passed in. If you specified a different temporary directory location for the JVM to use, then the default directory location may not exist, or the Java agent may not have write access to it.</p>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidGVtcC1ub25leGlzdGVudCJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiVGVtcCBkaXJlY3RvcnkgZG9lcyBub3QgZXhpc3QgYXQgSlZNIHN0YXJ0dXAifV0=">
    <div data-prop-text="title">Temp directory does not exist at JVM startup</div>
    <p>This failure can occur if the temp directory does not exist when the JVM is starting up. The Java agent starts up very early in the JVM's lifecycle. The agent will not attempt to create the temporary directory if it does not already exist.</p>
    <p>For example, part of your process lifecycle might be to delete the java temp directory as your process is finishing. In this situation, make sure the java temp directory will be created again before the Java agent next starts up.</p>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidGVtcC1ub3Qtd3JpdGUifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IlVzZXIgY2Fubm90IHdyaXRlIHRvIGV4aXN0aW5nIHRlbXAgZGlyZWN0b3J5In1d">
    <div data-prop-text="title">User cannot write to existing temp directory</div>
    <p>This failure can occur if the temp directory exists but it cannot be written to by the user starting the java process. This prevents the Java agent from starting up successfully.</p>
    <p>To solve this problem, verify permissions for the user starting the Java process that is running the Java agent. Make sure the user has <strong>write</strong> and <strong>execute</strong> permissions for the temp directory location.</p>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoib3RoZXIifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6Ik90aGVyIHRyb3VibGVzaG9vdGluZyB0aXBzIn1d">
    <div data-prop-text="title">Other troubleshooting tips</div>
    <p>If none of these troubleshooting tips work, see the information about <a href="/docs/agents/java-agent/troubleshooting/providing-troubleshooting-information-java">providing Java information for troubleshooting</a>.</p>
  </div>
</div>
