
<p>You can use our Node.js agent to instrument Node.js applications deployed in Docker containers. This document will show you how to build, configure, and deploy a New Relic-instrumented version of your Dockerized Node.js application.</p>
<h2>Instrument your container [#instrument]</h2>
<p>With just a few additions your existing Dockerfile can be used with our Node.js agent. You'll configure the agent by running your new Docker image with environment variables set.</p>
<ol>
  <li>
    <p>Add <code>newrelic</code> to your <code>package.json</code>:</p>
    <pre><code>"newrelic": "latest",
</code></pre>
    <p>You can also install a specific version or use any of the other options provided by the <a href="https://docs.npmjs.com/files/package.json#dependencies"><code>package.json</code> format</a>. Check <a href="https://docs.newrelic.com/docs/release-notes/agent-release-notes/nodejs-release-notes">the Node.js agent release notes</a> for information about past agent versions.</p>
  </li>
  <li>
    <p>In the first line of your app's main module, add <code>require('newrelic');</code>.</p>
  </li>
  <li>
    <p>Add this line to your Dockerfile so the agent can run without a configuration file:</p>
    <pre><code>ENV NEW_RELIC_NO_CONFIG_FILE=true
</code></pre>
  </li>
  <li>
    <p>Build your Docker image the way you normally do.</p>
  </li>
  <li>
    <p>To run your Docker app with the agent enabled, add <a href="https://docs.newrelic.com/docs/accounts/install-new-relic/account-setup/license-key">your license key</a> and <a href="https://docs.newrelic.com/docs/agents/manage-apm-agents/app-naming/name-your-application">app name</a> to your <code>docker run</code> command as environment variables:</p>
    <pre><code>docker run -e NEW_RELIC_LICENSE_KEY=YOUR_LICENSE_KEY \
      -e NEW_RELIC_APP_NAME="Your Application Name" \
      your_image_name:latest
</code></pre>
  </li>
</ol>
<h2>Other configuration options [#configure]</h2>
<p>In addition to setting your application name or license key, you can set <a href="https://docs.newrelic.com/docs/agents/nodejs-agent/installation-configuration/nodejs-agent-configuration">other configuration options</a> by starting your container with the <code>-e</code> option. For example, to enable <a href="https://docs.newrelic.com/docs/understand-dependencies/distributed-tracing/get-started/introduction-distributed-tracing">Distributed Tracing</a>, use:</p>
<pre><code>$ docker run -e NEW_RELIC_LICENSE_KEY=YOUR_LICENSE_KEY \
        -e NEW_RELIC_APP_NAME="Your Application Name" \
        -e NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true \
        your_image_name:latest
</code></pre>
<p>You can also set configuration options in your Dockerfile using <code>ENV</code> directives:</p>
<pre><code>ENV NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true \
    NEW_RELIC_LOG=stdout
    # etc.
</code></pre>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>We <strong>strongly</strong> recommend not including your license key in your Dockerfile or Docker image. See <a href="https://docs.newrelic.com/docs/accounts/install-new-relic/account-setup/license-key#license-key-security">our documentation on license security</a> for more information.</p>
</div>
