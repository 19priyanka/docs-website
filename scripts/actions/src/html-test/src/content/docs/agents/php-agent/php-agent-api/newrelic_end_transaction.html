
<h2>Syntax</h2>
<pre><code>newrelic_end_transaction([bool $ignore])
</code></pre>
<p>Stop instrumenting the current transaction immediately.</p>
<h2>Requirements</h2>
<p>Agent version <a href="https://docs.newrelic.com/docs/release-notes/agent-release-notes/php-release-notes/php-agent">3.0.5.95</a> or higher.</p>
<h2>Description</h2>
<p>Stop instrumenting the current transaction immediately, and send the data to the daemon. This call simulates what the agent normally does when PHP terminates the current transaction. The most common use for this call is to improve instrumentation of command line scripts that handle job queue processing. Call this method at the end of a particular job, and then call <a href="/docs/agents/php-agent/php-agent-api/newrelic_start_transaction"><code>newrelic_start_transaction()</code></a> when a new task is pulled off the queue.</p>
<p>Normally, when you end a transaction you want the agent to record the associated data. However, you can also discard the data by setting <code>$ignore</code> to <code>true</code>.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>Compare <a href="/docs/agents/php-agent/php-agent-api/newrelic_end_of_transaction"><code>newrelic_end_of_transaction()</code></a>, which stops timing the transaction but continues to instrument it.</p>
</div>
<h2>Parameters</h2>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Parameter</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>$ignore</code></p>
        <p><em>boolean</em></p>
      </div>
      <div>
        <p>Optional. Defaults to <code>false</code>.</p>
        <p>If <code>false</code> or omitted, data from the transaction <strong>is</strong> recorded by the daemon.</p>
        <p>If <code>true</code>, data from the transaction <strong>is</strong> <strong>not</strong> recorded by the daemon.</p>
      </div>
    </div>
  </div>
</div>
<h2>Return values</h2>
<p>Returns <code>true</code> if the transaction was successfully ended and data was sent to the New Relic daemon.</p>
<h2>Examples</h2>
<h3>Stop a transaction, then start another [#stop-and-start]</h3>
<pre><code>function example() {
    ... // queuing logic
    if (extension_loaded('newrelic')) { // Ensure PHP agent is available
        newrelic_end_transaction(); // stop recording the current transaction
        newrelic_start_transaction(ini_get("newrelic.appname")); // start recording a new transaction
    }
    ... // more queuing logic
}
</code></pre>
<h3>Stop instrumenting entirely [#stop-entirely]</h3>
<pre><code>function example() {
    ... // this code is instrumented
    if (extension_loaded('newrelic')) { // Ensure PHP agent is available
        newrelic_end_transaction();
    }
    ... // this code is ignored
}
</code></pre>
