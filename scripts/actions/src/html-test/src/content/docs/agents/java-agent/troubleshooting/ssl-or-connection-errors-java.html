
<h2>Problem</h2>
<p>Your New Relic Java agent's <a href="/docs/agents/java-agent/troubleshooting/generate-debug-logs-troubleshooting-java">log data</a> shows SSL or connection errors.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>See <a href="/docs/agents/java-agent/configuration/configuring-your-ssl-certificates">Configuring your SSL certificates</a> for instructions on how to communicate with the New Relic collector over HTTPS.</p>
</div>
<h2>Solution</h2>
<p>Failures to connect via SSL typically appear early in the Java agent's log files. For example:</p>
<pre><code>PKIX path building failed: java.security.cert.CertPathBuilderException: PKIXCertPathBuilderImpl could not build a valid CertPath
</code></pre>
<pre><code>INFO: connection error: java.net.SocketException: java.lang.ClassNotFoundException: 
Cannot find the specified class com.ibm.websphere.ssl.protocol.SSLSocketFactory
</code></pre>
<p>If you see either of these errors, your JDK instance probably is using a customized trust store.</p>
<p><strong>Recommendation:</strong> Merge the Java default trust store with the application's trust store. The default trust store contains the DigiCert root Certificate Authority (CA) from which New Relic's certificate is derived.</p>
<p>To merge the trust store, use this command, or see <a href="https://docs.oracle.com/javase/6/docs/technotes/tools/solaris/keytool.html">Oracle's Java SE documentation for keytools</a>:</p>
<pre><code>keytool -import -alias ca_alias -file ca_file.pem -keystore truststore.ts -storepass the_password
</code></pre>
<p>Parameters include:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Parameter</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>ca_alias</code></p>
      </div>
      <div>
        <p>The tag of the particular DigiCert root CA.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>ca_file</code></p>
      </div>
      <div>
        <p>The Java default trust store file that contains the <code>ca_alias</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>truststore.ts</code></p>
      </div>
      <div>
        <p>Location where the <code>ca_alias</code> will be added.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>the_password</code></p>
      </div>
      <div>
        <p>Password change for the trust store <code>truststore.ts</code>.</p>
      </div>
    </div>
  </div>
</div>
