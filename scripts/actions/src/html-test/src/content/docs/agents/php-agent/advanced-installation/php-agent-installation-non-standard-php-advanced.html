
<p>If you are using a non-standard PHP installation, follow this procedure to properly install New Relic. This is common in instances where the default installer does not find your PHP installation (for example, if you have self-compiled PHP or a self-contained PHP stack).</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>As part of the installation process, change the default <a href="/docs/site/naming-your-application">application name</a> to a meaningful name.</p>
</div>
<h2>Requirements [#prep]</h2>
<p>Use the command line version of PHP (<code>php -i</code>) or look at the output of <code>phpinfo()</code> to determine:</p>
<ul>
  <li>The PHP extension version (<code>20090626</code>, <code>20100525</code>, <code>20121212</code>, <code>20131226</code>, <code>20151012</code>, or <code>20160303</code>)</li>
  <li>The extension or module installation directory</li>
  <li>Whether or not your version of PHP has been compiled with ZTS (Zend Thread Safety) support</li>
</ul>
<h2>Using the command line newrelic-install script (recommended) [#script]</h2>
<ol>
  <li>
    <p>Point New Relic at the right directory by using any of these options:</p>
    <div data-component="CollapserGroup" data-prop="W10=">
      <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiYWRkLXBocC10by1wYXRoIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOnsidHlwZSI6Im1keFZhbHVlRXhwcmVzc2lvbiIsInZhbHVlIjoiPD5BZGQgeW91ciBQSFAgbG9jYXRpb24gdG8geW91ciA8SW5saW5lQ29kZT5QQVRIPC9JbmxpbmVDb2RlPjwvPiIsInBvc2l0aW9uIjp7InN0YXJ0Ijp7ImxpbmUiOjM2LCJjb2x1bW4iOjExLCJvZmZzZXQiOjE0NDB9LCJlbmQiOnsibGluZSI6MzYsImNvbHVtbiI6NzcsIm9mZnNldCI6MTUwNn19fX1d">
        <div data-prop-text="title">[object Object]</div>
        <p>The install script needs to be able to find your command line <code>php</code> or <code>php-config</code>. You can add the directory that contains those programs to your current <code>PATH</code>.</p>
      </div>
      <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibnItaW5zdGFsbC1wYXRoIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOnsidHlwZSI6Im1keFZhbHVlRXhwcmVzc2lvbiIsInZhbHVlIjoiPD5TZXQgdGhlIDxJbmxpbmVDb2RlPk5SX0lOU1RBTExfUEFUSDwvSW5saW5lQ29kZT4gdmFyaWFibGUuPC8+IiwicG9zaXRpb24iOnsic3RhcnQiOnsibGluZSI6NDMsImNvbHVtbiI6MTEsIm9mZnNldCI6MTc2MX0sImVuZCI6eyJsaW5lIjo0MywiY29sdW1uIjo3Niwib2Zmc2V0IjoxODI2fX19fV0=">
        <div data-prop-text="title">[object Object]</div>
        <p>This can be a colon-separated list of directories in which to look for PHP installations in addition to those in your PATH. These directories should contain <code>php</code> or <code>php-config</code>. For example:</p>
        <pre><code>NR_INSTALL_PATH=/u/php/5.3/bin; export NR_INSTALL_PATH
newrelic-install

</code></pre>
      </div>
      <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibnItaW5zdGFsbC1waHBsaXN0In0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOnsidHlwZSI6Im1keFZhbHVlRXhwcmVzc2lvbiIsInZhbHVlIjoiPD5TZXQgdGhlIDxJbmxpbmVDb2RlPk5SX0lOU1RBTExfUEhQTElTVDwvSW5saW5lQ29kZT4gdmFyaWFibGU8Lz4iLCJwb3NpdGlvbiI6eyJzdGFydCI6eyJsaW5lIjo1NSwiY29sdW1uIjoxMSwib2Zmc2V0IjoyMjIyfSwiZW5kIjp7ImxpbmUiOjU1LCJjb2x1bW4iOjc4LCJvZmZzZXQiOjIyODl9fX19XQ==">
        <div data-prop-text="title">[object Object]</div>
        <p>Optional: Use a colon-separated list to set the exact locations (directories) in which to search. This option will ignore <code>PATH</code> and <code>NR_INSTALL_PATH</code>. For example:</p>
        <pre><code>NR_INSTALL_PHPLIST=/usr/local/bin:u/php/5.3/bin; export NR_INSTALL_PHPLIST
newrelic-install

</code></pre>
      </div>
    </div>
  </li>
  <li>
    <p>Invoke the <code>newrelic-install</code> script from its directory. Depending on your server and your paths, the install script may find other versions of PHP on your system. Select your specific version from the list.</p>
  </li>
</ol>
<p>For more information, see <a href="/docs/agents/php-agent/installation/newrelic-install-script">PHP install script</a>. Or, to resume your installation instructions, see <a href="/docs/agents/php-agent/getting-started/new-relic-php">New Relic for PHP</a>.</p>
<h2>Installing New Relic manually [#manual]</h2>
<p>If you do not want to use the install script, you can perform a fully manual installation. You will need to gather information about your PHP installation, as described above, and create and link or copy the files into place manually.</p>
<p>You can either review and obtain the appropriate values from your <code>phpinfo()</code> yourself, or you can load our <a href="https://docs.newrelic.com/sites/default/files/atoms/files/PHP-manual-install-script-master_0.zip">manual installation script</a> [ZIP] into your document root to automatically generate all the commands for your specific environment.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>The manual installation script is the simpler method, and it can be reused to upgrade the PHP agent. It will also confirm a successful installation upon reload.</p>
</div>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibWFudWFsLWluc3RhbGxhdGlvbi1zY3JpcHQifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IlVzaW5nIHRoZSBtYW51YWwgaW5zdGFsbGF0aW9uIHNjcmlwdCJ9XQ==">
    <div data-prop-text="title">Using the manual installation script</div>
    <ol>
      <li>Download the <a href="https://docs.newrelic.com/sites/default/files/atoms/files/PHP-manual-install-script-master_1.zip">manual installation script</a> [ZIP|5 KB].</li>
      <li>Extract the <code>nrmaninstall.php</code> file to your document root. This will make it visible in a browser.</li>
      <li>Run the script by accessing that file in your browser at <code>URL/nrmaninstall.php</code> (for example: <code>http://localhost/nrmaninstall.php</code>).</li>
      <li>Copy and paste the custom instructions for your environment into your command line shell.</li>
      <li>Reload the <code>nrmaninstall.php</code> page in your browser to check for a successful installation.</li>
    </ol>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibWFudWFsLWluc3RhbGxhdGlvbi1waHBpbmZvIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOnsidHlwZSI6Im1keFZhbHVlRXhwcmVzc2lvbiIsInZhbHVlIjoiPD5PYnRhaW5pbmcgaW5zdGFsbGF0aW9uIHBhcmFtZXRlcnMgZnJvbSA8SW5saW5lQ29kZT5waHBpbmZvKCk8L0lubGluZUNvZGU+PC8+IiwicG9zaXRpb24iOnsic3RhcnQiOnsibGluZSI6OTMsImNvbHVtbiI6MTEsIm9mZnNldCI6NDcxMX0sImVuZCI6eyJsaW5lIjo5MywiY29sdW1uIjo5MSwib2Zmc2V0Ijo0NzkxfX19fV0=">
    <div data-prop-text="title">[object Object]</div>
    <p>If this does not work you can obtain the correct information from your <code>phpinfo()</code> and pass the appropriate settings to your system as environment variables.</p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p><code>phpinfo()</code></p>
          </div>
          <div>
            <p>Notes</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p><code>PHPAPI</code></p>
          </div>
          <div>
            <p>This is labeled <code>PHP Extension</code> in the <code>phpinfo()</code> header.</p>
          </div>
        </div>
        <div>
          <div>
            <p><code>ARCH</code></p>
          </div>
          <div>
            <p>This can be determined by executing <code>file /path/to/php</code>.</p>
            <ul>
              <li>If you see a reference to <code>ELF-32</code>, then the <code>ARCH</code> is <code>x86</code>.</li>
              <li>If you see a reference to <code>ELF-64</code>, then the <code>ARCH</code> is <code>x64</code>.</li>
            </ul>
          </div>
        </div>
        <div>
          <div>
            <p><code>MODULEDIR</code></p>
          </div>
          <div>
            <p>This is labeled <code>extension_dir</code> in the PHP Core section.</p>
          </div>
        </div>
        <div>
          <div>
            <p><code>PHPZTS</code></p>
          </div>
          <div>
            <p>To determine whether ZTS is compiled in, look for the <code>Thread Safety</code> setting at the top of the <code>phpinfo()</code> output.</p>
            <ul>
              <li>If this is <strong>disabled</strong>, then <code>PHPZTS</code> is empty.</li>
              <li>If this is <strong>enabled</strong>, then <code>PHPZTS</code> is the string <code>-zts</code>, which includes a leading hyphen as noted.</li>
            </ul>
          </div>
        </div>
        <div>
          <div>
            <p><code>NRBASEDIR</code></p>
          </div>
          <div>
            <p>This is the base directory of the New Relic agent installation directory (<code>/usr/lib/newrelic-php5</code> or the directory in which you extracted the tar file for tarball installations).</p>
          </div>
        </div>
      </div>
    </div>
    <p>Use this information to execute the following commands to install the PHP module. Be sure to adjust the example's values to your actual settings.</p>
    <pre><code>NRBASEDIR=/usr/lib/newrelic-php5; export NRBASEDIR
    MODULEDIR=/usr/lib/php/modules; export MODULEDIR
    ARCH=x64; export ARCH
    PHPAPI=20090626; export PHPAPI
    PHPZTS="-zts"; export PHPZTS
    rm -f $MODULEDIR/newrelic.so
    ln -s $NRBASEDIR/agent/$ARCH/newrelic-${PHPAPI}${PHPZTS}.so \
      $MODULEDIR/newrelic.so

</code></pre>
    <pre><code>
  ps aux | grep newrelic-daemon
  
</code></pre>* For Debian based systems:
    <pre><code>
  ps -aef | grep newrelic-daemon
  
</code></pre>The next step is configuration.
    1. Copy the `$NRBASEDIR/scripts/newrelic.ini.template` to the directory from where your PHP installation reads additional config files and rename it `newrelic.ini`.
    To determine the destination, look at your `phpinfo()` output for the item, called **Scan this dir for additional .ini files**. If the directory listed is `(none)`, add settings from this file to your listed php config files (usually `php.ini`).
    2. Replace the license key setting in your `newrelic.ini` file with your license key. Also change any other sessions as needed (for example, `newrelic.appname`).
    3. Copy `$NRBASEDIR/daemon/newrelic-daemon.$architecture` to `/usr/bin/newrelic-daemon`.
    Depending on your system, $architecture will be either x86 or x64.
    4. Restart your dispatcher/webs erver.
    5. Verify that your site is functioning properly. If it is not, remove `newrelic.ini` or the `newrelic.so` you created, and restart your dispatcher/web server again to restore old operation.
    6. Examine your web server/dispatcher (**not** newrelic) logfiles to help determine the issue. If you still need assistance, get support at [support.newrelic.com](https://support.newrelic.com).
    Check that the agent is installed after the restart, by investigating the `phpinfo()` page for a `newrelic` section. If it appears the agent was successfully installed, check your system to verify that two `newrelic-daemon` processes are running:
    * For RedHat based systems:
  </div>
</div>
<p>Wait for 3 to 5 minutes for results to arrive in your <a href="/docs/applications-menu/applications-overview">APM <strong>Summary</strong> page</a>.</p>
