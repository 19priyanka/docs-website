
<p><a href="https://docs.newrelic.com/docs/apm/other-features/metrics/custom-instrumentation">Custom instrumentation</a> allows you to expand the agent's default monitoring and behavior to target additional functional calls and activity. You can do so via the agent config file, or via the agent API.</p>
<h2>Instrumentation via Config file or API [#options]</h2>
<p>There are two main methods for adding custom instrumentation:</p>
<ul>
  <li>If you simply want to trace time spent in additional functions or methods of classes, you can identify a list of functions or methods in the agent configuration file. For more information, see <a href="/docs/agents/python-agent/custom-instrumentation/python-custom-instrumentation-config-file">Instrumentation via config file</a>.</li>
  <li>For more complex cases, or if you want to customize how the function is identified in the New Relic One UI, you can place API calls in your application code. For more information, see <a href="/docs/agents/python-agent/custom-instrumentation/python-custom-instrumentation-api">Instrumentation via API</a>.</li>
</ul>
<p>In either case, these mechanisms only target the designated function call. It is not recursive, nor does it enable full profiling below the annotated function.</p>
<h2>Additional considerations [#notes]</h2>
<p>You must individually annotate each function call you want to trace. If you are not sure which function you should annotate, you can use <a href="/docs/applications-menu/thread-profiler">thread profiling</a> features to narrow it down.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJjYXV0aW9uIn1d">
  <p>Collecting too many metrics can impact the performance of both your application and the agent. To avoid potential data problems, try to keep the total number of unique metrics introduced by custom instrumentation under 2000.</p>
</div>
