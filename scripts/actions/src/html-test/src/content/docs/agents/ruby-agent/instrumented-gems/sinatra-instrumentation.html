
<p>New Relic's Ruby agent works with <a href="http://www.sinatrarb.com/">Sinatra</a> 1.2.x or higher. In the New Relic UI, the Sinatra actions appear similar to controller actions. The actions in the UI correspond to the pattern expression used to match them. HTTP operations are not distinguished. Multiple matches are all tracked as separate actions.</p>
<h2>Contents [#qiklinks]</h2>
<h2>Getting started</h2>
<p>To set up Sinatra:</p>
<ol>
  <li>
    <p>Install the latest <code>newrelic_rpm</code> gem.</p>
  </li>
  <li>
    <p>In your Sinatra app, immediately below the Sinatra <strong>require</strong> directive, add:</p>
    <pre><code>require 'newrelic_rpm'
</code></pre>
  </li>
  <li>
    <p>Set <code>RACK_ENV</code> to the environment corresponding to the configuration definitions in your <strong>newrelic.yml</strong> file; for example, development, staging, production, etc.</p>
  </li>
</ol>
<p><strong>Note:</strong> Developer mode only works with Rails.</p>
<h2>Middleware installation</h2>
<p>Ruby agent versions prior to 3.6.3 required manual addition of New Relic middlewares to enable certain features, such as cross application tracing and browser monitoring. For more information about required middlewares, see <a href="/docs/ruby/rack-middlewares">Rack middlewares</a>, or upgrade to the most recent Ruby agent.</p>
<h2>Ignoring routes</h2>
<p>Ruby agent versions 3.6.3 or higher support ignoring certain routes, similar to what was previously available in Rails controller instrumentation. To specify these values, use the same style of routes that you use to define your Sinatra application. For example, to ignore a <code>ping</code> route in a Sinatra app, include the following code in the app:</p>
<pre><code>newrelic_ignore '/ping'

    get '/ping' do
      # ...
    end
</code></pre>
<p>If you want an entire application to be ignored (for example, in a mounted application), call <code>newrelic_ignore</code> without parameters:</p>
<pre><code>newrelic_ignore
</code></pre>
<p>Additionally, <code>newrelic_ignore_apdex</code> and <code>newrelic_ignore_enduser</code> are supported.</p>
<ul>
  <li>The <code>newrelic_ignore_apdex</code> call will exclude a given route from consideration in overall Apdex calculations.</li>
  <li>The <code>newrelic_ignore_enduser</code> call will prevent automatic injection of the page load timing JavaScript when a route is rendered.</li>
</ul>
<h2>Padrino</h2>
<p><a href="http://www.padrinorb.com/" title="Link opens in a new window">Padrino</a> is a framework built on top of Sinatra. Starting with Ruby agent version 3.6.3, New Relic's Sinatra instrumentation works with Padrino versions 0.10.x or higher.</p>
<h2>Shotgun (not supported) [#shotgun]</h2>
<p>The New Relic Ruby agent will not work with <a href="http://rubygems.org/gems/shotgun" title="Link opens in a new window">shotgun</a>. It cannot make a connection before the dispatcher process exits. Neither Developer mode nor Monitor mode will work.</p>
<h2>For more help [#more_help]</h2>
<p>Additional documentation resources include <a href="/docs/agents/ruby-agent/features/page-load-timing-ruby">Browser monitoring and the Ruby agent</a>.</p>
