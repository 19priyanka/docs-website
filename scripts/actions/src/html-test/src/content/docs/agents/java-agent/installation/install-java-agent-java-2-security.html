
<p>If you are a WebLogic or WebSphere user and use the Java 2 security model, the New Relic Java agent requires additional configuration. Complete these steps after following the usual procedures to <a href="/docs/agents/java-agent/installation/java-agent-manual-installation">download and install the Java agent</a>.</p>
<h2>WebLogic: Java 2 Security [#weblogic-java-2]</h2>
<p>If you are using Java 2 security, add the following entry to <code>weblogic.policy</code> to complete installation:</p>
<pre><code>grant codeBase "file:/full/path/to/newrelic/-" {
    permission java.security.AllPermission;
  };
</code></pre>
<p>Specify the directory containing <code>newrelic.jar</code> in <code>/full/path/to/newrelic</code>. The default policy file location is <code>weblogic_root/server/lib/weblogic.policy</code>.</p>
<h2>WebSphere: Java 2 Security or Administrative Security [#websphere-java-2]</h2>
<p>If you are using Java 2 Security or WebSphere Admin Security, you must grant all jars inside the New Relic install folder the proper permissions. You can enable New Relic for all app servers by editing your <code>java.policy</code> file. Or, you can enable New Relic for each app server individually by editing that server's <code>server.policy</code> file:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiYWxsLWFwcC1zZXJ2ZXJzIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJFbmFibGUgTmV3IFJlbGljIGZvciBhbGwgYXBwIHNlcnZlcnMifV0=">
    <div data-prop-text="title">Enable New Relic for all app servers</div>
    <p>To enable New Relic for all app servers, edit <code>java.policy</code>:</p>
    <ol>
      <li>
        <p>Open your <code>java.policy</code> file, located inside your WebSphere install directory at:</p>
        <pre><code>YOUR_WEBSPHERE_INSTALL_DIRECTORY/java/jre/lib/security/java.policy
</code></pre>
      </li>
      <li>
        <p>Append the following text to your policy file, customizing the <code>file:</code> path to point to the folder containing <code>newrelic.jar</code>. Ensure you preserve the dash <code>-</code> at the end of the path, which grants all jars in the target folder the necessary permissions.</p>
        <pre><code>grant codeBase "file:/PATH/TO/NEWRELIC/FOLDER/-" {
       permission java.security.AllPermission;
       permission java.net.NetPermission "specifyStreamHandler";
       permission java.net.SocketPermission "*.newrelic.com", "connect,accept,resolve";
};
</code></pre>
        <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
          <p>The <code>codeBase</code> value must use slashes, not backslashes, as the directory separator, even on Windows systems.</p>
        </div>
      </li>
      <li>
        <p>Restart your application server.</p>
      </li>
    </ol>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiaW5kaXZpZHVhbC1hcHAtc2VydmVyIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJFbmFibGUgTmV3IFJlbGljIGZvciBpbmRpdmlkdWFsIGFwcCBzZXJ2ZXJzIn1d">
    <div data-prop-text="title">Enable New Relic for individual app servers</div>
    <p>To enable New Relic for a single app server, edit that server's <code>server.policy</code>:</p>
    <ol>
      <li>
        <p>Open your <code>server.policy</code> file, located inside your WebSphere install directory at:</p>
        <pre><code>YOUR_WEBSPHERE_INSTALL_DIRECTORY/profiles/YOUR_APP_SERVER_NAME/properties/server.policy
</code></pre>
      </li>
      <li>
        <p>Append the following text to your policy file, customizing the <code>file:</code> path to point to the folder containing <code>newrelic.jar</code>. Ensure you preserve the dash <code>-</code> at the end of the path, which grants all jars in the target folder the necessary permissions.</p>
        <pre><code>grant codeBase "file:/PATH/TO/NEWRELIC/FOLDER/-" {
       permission java.security.AllPermission;
       permission java.net.NetPermission "specifyStreamHandler";
       permission java.net.SocketPermission "*.newrelic.com", "connect,accept,resolve";
};
</code></pre>
        <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
          <p>The <code>codeBase</code> value must use slashes, not backslashes, as the directory separator, even on Windows systems.</p>
        </div>
      </li>
      <li>
        <p>Restart your application server.</p>
      </li>
    </ol>
  </div>
</div>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>For each app, Java security permissions are determined by the union of <code>java.policy</code> and <code>server.policy</code>. Do not put the same permission settings in multiple files.</p>
</div>
<p>For more on policy file syntax, see <a href="http://docs.oracle.com/javase/8/docs/technotes/guides/security/PolicyFiles.html">Default Policy Implementation and Policy File Syntax</a>.</p>
