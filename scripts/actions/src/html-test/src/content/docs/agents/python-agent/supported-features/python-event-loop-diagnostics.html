
<p>The <a href="/docs/agents/python-agent/getting-started/introduction-new-relic-python">Python agent</a> supports <a href="https://docs.python.org/3/library/asyncio.html">asyncio</a> event loop diagnostics. When there are transactions blocking or delaying an event loop, the agent is able to generate diagnostics to help find and resolve them.</p>
<h2>Requirements</h2>
<p>Requires <a href="/docs/release-notes/agent-release-notes/python-release-notes">Python agent version 5.0.0.124 or higher</a>.</p>
<h2>View in New Relic UI</h2>
<p>In APM, your event loop transaction data will be in the transaction breakdown table and the trace details page.</p>
<p>Event loop metrics will appear in the transaction <strong>Breakdown table</strong>:</p>
<p>
  <img src="./images/python-event-loop-breakdown-table.png" alt="Python event loop breakdown table" title="python-event-loop-breakdown-table.png">
</p>
<p><strong><a href="https://one.newrelic.com/">one.newrelic.com</a> > APM > (select an app) > Monitoring > Transactions > (select a transaction):</strong> The transaction’s <strong>Breakdown table</strong> flags event loops with asyncio.</p>
<p>Time spent waiting on other transactions will be shown in the transaction <strong>Trace details</strong> page:</p>
<p>
  <img src="./images/python-event-loop-trace-details.png" alt="Python event loop trace details" title="python-event-loop-trace-details.png">
</p>
<p><strong><a href="https://one.newrelic.com/">one.newrelic.com</a> > APM > (select an app) > Transactions > (select a transaction trace) > Trace details:</strong> The <strong>Trace details</strong> page contains a table with breakdowns for each segment (method or function call) in a transaction trace.</p>
<h2>Event Loop NRQL Queries</h2>
<p><code>eventLoopTime</code> and <code>eventLoopWait</code> attributes will be available via NRQL query. An example query might be:</p>
<p><code>SELECT count(*) as 'count', average(eventLoopTime) as 'loopTime', average(eventLoopWait) as 'loopWait' FROM Transaction facet name</code></p>
<p>In New Relic One, you might see results like this:</p>
<p>
  <img src="./images/python-event-loop-insights-table.png" alt="Python event loop NRQL query" title="python-event-loop-insights-table.png">
</p>
<p><strong><a href="https://one.newrelic.com">one.newrelic.com</a> > Query your data > Advanced (NRQL)</strong>: Use advanced (NRQL) to write a query to find event loops.</p>
<h2>Where to diagnose event loops</h2>
<p>Event loop diagnostics will be available by default through our existing aiohttp, sanic, and Tornado instrumentation frameworks. Coroutines using the Python agent API <a href="/docs/agents/python-agent/python-agent-api/background_task">background_task</a> and <a href="/docs/agents/python-agent/python-agent-api/webtransaction">web_transaction</a> decorator APIs also support asyncio's event loops.</p>
