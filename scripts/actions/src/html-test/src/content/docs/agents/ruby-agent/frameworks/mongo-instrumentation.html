
<p>The Ruby agent has built-in instrumentation for MongoDB queries made via the <a href="https://rubygems.org/gems/mongo" title="Link opens in a new window"><code>mongo</code></a> gem.</p>
<h2>Contents [#qiklinks]</h2>
<h2>Supported gems [#supported_gems]</h2>
<p>This summarizes the Ruby agent's support for gems by version.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p><strong>Gem version</strong></p>
      </div>
      <div>
        <p><strong>Comments</strong></p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>mongo</code> 1.8 and 1.9</p>
      </div>
      <div>
        <p>Supported by New Relic's Ruby agent 3.7.1 or higher</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mongo</code> 2.0</p>
      </div>
      <div>
        <p>Not supported</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mongo</code> 2.1 or higher</p>
      </div>
      <div>
        <p>Requires New Relic's Ruby agent 3.13.1 or higher</p>
      </div>
    </div>
    <div>
      <div>
        <p>Other gems</p>
      </div>
      <div>
        <p>Support for Mongoid 2/3/4 and Moped currently is available only via third-party gems. For links to the relevant projects, see the <a href="https://github.com/newrelic/rpm_contrib#new-relic-ruby-agent-plugins-seperate-projects" title="Link opens in a new window">plugin list</a> on <code>rpm_contrib</code>.</p>
      </div>
    </div>
  </div>
</div>
<h2>Third-party and rpm_contrib instrumentation [#third_party_instrumentation]</h2>
<p>The <code>rpm_contrib</code> and <code>newrelic_mongo</code> gems both provided basic instrumentation for <code>mongo</code>. New Relic does not recommend running Mongo instrumentation via these gems alongside the Ruby agent's built-in Mongo support. This might double-count metrics such as overall database time.</p>
<p>Also, the <code>rpm_contrib</code> and <code>newrelic_mongo</code> gems both use a distinct setting that can be used to disable them if removing those gems entirely isn't possible in your environment. For those third party gems, set <code>disable_mongodb: false</code> in your <strong>newrelic.yml</strong>.</p>
<h2>Disabling instrumentation [#Disabling_instrumentation]</h2>
<p>To disable Mongo instrumentation in the agent, add the following to your <strong>newrelic.yml</strong>:</p>
<pre><code>disable_mongo: true
</code></pre>
<h2>For more help [#more_help]</h2>
<p>Additional documentation resources include:</p>
<ul>
  <li><a href="/docs/agents/ruby-agent/getting-started/new-relic-ruby">New Relic for Ruby</a> (compatibility and requirements, general information about installation, configuration, troubleshooting, and known issues)</li>
  <li><a href="/docs/agents/ruby-agent/installation-configuration/ruby-agent-installation">Ruby agent installation</a> (using the New Relic Ruby gem and configuration file)</li>
</ul>
