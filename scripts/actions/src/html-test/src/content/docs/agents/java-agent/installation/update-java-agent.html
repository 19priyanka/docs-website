
<p>To take full advantage of New Relic's latest features, enhancements, and important security patches, we recommend you update your Java agent to the latest version. For additional information about specific agent updates, refer to the <a href="/docs/release-notes/agent-release-notes/java-release-notes">Java agent release notes</a>.</p>
<p>These update procedures describe how to replace some of the current contents of your <a href="/docs/agents/manage-apm-agents/troubleshooting/find-agent-root-directory#java-agent">agent root directory</a>, which contains the New Relic Java agent (<code>newrelic.jar</code>), with newly downloaded contents from the New Relic UI.</p>
<h2>Update to latest version [#procedures]</h2>
<p>To identify which version of the Java agent you're currently using, run <code>java -jar newrelic.jar -v</code>. Your Java agent version will be printed to your console.</p>
<p>Then, to update to the latest Java agent version:</p>
<ol>
  <li>Back up the <strong>entire</strong> <a href="/docs/agents/manage-apm-agents/troubleshooting/find-agent-root-directory#java-agent">Java agent root directory</a> to another location. Rename that directory to <code>NewRelic_Agent#.#.#</code>, where <code>#.#.#</code> is the agent version number.</li>
  <li>Go to <strong><a href="https://one.newrelic.com">one.newrelic.com</a> > (account dropdown) > Account settings</strong>.</li>
  <li>Download the agent for your platform.</li>
  <li>Unzip the new agent download file, then copy <code>newrelic-api.jar</code> and <code>newrelic.jar</code> into the original <a href="/docs/agents/manage-apm-agents/troubleshooting/find-agent-root-directory#java-agent">Java agent root directory</a>.</li>
  <li><code>Diff</code> your current <code>newrelic.yml</code> with the newly downloaded <code>newrelic.yml</code> from the zip, and <a href="#diff">update customized differences</a> as needed.</li>
  <li>Restart your Java dispatcher.</li>
</ol>
<p>If you experience issues after the Java agent update, restore from the backed-up New Relic agent directory.</p>
<h2>Update agent config differences [#diff]</h2>
<p>If differences between the two versions are unrelated to your app's customizations, align the <code>newrelic.yml</code> you use moving forward with the latest updates to the default <code>newrelic.yml</code> from New Relic.</p>
<p>For example, if you <code>diff</code> the default <code>newrelic.yml</code> files for Java agent versions 3.29.0 and 3.30.0, the results printed to the console will be:</p>
<pre><code>âžœ diff newrelic_3.29.0.yml newrelic_3.30.0.yml
254a255,265
> # Classes loaded by classloaders in this list will not be instrumented.
> # This is a useful optimization for runtimes which use classloaders to
> # load dynamic classes which the agent would not instrument.
> classloader_excludes:
> groovy.lang.GroovyClassLoader$InnerLoader,
> org.codehaus.groovy.runtime.callsite.CallSiteClassLoader,
> com.collaxa.cube.engine.deployment.BPELClassLoader,
> org.springframework.data.convert.ClassGeneratingEntityInstantiator$ObjectInstantiatorClassGenerator,
> org.mvel2.optimizers.impl.asm.ASMAccessorOptimizer$ContextClassLoader,
> gw.internal.gosu.compiler.SingleServingGosuClassLoader,
>
</code></pre>
<p>These lines were added to the default <code>newrelic.yml</code> in Java agent version 3.30.0. If you want to run Java agent version 3.30.0 or higher, ensure you include these lines in your <code>newrelic.yml</code>.</p>
<h2>Java agent versions not supported [#eol-versions]</h2>
<p><strong>End of life notification:</strong> As of January 26, 2015, New Relic will no longer accept data from Java agent versions earlier than <strong>3.6.0</strong>, except version <a href="#legacy-2-21-7">2.21.7</a>.</p>
<p>These agent versions use an out-of-date protocol when communicating with New Relic's data collection services. In addition, many of these versions contain a potential security issue where they may incorrectly send sensitive data to the New Relic collector.</p>
<h2>Update unsupported agent versions [#eol-update]</h2>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>If you are updating from an older agent version, including major version jumps, review the following list for changes in functionality.</p>
</div>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Migration</p>
      </div>
      <div>
        <p>Comments</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>5.0.0</p>
      </div>
      <div>
        <p>Release notes: <a href="/docs/release-notes/agent-release-notes/java-release-notes/java-agent-500">Java agent 5.0.0</a></p>
        <p><strong>Self installer:</strong></p>
        <p>The New Relic Java agent's self-installer has been removed in order to provide a more consistent user experience. To install the Java agent, add the full path to the <code>newrelic.jar</code> to the <code>-javaagent</code> flag in your JVM options. For more information, see the documentation on installing the agent on specific application servers, including Docker, Maven, or Gradle.</p>
        <p><strong>Deprecated instrumentation:</strong></p>
        <p>The following instrumentation modules have been moved out of the default Java agent. They are now provided as a <a href="/docs/agents/java-agent/instrumentation/additional-instrumentation-modules-java-agent">separate download</a>. To continue using these modules, just add them to the agent's extensions directory in your New Relic folder or wherever your extensions directory is configured. Deprecated modules include:</p>
        <ul>
          <li>Akka 2.0</li>
          <li>Akka 2.1</li>
          <li>Akka-http 1.0</li>
          <li>Akka-http 2.0 - 2.4.1</li>
          <li>Akka-http 2.4.2 - 2.4.4</li>
          <li>Hystrix 1.2</li>
          <li>Hystrix 1.3</li>
          <li>Play 1: Instrumentation for Play-1.x is not available as an extension.</li>
          <li>Play 2.0</li>
          <li>Play 2.1</li>
          <li>Play 2.2</li>
          <li>Solr 3.1 - 3.4</li>
          <li>Solr 3.5</li>
          <li>Solr 3.6</li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p>4.12.0</p>
      </div>
      <div>
        <p>Release notes: <a href="/docs/release-notes/agent-release-notes/java-release-notes/java-agent-4120">Java agent 4.12.0</a></p>
        <p><strong>Deprecated APIs:</strong></p>
        <p>The custom transport channel API is now deprecated in favor of the distributed tracing API.</p>
        <p>The <code>skipTransactionTrace</code> attribute on the <code>@Trace</code> annotation is now deprecated. Instead, use the <code>excludeFromTransactionTrace</code> attribute.</p>
        <p><strong>Deprecated instrumentation:</strong></p>
        <p>JetS3t: Removed built-in instrumentation for JetS3t. The agent will continue to report external calls made with the JetS3t client.</p>
      </div>
    </div>
    <div>
      <div>
        <p>4.4.0</p>
      </div>
      <div>
        <p>Release notes: <a href="/docs/release-notes/agent-release-notes/java-release-notes/java-agent-440">Java agent 4.4.0</a></p>
        <p><strong>Java 6 support removed:</strong></p>
        <p>You must use 4.3 or earlier.</p>
        <p><strong>EU data center:</strong></p>
        <p>Minimum version required for use in EU datacenter.</p>
        <p><strong>Removed the SSL configuration option:</strong></p>
        <p>SSL is now always used in communication with New Relic servers. The <code>newrelic.yml</code> ssl configuration and <code>-Dnewrelic.config.ssl</code> system property are no longer used. Setting either value to anything other than <code>true</code> will result in logging a warning.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Legacy agent 2.21.7</p>
      </div>
      <div>
        <p>Release notes: <a href="/docs/release-notes/agent-release-notes/java-release-notes/java-agent-2217">Java agent 2.21.7</a></p>
        <p><strong>Java SE 5.0:</strong></p>
        <p>This is a bugfix release for the <a href="/docs/java/java-se-5">legacy Java SE 5.0 version</a> of the agent. Unless you are a Java SE5 user, use the latest version of the New Relic Java agent. This affects:</p>
        <ul>
          <li>Oracle Hotspot JVM version 5.0 for Linux, Solaris, Windows, OS X</li>
          <li>Oracle JRockit up to and including 1.6.0_50</li>
        </ul>
      </div>
    </div>
  </div>
</div>
