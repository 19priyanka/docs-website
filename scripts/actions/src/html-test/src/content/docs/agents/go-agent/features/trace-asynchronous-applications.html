
<p>The ability to trace asynchronous segments with the <code>NewGoroutine</code> API is available as of <a href="/docs/release-notes/agent-release-notes/go-release-notes">Go agent version 2.6.0</a>. If you do not have version 2.6.0 or higher, update your Go agent to the latest version.</p>
<h2>NewGoroutine [#enable]</h2>
<p>The <code>Transaction.NewGoroutine() Transaction</code> method allows transactions to create segments in multiple goroutines.</p>
<p><code>NewGoroutine</code> returns a new reference to the <code>Transaction</code>. This must be called any time you are passing the <code>Transaction</code> to another goroutine which makes segments. Each segment-creating goroutine must have its own <code>Transaction</code> reference. It does not matter if you call this before or after the other goroutine has started.</p>
<p>All <code>Transaction</code> methods can be used in any <code>Transaction</code> reference. The <code>Transaction</code> will end when <code>End()</code> is called in any goroutine.</p>
<p>Example passing a new <code>Transaction</code> reference directly to another goroutine:</p>
<pre><code>go func(txn *newrelic.Transaction) {
    defer txn.StartSegment("async").End()
    time.Sleep(100 * time.Millisecond)
}(txn.NewGoroutine())
</code></pre>
<p>Example passing a new <code>Transaction</code> reference on a channel to another goroutine:</p>
<pre><code>ch := make(chan *newrelic.Transaction)
go func() {
    txn := &#x3C;-ch
    defer txn.StartSegment("async").End()
    time.Sleep(100 * time.Millisecond)
}()
ch &#x3C;- txn.NewGoroutine()
</code></pre>
