
<h2>Problem</h2>
<p>If you do not see data with Unicorn, follow these procedures based on your New Relic Ruby agent version.</p>
<h2>Solution</h2>
<p>If you are using Ruby agent version 3.8.0 or higher, you should not need to do any additional configuration. If you're using a <a href="/docs/ruby/supported-frameworks">supported web framework</a>, the agent should work out of the box regardless of your Unicorn configuration.</p>
<p>If you are using a Ruby agent version <strong>prior to 3.8.0</strong> with Unicorn, you will need to do one of the following in order to get data reporting:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidXBncmFkZSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiVXBncmFkZSB0byBuZXdyZWxpY19ycG0gMy44LjAgb3IgaGlnaGVyIn1d">
    <div data-prop-text="title">Upgrade to newrelic_rpm 3.8.0 or higher</div>
    <p>As noted above, versions 3.8.0 or higher of the newrelic_rpm gem should automatically work correctly regardless of your unicorn configuration.</p>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidXBsb2FkIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOnsidHlwZSI6Im1keFZhbHVlRXhwcmVzc2lvbiIsInZhbHVlIjoiPD5VcGxvYWQgPElubGluZUNvZGU+cHJlbG9hZF9hcHAgdHJ1ZTwvSW5saW5lQ29kZT48Lz4iLCJwb3NpdGlvbiI6eyJzdGFydCI6eyJsaW5lIjozNiwiY29sdW1uIjoxMSwib2Zmc2V0IjoxMTYxfSwiZW5kIjp7ImxpbmUiOjM2LCJjb2x1bW4iOjY2LCJvZmZzZXQiOjEyMTZ9fX19XQ==">
    <div data-prop-text="title">[object Object]</div>
    <p>Use the <code>preload_app true</code> directive in your Unicorn configuration file. For more information, refer to the Unicorn <a href="http://unicorn.bogomips.org/Unicorn/Configurator.html#method-i-preload_app">documentation for this configuration setting</a>. You must ensure that Unicorn sees your configuration file by specifying the <code>-c &#x3C;path></code> option to your <code>unicorn</code> invocation (Heroku users: This will be in your <code>Procfile</code>).</p>
    <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
      <p>The directive is `preload_app true`, not `preload_app = true`. The form with the equals sign will fail silently.</p>
    </div>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibWFudWFsLXN0YXJ0In0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJNYW51YWxseSBzdGFydCB0aGUgYWdlbnQifV0=">
    <div data-prop-text="title">Manually start the agent</div>
    <p>If you do not want to use <code>preload_app true</code>, you can manually call the New Relic Ruby agent's handler for forking web servers from an initializer file in <code>config/initializers`</code>:</p>
    <pre><code># Ensure the agent is started using Unicorn.
# This is needed when using Unicorn and preload_app is not set to true.
# See https://docs.newrelic.com/docs/ruby/no-data-with-unicorn 
if defined?(Unicorn) &#x26;&#x26; File.basename($0).start_with?('unicorn') 
   ::NewRelic::Agent.manual_start() 
   ::NewRelic::Agent.after_fork(:force_reconnect => true) 
end

</code></pre>In order for your changes to take effect, do a "clean" restart (full stop and start). Doing a normal Unicorn restart with `SIGUSR2` may not properly initialize the gem.
  </div>
</div>
