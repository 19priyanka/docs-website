
<h2>Problem</h2>
<p>Your agent stops reporting data when using New Relic's PHP agent. The operating system either includes SELinux by default or has been added to the environment for security purposes.</p>
<h2>Solution</h2>
<p>To resolve this issue, use any of these options:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY29uZmlnLXNlbGludXgtYWxsb3cifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkNvbmZpZ3VyZSBTRUxpbnV4IHRvIGFsbG93IE5ldyBSZWxpYyB0byBjb21tdW5pY2F0ZSJ9XQ==">
    <div data-prop-text="title">Configure SELinux to allow New Relic to communicate</div>
    <p>With SELinux, you can follow your own security policies to configure a custom policy to allow for communication. This process is outside the scope of New Relic Support, and we cannot make specific recommendations regarding your security configuration. However, the following links provide helpful starting points for learning about SELinux policy creation and modification:</p>
    <ul>
      <li><a href="https://wiki.centos.org/HowTos/SELinux">CentOS SELinux documentation</a></li>
      <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/5/html/deployment_guide/sec-sel-policy-customizing">RHEL SELinux documentation</a></li>
    </ul>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZGlzYWJsZS1zZWxpbnV4LXBlcm1pc3NpdmUifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IlNldCBTRUxpbnV4IHRvIHBlcm1pc3NpdmUgbW9kZSJ9XQ==">
    <div data-prop-text="title">Set SELinux to permissive mode</div>
    <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
      <p>This may be used as a temporary measure to verify that SELinux is responsible for data not being reported.</p>
    </div>
    <p>Setting SELinux to permissive mode allows your services to operate without restrictions. The default setting is restored if you restart the server.</p>
    <p>To set to permissive mode, use the command:</p>
    <pre><code>setenforce Permissive

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZGlzYWJsZS1zZWxpbnV4In0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJEaXNhYmxlIFNFTGludXgifV0=">
    <div data-prop-text="title">Disable SELinux</div>
    <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
      <p>New Relic does not actively encourage you to disable security software. However, for best results, configure SELinux to allow New Relic to function fully.</p>
    </div>
    <p>If you decide that disabling SELinux is the right decision for your server, use the following steps to permanently disable SELinux:</p>
    <ol>
      <li>
        <p>Edit the SELinux <code>sysconfig</code> file using this command:</p>
        <pre><code>vi /etc/sysconfig/selinux
</code></pre>
      </li>
      <li>
        <p>Find the <code>SELINUX=</code> setting and change it to:</p>
        <pre><code>SELINUX=disabled
</code></pre>
      </li>
      <li>
        <p>Restart your server in order for the setting to take effect.</p>
      </li>
    </ol>
  </div>
</div>
<h2>Cause</h2>
<p>The agent's PHP extension and daemon communicate by default through <code>/tmp/.newrelic.sock</code> (Unix socket). If SELinux is not configured to allow the PHP extension and daemon to communicate, this will prevent these two agent components from communicating with each other when SELinux is set to <code>enforcing</code> mode.</p>
<p>In some cases, SELinux can prevent the daemon from starting altogether. <a href="https://docs.newrelic.com/docs/agents/php-agent/troubleshooting/verifying-php-daemon">Verifying the PHP daemon</a> may be a necessary troubleshooting step when diagnosing SELinux issues.</p>
<p>SELinux is a security software designed to limit the communication of processes on your environment. SELinux is a powerful tool in server security. As such, you should implement and configure it to suit your own server environment.</p>
<p>New Relic does not influence decisions on how to configure your server security or processes you allow to run. We are not responsible for security decisions for your software. You should review your configuration settings to make sure they comply with your own security policies before implementing.</p>
