
<h2>Problem</h2>
<p>You see errors in your daemon log file after upgrading your agent like this:<code>protocol mismatch: A.B != X.Y</code>.</p>
<h2>Solution</h2>
<ol>
  <li>
    <p>Ensure your agent and daemon are both up to date on the same version number.</p>
  </li>
  <li>
    <p>Restart your web server (Apache, Nginx, PHP-FPM, etc.).</p>
  </li>
  <li>
    <p>If the number <code>A.B</code> is less than the number <code>X.Y</code>, it means that you have an out of date agent trying to communicate with a more modern daemon.</p>
    <p>If the number <code>A.B</code> is higher than the number <code>X.Y</code>, then it means that your daemon is out of date, and the most likely cause is that you have too many daemons running. In this case, kill all of the currently running <code>newrelic-daemon</code> processes, and restart the daemon using <code>/etc/init.d/newrelic-daemon start</code>.</p>
  </li>
</ol>
<h2>Cause</h2>
<p>The only reason for this error is that your agent and daemon are out of sync with each other. The daemon and the actual agent (the PHP extension) are a very tightly coupled pair, and the daemon will only accept connections and commands from an agent that matches it.</p>
<p>Sometimes the upgrade process will fail to kill the old daemon correctly and you may still have old daemon processes running. Frequently, this error is caused by not restarting your web server after an upgrade. If the daemon was upgraded correctly, but your web server still contains older agents, you will see this error. The error itself points to which one is out of date.</p>
