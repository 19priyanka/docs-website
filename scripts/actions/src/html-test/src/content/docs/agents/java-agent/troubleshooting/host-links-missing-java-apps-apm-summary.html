
<h2>Problem</h2>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJjYXV0aW9uIn1d">
  <p>Changing your hostname settings, particularly the FQDN settings, may disable your server's network access. Test any changes thoroughly before deploying them to a production environment.</p>
</div>
<p>You cannot view links to your Linux hosts from your Java app's <a href="/docs/apm/applications-menu/monitoring/applications-overview-dashboard">APM <strong>Summary</strong> page</a>.</p>
<h2>Solution</h2>
<p>Configure the hostname settings so that your Linux agent in Infrastructure will return the exact same name string as the New Relic Java agent. <strong>Recommendation:</strong> Edit the fully qualified domain name (FQDN) settings. The agents read their hostname from the operating system's FQDN settings, so setting the hostname there will ensure that both agents share a single hostname.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJjYXV0aW9uIn1d">
  <p>The New Relic user interface uses the hostname to link an app to its host server. Changing the hostname will cause a different name to be reported for the app server than what is reported by any monitored apps. If the app link is currently working, changing the hostname may break the host-server links.</p>
</div>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZnFkbi1leGFtcGxlIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJFeGFtcGxlOiBFZGl0IHlvdXIgRlFETiBzZXR0aW5ncyJ9XQ==">
    <div data-prop-text="title">Example: Edit your FQDN settings</div>
    <p>This example configures the server to use the following FQDN values:</p>
    <ul>
      <li>
        <p>IP address: <code>1.2.3.4</code></p>
      </li>
      <li>
        <p>FQDN: <code>myhost.example.com</code></p>
      </li>
      <li>
        <p>Short hostname: <code>myhost</code></p>
        <p>Most Linux distributions store hostname settings in two files, typically:</p>
      </li>
      <li>
        <p><code>/etc/hosts</code></p>
      </li>
      <li>
        <p><code>/etc/sysconfig/network</code> (This path may not exist in your Linux distribution.)</p>
        <p>To configure the hostname you want to be in effect the next time the host or server starts up:</p>
      </li>
    </ul>
    <ol>
      <li>
        <p>Append the IP address, FQDN, and short hostname to the existing data in <code>/etc/hosts</code>; for example:</p>
        <pre><code>127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4
::1 localhost localhost.localdomain localhost6 localhost6.localdomain6
1.2.3.4 myhost.example.com myhost
</code></pre>
      </li>
      <li>
        <p>If <code>/etc/sysconfig/network</code> is present, append the FQDN to the existing data in <code>/etc/sysconfig/network</code>. For example:</p>
        <pre><code>NETWORKING=yes
HOSTNAME=myhost.example.com
</code></pre>
      </li>
      <li>
        <p>Use the command line to set the current hostname, so the changes take effect without restarting the server:</p>
        <pre><code>sudo hostname myhost.example.com
</code></pre>
      </li>
      <li>
        <p>Restart the Java agent and Infrastructure agent to register the new hostname.</p>
      </li>
    </ol>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiYXdzLWV4YW1wbGUifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkV4YW1wbGU6IFNjcmlwdCBob3N0bmFtZSBzZXR0aW5ncyBvbiBBV1MgRWxhc3RpYyBCZWFuc3RhbGsifV0=">
    <div data-prop-text="title">Example: Script hostname settings on AWS Elastic Beanstalk</div>
    <p>You can also configure the hostname to be an FQDN at startup by using a shell script. In this example, <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/user-data.html"><code>cloud-init</code></a> passes a shell script to the <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/launching-instance.html#launch-instance-console">Amazon Machine Image</a> (AMI) at startup, using the variable <code>UserData</code>. A <code>cloud-init</code> script runs before the Java agent and the Infrastructure agent start, so the agents inherit the hostname settings from the <code>cloud-init</code> script.</p>
    <p>This example script configures all hostname settings. Depending on your Linux distribution, the <code>echo</code> command to <code>/etc/sysconfig/network</code> may not be required.</p>
    <pre><code>#!/bin/sh

# Set the hostname so the Infrastructure
# and Java agent see the same names.

SHORT_HOSTNAME=`hostname -s`
IP=`hostname -I`
DOMAIN="example.com"
HOSTNAME="${SHORT_HOSTNAME}.${DOMAIN}"

hostname "${HOSTNAME}"
echo "${IP} ${HOSTNAME}" >> /etc/hosts
echo "HOSTNAME=${HOSTNAME}" >> /etc/sysconfig/network

</code></pre>
  </div>
</div>
<h2>Cause</h2>
<p>New Relic links the app and the host or server together by string-matching the hostnames reported by the Java agent and the Linux agent for Infrastructure. If these two hostname strings are not identical, New Relic cannot connect the app and server in the <a href="/docs/apm/applications-menu/monitoring/applications-overview-dashboard">APM <strong>Summary</strong> page</a>.</p>
<p>There are several reasons this might occur. For example:</p>
<ul>
  <li>The JVM may be reporting the IP address and not the hostname.</li>
  <li>The JVM may report an IPv6 address, while the Linux agent reports an IPv4 address.</li>
</ul>
