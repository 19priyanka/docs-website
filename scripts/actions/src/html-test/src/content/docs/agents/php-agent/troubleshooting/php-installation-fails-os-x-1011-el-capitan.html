
<h2>Problem</h2>
<p>You attempt to install the PHP agent on OS X 10.11 - El Capitan, and it fails.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiRmFpbHVyZSB3aXRoIHRoZSBpbnN0YWxsIHNjcmlwdCJ9XQ==">
    <div data-prop-text="title">Failure with the install script</div>
    <p>Using the script <code>newrelic-install</code> you encounter something similar to this:</p>
    <pre><code>Install daemon ([y]es, [n]o or x to e[x]it): y

FATAL: failed to copy new daemon into place
FATAL: New Relic agent installation failed.

       Please contact http://support.newrelic.com
       and report the above error. We have also created a tar file with
       log files and other system info that can help solve the problem.

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiRmFpbHVyZSB3aXRoIHRoZSBtYW51YWwgaW5zdGFsbCBwcm9jZXNzIn1d">
    <div data-prop-text="title">Failure with the manual install process</div>
    <p>Using the <a href="/docs/agents/php-agent/advanced-installation/php-agent-installation-non-standard-php-advanced#manual">manual install process</a> with the install utility <strong>nrmaninstall.php</strong>, or following the manual instructions, you encounter something similar to this:</p>
    <pre><code>$ sudo cp ./agent/x86_64/newrelic-20121212.so /usr/lib/php/extensions/no-debug-non-zts-20121212/
cp: /usr/lib/php/extensions/no-debug-non-zts-20121212/newrelic-20121212.so: Operation not permitted

$ sudo cp ./daemon/newrelic-daemon.x86_64 /usr/bin/newrelic-daemon
cp: /usr/bin/newrelic-daemon: Operation not permitted

</code></pre>
  </div>
</div>
<h2>Solution</h2>
<p>The PHP agent may be installed by disabling (SIP). This is true for both the <strong>newrelic-install</strong> script and manual installations.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJjYXV0aW9uIn1d">
  <p>This is not an endorsement for disabling SIP in general. Be sure to verify that this does not violate the security policies of your organization.</p>
</div>
<p>The general procedure is:</p>
<ol>
  <li>Boot into recovery mode.</li>
  <li>Disable SIP and reboot.</li>
  <li>Install the New Relic PHP agent.</li>
  <li>Boot into recovery mode.</li>
  <li>Re-enable SIP and reboot.</li>
</ol>
<p>There are many articles available on the web that describe SIP and the steps for disabling, re-enabling, and checking the status.</p>
<h2>Cause</h2>
<p>PHP agent installation requires the daemon program to be installed in <code>/usr/bin</code> and the extension module in <code>/usr/lib</code>. However, those directories have <code>R-X</code> permissions, which means the daemon cannot be installed by normal means.</p>
<p>Apple's System Integrity Protection, SIP, prevents the modification of permissions on these directories even when logged in as root, admin or via a sudo privileged account. This also applies in situations where the PHP <code>bin</code> is self-contained (for example, MAMP).</p>
