
<p>This document provides some samples for how you can configure a <code>Dockerfile</code> to install the <a href="/docs/dotnet/new-relic-for-net">New Relic .NET agent</a>. Examples are included for both <a href="#windows">Windows</a> and <a href="#linux">Linux</a> containers.</p>
<p>Installing the .NET agent in a Docker container can be performed using the same procedures as a standard .NET agent install for either <a href="/docs/agents/net-agent/installation/install-net-agent-windows">Windows</a> or <a href="/docs/agents/net-agent/installation/install-net-agent-linux">Linux</a>. It's just a matter of configuring your <code>Dockerfile</code> to perform the procedure.</p>
<h2>Overview for install of .NET agent on Docker [#overview]</h2>
<p>Requirements include:</p>
<ul>
  <li>The agent must be installed on the containers you want to monitor.</li>
  <li><strong>Install the agent</strong> with one of the standard install procedures.</li>
  <li><strong>Enable the agent</strong> by setting the <a href="/docs/agents/net-agent/configuration/net-agent-configuration#environment-variables">required environment variables</a> as applicable.</li>
  <li>The .NET agent must be installed and enabled at runtime.</li>
</ul>
<h2>Install for Linux Docker containers [#linux]</h2>
<h3>Example Linux Dockerfile</h3>
<pre><code>FROM microsoft/dotnet:2.2-aspnetcore-runtime

# Publish your application.
COPY your app to be published /app

# Install the agent
RUN apt-get update &#x26;&#x26; apt-get install -y wget ca-certificates gnupg \
&#x26;&#x26; echo 'deb http://apt.newrelic.com/debian/ newrelic non-free' | tee /etc/apt/sources.list.d/newrelic.list \
&#x26;&#x26; wget https://download.newrelic.com/548C16BF.gpg \
&#x26;&#x26; apt-key add 548C16BF.gpg \
&#x26;&#x26; apt-get update \
&#x26;&#x26; apt-get install -y newrelic-netcore20-agent

# Enable the agent
ENV CORECLR_ENABLE_PROFILING=1 \
CORECLR_PROFILER={36032161-FFC0-4B61-B559-F6C5D41BAE5A} \
CORECLR_NEWRELIC_HOME=/usr/local/newrelic-netcore20-agent \
CORECLR_PROFILER_PATH=/usr/local/newrelic-netcore20-agent/libNewRelicProfiler.so \
NEW_RELIC_LICENSE_KEY=YOUR_LICENSE_KEY \
NEW_RELIC_APP_NAME=YOUR_APP_NAME

WORKDIR /app

ENTRYPOINT ["dotnet", "./YOUR_APP_NAME.dll"]
</code></pre>
<h3>Example Linux Multi-stage Dockerfile</h3>
<pre><code>FROM microsoft/dotnet:2.2-sdk AS base

# Build your application
WORKDIR /src
RUN dotnet new mvc -o YOUR_APP_NAME
RUN dotnet build -c Release -o /app/ ./YOUR_APP_NAME

FROM microsoft/dotnet:2.2-aspnetcore-runtime AS final

# Install the agent
RUN apt-get update &#x26;&#x26; apt-get install -y wget ca-certificates gnupg \
&#x26;&#x26; echo 'deb http://apt.newrelic.com/debian/ newrelic non-free' | tee /etc/apt/sources.list.d/newrelic.list \
&#x26;&#x26; wget https://download.newrelic.com/548C16BF.gpg \
&#x26;&#x26; apt-key add 548C16BF.gpg \
&#x26;&#x26; apt-get update \
&#x26;&#x26; apt-get install -y newrelic-netcore20-agent

# Enable the agent
ENV CORECLR_ENABLE_PROFILING=1 \
CORECLR_PROFILER={36032161-FFC0-4B61-B559-F6C5D41BAE5A} \
CORECLR_NEWRELIC_HOME=/usr/local/newrelic-netcore20-agent \
CORECLR_PROFILER_PATH=/usr/local/newrelic-netcore20-agent/libNewRelicProfiler.so \
NEW_RELIC_LICENSE_KEY=YOUR_LICENSE_KEY \
NEW_RELIC_APP_NAME=YOUR_APP_NAME

WORKDIR /app
COPY --from=base /app .

ENTRYPOINT ["dotnet", "./YOUR_APP_NAME.dll"]
</code></pre>
<h2>Install for Windows Docker containers [#windows]</h2>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>Windows Nano Server images are not supported.</p>
</div>
<h3>Example Windows Dockerfile for .NET Framework application [#example-windows-dockerfile-framework]</h3>
<pre><code>FROM microsoft/aspnet

# Publish your application.
COPY your app to be published /inetpub/wwwroot

# Copy the New Relic .NET agent installer
COPY ./NewRelicDotNetAgent_x64.msi /

# Install the agent
RUN powershell.exe Start-Process -Wait -FilePath msiexec -ArgumentList /i,\ 
"C:\NewRelicDotNetAgent_x64.msi",\
/qn,NR_LICENSE_KEY=YOUR_LICENSE_KEY

# Set your application name
ENV NEW_RELIC_APP_NAME=YOUR_APP_NAME
</code></pre>
<h3>Example Windows Dockerfile for .NET Core application [#example-windows-dockerfile-net-core]</h3>
<pre><code>FROM mcr.microsoft.com/windows/servercore:ltsc2019

# Publish your application.
COPY your app to be published /app

# Copy the New Relic .NET agent installer
COPY ./NewRelicDotNetAgent_x64.msi /

# Install the agent
RUN Start-Process -Wait -FilePath msiexec -ArgumentList /i,
"C:\NewRelicDotNetAgent_x64.msi",
/qn, NR_LICENSE_KEY=YOUR_LICENSE_KEY

# Enable the agent
ENV CORECLR_ENABLE_PROFILING=1

# Set your application name
ENV NEW_RELIC_APP_NAME=YOUR_APP_NAME

# windowsservercore images may not include the .NET Core SDK or runtime
RUN dotnet sdk/runtime installer

WORKDIR /app

ENTRYPOINT ["dotnet", ".\\YOUR_APP_NAME.dll"]
</code></pre>
