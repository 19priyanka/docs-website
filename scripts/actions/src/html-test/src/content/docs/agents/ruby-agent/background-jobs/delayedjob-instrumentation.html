
<p>The Ruby agent has built-in instrumentation for the <code>Delayed::Job</code> library. No additional instrumentation is required.</p>
<h2>Viewing background tasks [#viewing]</h2>
<p>As long as the New Relic Ruby agent's gem or plugin is loaded before the <code>Delayed::Job</code> worker starts, all tasks will be monitored with the same level of detail as controller actions. To view the actions themselves:</p>
<ol>
  <li>Go to <strong><a href="https://one.newrelic.com">one.newrelic.com</a> > APM > (select an app) > Monitor > Transactions</strong>.</li>
  <li>From the <a href="/docs/apm/applications-menu/monitoring/transactions-page">APM <strong>Transactions</strong> page</a>, select <strong>Other transactions</strong>.</li>
</ol>
<h2>Troubleshooting</h2>
<p>The Ruby agent depends on being able to identify that it is running under <code>Delayed::Job</code> in order to correctly set up instrumentation. To do this, it examines the script name (the <code>$0</code> variable in Ruby) to see whether it ends with <code>delayed_job</code>.</p>
<p>If you have renamed the script you use to start your <code>delayed_job</code> workers to something else, or if you have a custom script with a different name, you will need to explicitly tell the agent that you are using <code>Delayed::Job</code> by setting the <code>NEW_RELIC_DISPATCHER</code> environment variable to <code>delayed_job</code> when starting your <code>Delayed::Job</code> workers. For example:</p>
<pre><code>NEW_RELIC_DISPATCHER=delayed_job bundle exec ./script/my_custom_script
</code></pre>
<p>If it appears that jobs are not being monitored, review the <strong>newrelic_agent.log</strong> file generated when the worker starts up. It should indicate whether the agent detects <code>Delayed</code> and communicates with the server. If you do not find a log, or if you still cannot determine why the jobs do not appear, get support at <a href="https://support.newrelic.com" title="Link opens in a new window">support.newrelic.com</a>.</p>
