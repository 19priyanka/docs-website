
<h2>Syntax</h2>
<pre><code>newrelic.agent.record_exception(exc=None, value=None, tb=None, params={}, ignore_errors=[], application=None)
</code></pre>
<p>Records details of a Python exception as an error.</p>
<h2>Description</h2>
<p>By default, the Python agent only reports unhandled exceptions. Use <code>record_exception</code> to record any Python exception as an error, which can then be found in New Relic One. If no parameters are provided, the details of the exception currently being handled will be used.</p>
<p>You can record up to five distinct exceptions per <a href="/docs/accounts-partnerships/education/getting-started-new-relic/glossary#transaction">transaction</a>, and up to 20 total exceptions across all transactions per <a href="/docs/apm/new-relic-apm/getting-started/glossary#harvest-cycle">harvest cycle</a>.</p>
<p>When <code>record_exception()</code> is called within the context of a monitored web request or background task, the details of the exception will be reported against the application that the request or task is being reported to.</p>
<p>If called outside of the context of a monitored web request or background task, the call will be ignored unless the <a href="/docs/agents/python-agent/python-agent-api/application"><code>application</code></a> keyword argument is provided and an application object corresponding to the application against which the exception should be recorded is provided. A suitable application object can be obtained using the <code>newrelic.agent.application()</code> function.</p>
<h2>Parameters</h2>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>In almost all cases, <code>record_exception</code> will require no parameters.</p>
</div>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Parameter</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>exc</code></p>
        <p><em>class object</em></p>
      </div>
      <div>
        <p>Optional and rarely used. The exception type of the exception being handled (a class object). One of three values (<code>exc</code>, <code>value</code>, and <code>tb</code>) returned from <a href="https://docs.python.org/2/library/sys.html#sys.exc_info"><code>sys.exc_info()</code></a>. If you want to pass any of these parameters, all three must be set and and cannot be set to <code>None</code>. If you only pass one of these values, the call will not work.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>value</code></p>
        <p><em>int, string, other</em></p>
      </div>
      <div>
        <p>Optional and rarely used. The exception parameter. One of three values (<code>exc</code>, <code>value</code>, and <code>tb</code>) returned from <a href="https://docs.python.org/2/library/sys.html#sys.exc_info"><code>sys.exc_info()</code></a>. If you want to pass any of these parameters, all three must be set and and cannot be set to <code>None</code>. If you only pass one of these values, the call will not work.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>tb</code></p>
        <p><em>object</em></p>
      </div>
      <div>
        <p>Optional and rarely used. A traceback object that encapsulates the call stack at the point where the exception originally occurred. One of three values (<code>exc</code>, <code>value</code>, and <code>tb</code>) returned from <a href="https://docs.python.org/2/library/sys.html#sys.exc_info"><code>sys.exc_info()</code></a>. If you want to pass any of these parameters, all three must be set and and cannot be set to <code>None</code>. If you only pass one of these values, the call will not work.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>params</code></p>
        <p><em>dict</em></p>
      </div>
      <div>
        <p>Optional. Custom attributes to add to the error event (in addition to any custom attributes already added to the transaction). If <a href="/docs/agents/manage-apm-agents/configuration/high-security-mode">high security mode</a> is enabled, this will not work.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>ignore_errors</code></p>
        <p><em>string</em></p>
      </div>
      <div>
        <p>Optional. Errors to ignore can be passed in the form <code>module:class</code>. Useful when certain types of exceptions should always be ignored and never recorded.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>application</code></p>
        <p><em>application object</em></p>
      </div>
      <div>
        <p>Optional. If called outside of the context of a monitored web request or background task, the call will be ignored unless the <a href="/docs/agents/python-agent/python-agent-api/application"><code>application</code> object</a> is provided.</p>
      </div>
    </div>
  </div>
</div>
<h2>Return values</h2>
<p>None.</p>
<h2>Examples</h2>
<h3>Simple example of reporting exceptions [#simple-example]</h3>
<p>In large majority of cases, you won't need to pass any paramters. You would just call the following where you want to report an exception:</p>
<pre><code>newrelic.agent.record_exception()
</code></pre>
<h3>Call with sys.exc_info() tuple and additional parameters [#complex-example]</h3>
<p>An example of <code>record_exception</code> using <code>sys.exc_info()</code> data:</p>
<pre><code>def complex_ignore_errors(exc, val, tb):
   # do some logic here
   return False

newrelic.agent.record_exception(params={'my_special_exception': True}, ignore_errors=complex_ignore_errors)
</code></pre>
<h3>Example using callback [#callback-example]</h3>
<p>If you need to filter exceptions dynamically based on the attributes of a specific exception type, you can supply a callback function:</p>
<pre><code>def _ignore_errors(exc, value, tb): 
    if instance(value, HTTPError): 
        if value.status == 404: 
            return True

newrelic.agent.record_exception(ignore_errors=_ignore_errors)
</code></pre>
<p>If the exception is to be ignored, set the return value for the callable to <code>True</code>. Return <code>False</code> if the exception should never be ignored regardless of any other checks, and <code>None</code> if subsequent checks and inbuilt rules should determine if the exception should be ignored. A callback would normally return either <code>True</code> or <code>None</code>.</p>
