
<h2>Syntax</h2>
<pre><code>newrelic.agent.wsgi_application(application=None, name=None, group=None, framework=None)
</code></pre>
<p>Monitor web transactions by marking the WSGI application entry point.</p>
<h2>Description</h2>
<p><code>wsgi_application</code> is a Python decorator used to monitor web transactions by instrumenting the WSGI application entry point. The Python agent automatically supports <a href="/docs/agents/python-agent/getting-started/compatibility-requirements-python-agent">most frameworks and servers</a> that use WSGI. If your framework or web server is not supported, you may need to use this API as part of the <a href="/docs/agents/python-agent/installation-configuration/python-agent-integration#manual-integration">advanced integration process</a>.</p>
<p>If you cannot use the <code>wsgi_application</code> decorator, you can use one of these other call formats:</p>
<ul>
  <li><strong>The wrapper:</strong> The wrapper call is <code>WSGIApplicationWrapper</code>. You can use the wrapper in more than one place for distinct WSGI application components that may be stacked. In that case, the first wrapper encountered marks the start of the transaction and the agent determines the target app based on that first wrapper (and ignores subsequent ones).</li>
  <li><strong>The path-based wrapper:</strong> The path-based wrapper call is <code>wrap_wsgi_application</code>. Use this if you could not reference the WSGI object as a variable in the instrumentation scope. This takes the same parameters as the decorator with additional <code>module</code> and <code>object_path</code> parameters.</li>
</ul>
<p>For an explanation of the reasons to use the decorator versus the wrappers, see <a href="/docs/python-agent-api-different-call-forms">Different call formats</a>.</p>
<h2>Parameters</h2>
<h3>Decorator parameters</h3>
<pre><code>newrelic.agent.wsgi_application(application=None, name=None, group=None, framework=None)
</code></pre>
<p>The <code>wsgi_application</code> decorator uses these parameters:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Parameter</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>application</code></p>
        <p><em>string, application object</em></p>
      </div>
      <div>
        <p>Optional. The application name to associate with this data. Default is <code>None</code>. If left without a value, the agent uses the application name <a href="/docs/agents/python-agent/installation-configuration/python-agent-configuration#app_name">specified in the agent configuration</a>.</p>
        <p>If a string is provided, it must be the exact application name and cannot be a list of application names. For more on generating an application object, see the <a href="/docs/agents/python-agent/python-agent-api/application"><code>application</code></a> method.</p>
        <p>The application, even if specified, can still be overridden if <code>newrelic.app_name</code> is defined within the WSGI application per request environ dictionary.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>name</code></p>
        <p><em>string</em></p>
      </div>
      <div>
        <p>Optional, rarely used. Sets a transaction name for all requests captured via the WSGI entry point. Generally not used, because you usually would not want all transactions to have the same name (see also <a href="/docs/agents/manage-apm-agents/troubleshooting/metric-grouping-issues">Metric grouping issue</a>).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>group</code></p>
        <p><em>string</em></p>
      </div>
      <div>
        <p>Optional, rarely used. The <code>group</code> represents the naming structure for the <code>name</code> parameter. Setting this creates a <a href="/docs/apm/applications-menu/monitoring/transactions-page#tx_functions">transaction type subcategory</a>. Similar to <code>name</code>, this should be rarely used because you usually do not want the entire application to report as one transaction name or category.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>framework</code></p>
        <p><em>tuple</em></p>
      </div>
      <div>
        <p>Optional. A tuple with two strings representing the name of the framework and the version number. For example: <code>('Flask', '0.12.2')</code></p>
      </div>
    </div>
  </div>
</div>
<h3>Wrapper parameters</h3>
<pre><code>newrelic.agent.WSGIApplicationWrapper(wrapped, application=None, name=None, group=None, framework=None)
</code></pre>
<p>This takes all of the <a href="#decorator-parameters">parameters</a> required by <code>wsgi_application</code> in addition to a <code>wrapped</code> parameter:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Parameter</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>wrapped</code></p>
        <p><em>object</em></p>
      </div>
      <div>
        <p>Required. The WSGI object to be wrapped.</p>
      </div>
    </div>
  </div>
</div>
<h3>Path-based wrapper parameters [#path-based-parameters]</h3>
<pre><code>newrelic.agent.wrap_wsgi_application(module, object_path, application=None, name=None, group=None, framework=None)
</code></pre>
<p>In addition to the <a href="#decorator-parameters">parameters</a> required by <code>wsgi_application</code>, this call requires additional <code>module</code> and <code>object_path</code> parameters:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Parameter</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>module</code></p>
        <p><em>object</em> or <em>string</em></p>
      </div>
      <div>
        <p>Required. The module containing the WSGI object.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>object_path</code></p>
        <p><em>string</em></p>
      </div>
      <div>
        <p>Required. Represents the class method or method for finding the WSGI object within a file.</p>
      </div>
    </div>
  </div>
</div>
<h2>Examples</h2>
<h3>wsgi_application example [#decorator-example]</h3>
<p>An example of the decorator being called without the optional <code>application</code> parameter:</p>
<pre><code>@newrelic.agent.wsgi_application()
def application(environ, start_response):
    status = '200 OK'
    output = 'Hello World!'

    response_headers = [('Content-type', 'text/plain'),
                        ('Content-Length', str(len(output)))]
    start_response(status, response_headers)

    return [output]
</code></pre>
<h3>WSGIApplicationWrapper example [#wrapper-example]</h3>
<p>An example of using the <code>WSGIApplicationWrapper</code>, which may be necessary if the <code>wsgi_application</code> decorator doesn't work:</p>
<pre><code>import os
os.environ.setdefault("DJANGO_SETTINGS_MODULE", "mysite.settings")
from django.core.wsgi import get_wsgi_application
application = get_wsgi_application()

application = newrelic.agent.WSGIApplicationWrapper(application)
</code></pre>
<h3>wrap_wsgi_application example [#path-based-example]</h3>
<p>An example of using the path-based wrapper:</p>
<pre><code>import newrelic.agent
newrelic.agent.initialize('newrelic.ini')

class Application(object):
    def application(self, environ, start_response):
        status = '200 OK'
        response_headers = [('Content-type', 'text/plain')]
        start_response(status, response_headers)
        return [b'Hello World']

newrelic.agent.wrap_wsgi_application(__name__, 'Application.application')
</code></pre>
