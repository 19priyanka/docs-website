
<h2>Problem</h2>
<p>Your app uses New Relic's Java agent and you run into a <a href="/docs/agents/manage-apm-agents/troubleshooting/metric-grouping-issues">metric grouping issue</a>.</p>
<h2>Solution</h2>
<p>Try these troubleshooting procedures before metric grouping issues become too big of a problem.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicmVjb25maWd1cmUtamF2YSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiTWFrZSBzdXJlIGNvbXBvbmVudC1iYXNlZCBuYW1pbmcgaXMgZW5hYmxlZCJ9XQ==">
    <div data-prop-text="title">Make sure component-based naming is enabled</div>
    <p>By default, the Java agent <a href="/docs/agents/java-agent/instrumentation/naming-web-transactions">names transactions</a> based on your framework and the various components of your application. However, if the Java agent is configured to disable component-based naming, it will not be able to properly name those transactions. This will often lead to a metric grouping issue.</p>
    <p>To troubleshoot your Java agent configuration: If <a href="/docs/agents/java-agent/instrumentation/naming-web-transactions#reverting">component-based naming</a> has been disabled, re-enable it.</p>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidXBncmFkZSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiVXBncmFkZSB0aGUgSmF2YSBhZ2VudCJ9XQ==">
    <div data-prop-text="title">Upgrade the Java agent</div>
    <p>Some metric grouping issues can be resolved simply by <a href="/docs/agents/java-agent/installation/upgrade-java-agent">upgrading your New Relic agent</a>. Unless you have a good reason not to, New Relic recommends always upgrading to the most recent version.</p>
    <p>To troubleshoot your Java agent version, refer to the <a href="/docs/release-notes/agent-release-notes/java-release-notes">Java agent release notes</a>. The release notes summarize fixes and changes, including situations where agent-related metric grouping issues have been corrected.</p>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibWFudWFsbHktbmFtZS10cmFuc2FjdGlvbnMifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6Ik1hbnVhbGx5IG5hbWUgdHJhbnNhY3Rpb25zIn1d">
    <div data-prop-text="title">Manually name transactions</div>
    <p>If your Java agent version is up to date and correctly configured, but you still run into a metric grouping issue, you may need to <a href="/docs/agents/java-agent/instrumentation/naming-web-transactions">manually name your transactions</a>. To help you get started, refer to New Relic's <a href="/docs/agents/java-agent/custom-instrumentation/java-agent-api-example-program">example program using the Java API</a>.</p>
    <p>The <a href="/docs/agents/java-agent/custom-instrumentation/java-agent-api">Java agent API</a> allows you to <a href="http://newrelic.github.io/java-agent-api/javadoc/com/newrelic/api/agent/NewRelic.html#setTransactionName%28java.lang.String,%20java.lang.String%29">set a transaction name</a> within your application. This helps eliminate unique names and IDs in metric names.</p>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicmVzb2x2ZS1saW1pdCJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiUmVzb2x2ZSBtZXRyaWMgbGltaXQgcGxhY2VkIGJ5IE5ldyBSZWxpYyJ9XQ==">
    <div data-prop-text="title">Resolve metric limit placed by New Relic</div>
    <p>After detecting a metric grouping issue, New Relic automatically applies a metric limit to your app. This prevents new metric names from coming into your app.</p>
    <p>The metric limit prevents the problem from getting any worse. However, before New Relic can remove the limit, the cause of the metric grouping issue must be resolved.</p>
    <p>Once the underlying problem has been managed, <a href="https://support.newrelic.com">New Relic Support</a> will check your application to make sure that:</p>
    <ul>
      <li>
        <p>Your upgraded Java agent no longer sends the older metrics that were causing grouping issues.</p>
      </li>
      <li>
        <p>Your new <a href="/docs/agents/java-agent/instrumentation/naming-web-transactions">transaction names</a> properly exclude the unique portions of the name.</p>
        <p>After confirming that the metric grouping issue is resolved, New Relic Support will manually update your application so that new metric names will once again be allowed.</p>
      </li>
    </ul>
  </div>
</div>
