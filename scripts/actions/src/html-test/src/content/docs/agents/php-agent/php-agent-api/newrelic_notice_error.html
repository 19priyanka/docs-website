
<h2>Syntax</h2>
<pre><code>newrelic_notice_error(string $message)
newrelic_notice_error(Throwable|Exception $e)
newrelic_notice_error(int $errno, string $errstr, string $errfile, int $errline, string $errcontext)
</code></pre>
<p>Use these calls to collect errors that the PHP agent does not collect automatically and to set the callback for your own error and exception handler.</p>
<h2>Requirements</h2>
<p>Agent version 2.6 or higher.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidmVyc2lvbi1kaWZmZXJlbmNlIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InZhcmlhbnQiLCJ2YWx1ZSI6ImNhdXRpb24ifV0=">
  <p>If you include an exception (<code>$e</code>), there are differences depending on the PHP version you are using:</p>
</div>
<ul>
  <li><strong>PHP version 5 or lower</strong>: You must pass a valid PHP <strong>Exception</strong> class.</li>
  <li><strong>PHP version 7 or higher</strong>: You must pass a valid PHP <strong>Throwable</strong> interface.</li>
</ul>
<h2>Description</h2>
<p>The PHP agent handles PHP errors and exceptions <a href="/docs/agents/manage-apm-agents/agent-data/manage-errors-apm-collect-ignore-mark-expected">automatically for supported frameworks</a>.</p>
<p>If you want to collect errors that are not handled automatically so that you can <a href="/docs/insights/nrql-new-relic-query-language/using-nrql/introduction-nrql">query</a> for those errors in <a href="/docs/insights/use-insights-ui/getting-started/introduction-new-relic-insights">New Relic</a> and view <a href="/docs/apm/applications-menu/error-analytics/error-analytics-explore-events-behind-errors#traces-table">error traces</a>, you can use <code>newrelic_notice_error</code>.</p>
<p>If you want to use your own error and exception handlers, you can set <code>newrelic_notice_error</code> as the callback.</p>
<h3>Collect errors that are not handled automatically [#own-exception-handler]</h3>
<p>To collect errors that the PHP agent does not handle automatically, such as non-PHP errors, <a href="#non-php-exceptions">add this call to the function that you want to report on</a>:</p>
<pre><code>newrelic_notice_error(Throwable|Exception $e)
</code></pre>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>When there are multiple calls to this function in a single transaction, the PHP agent retains the exception from the last call only.</p>
</div>
<h3>Set the callback for your own error and exception handler [#set-callback]</h3>
<p>To use your own handler, use these calls to make sure that the PHP agent notices the errors and exceptions from within your handler.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoic2V0LWV4Y2VwdGlvbi1oYW5kbGVyIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOnsidHlwZSI6Im1keFZhbHVlRXhwcmVzc2lvbiIsInZhbHVlIjoiPElubGluZUNvZGU+c2V0X2V4Y2VwdGlvbl9oYW5kbGVyKCk8L0lubGluZUNvZGU+IiwicG9zaXRpb24iOnsic3RhcnQiOnsibGluZSI6NjMsImNvbHVtbiI6MTEsIm9mZnNldCI6MjU3MH0sImVuZCI6eyJsaW5lIjo2MywiY29sdW1uIjo2MSwib2Zmc2V0IjoyNjIwfX19fV0=">
    <div data-prop-text="title">[object Object]</div>
    <p>To <a href="#custom-exception-handler">provide <code>newrelic_notice_error</code> as the callback</a> for <a href="https://secure.php.net/manual/en/function.set-exception-handler.php"><code>set_exception_handler()</code></a>, use the following:</p>
    <pre><code>newrelic_notice_error(Throwable|Exception $e)

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoic2V0LWVycm9yLWhhbmRsZXIifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6eyJ0eXBlIjoibWR4VmFsdWVFeHByZXNzaW9uIiwidmFsdWUiOiI8SW5saW5lQ29kZT5zZXRfZXJyb3JfaGFuZGxlcigpPC9JbmxpbmVDb2RlPiIsInBvc2l0aW9uIjp7InN0YXJ0Ijp7ImxpbmUiOjc0LCJjb2x1bW4iOjExLCJvZmZzZXQiOjI5NjN9LCJlbmQiOnsibGluZSI6NzQsImNvbHVtbiI6NTcsIm9mZnNldCI6MzAwOX19fX1d">
    <div data-prop-text="title">[object Object]</div>
    <p>To <a href="#custom-error-handler-5">provide <code>newrelic_notice_error</code> as the callback</a> for <a href="https://secure.php.net/set_error_handler"><code>set_error_handler()</code></a>, use the following:</p>
    <pre><code>newrelic_notice_error(int $errno, string $errstr, string $errfile, int $errline, string $errcontext)

</code></pre>
  </div>
</div>
<h2>Parameters</h2>
<p>This function can handle a variable number of parameters. You can pass-in 1 or 5 parameters, depending on your use case.</p>
<pre><code>newrelic_notice_error(string $message)
</code></pre>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Parameter</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>$message</code></p>
        <p><em>string</em></p>
      </div>
      <div>
        <p>Required. Provide an error message that will be meaningful to you when it displays in <a href="/docs/apm/applications-menu/error-analytics/error-analytics-explore-events-behind-errors#traces-table">error traces</a>.</p>
      </div>
    </div>
  </div>
</div>
<pre><code>newrelic_notice_error(Throwable|Exception $e)
</code></pre>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Parameter</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>$e</code></p>
        <p><em>exception</em></p>
      </div>
      <div>
        <p>Required. Defaults to <code>null</code>.</p>
        <ul>
          <li>The agent uses <a href="#version-difference"><code>Exception</code> or <code>Throwable</code></a> to capture the stack frame and set the error class to the exception class name.</li>
          <li>If <code>null</code> or omitted, the agent reports an "exception" in the same format created by <code>Exception::__toString</code>.</li>
        </ul>
      </div>
    </div>
  </div>
</div>
<pre><code>newrelic_notice_error(int $errno, string $errstr, string $errfile, int $errline, string $errcontext)
</code></pre>
<div data-component="Table" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ3aWR0aCIsInZhbHVlIjp7InR5cGUiOiJtZHhWYWx1ZUV4cHJlc3Npb24iLCJ2YWx1ZSI6IjgwMCIsInBvc2l0aW9uIjp7InN0YXJ0Ijp7ImxpbmUiOjE1OSwiY29sdW1uIjoxNCwib2Zmc2V0Ijo0Nzg5fSwiZW5kIjp7ImxpbmUiOjE1OSwiY29sdW1uIjoxOSwib2Zmc2V0Ijo0Nzk0fX19fV0=">
  <div>
    <div>
      <div>
        <p>Parameter</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>$errno</code></p>
        <p><em>integer</em></p>
      </div>
      <div>
        <p>Required. The <a href="http://php.net/manual/en/errorfunc.constants.php">predefined level of the error</a>, expressed as an integer.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>$errstr</code></p>
        <p><em>string</em></p>
      </div>
      <div>
        <p>Required. Provide an error message that will be meaningful to you when it displays in <a href="/docs/apm/applications-menu/error-analytics/error-analytics-explore-events-behind-errors#traces-table">error traces</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>$errfile</code></p>
        <p><em>string</em></p>
      </div>
      <div>
        <p>Optional. The name of the file that the error occurred in.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>$errline</code></p>
        <p><em>integer</em></p>
      </div>
      <div>
        <p>Optional. The line number where the error occurred.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>$errcontext</code></p>
        <p><em>string</em></p>
      </div>
      <div>
        <p>Optional. An array that points to the symbol table that was active when the error occurred.</p>
      </div>
    </div>
  </div>
</div>
<h2>Return values</h2>
<p>Returns <code>null</code> regardless of result.</p>
<h2>Examples</h2>
<h3>Collect errors that are not handled automatically [#non-php-exceptions]</h3>
<p>Track errors that aren't reported automatically or that aren't PHP errors. In this example, an error is sent to the PHP agent if an unknown user accesses your app.</p>
<pre><code>try {
	//Add your code that may throw an error here.
} catch (UserNotFoundException $e) {
    	newrelic_notice_error($e);
        //Handle normally.
}
</code></pre>
<h3>Report exceptions from your own exception handler [#custom-exception-handler]</h3>
<p>Make the PHP agent notice exceptions from within your own exception handler.</p>
<pre><code>function example_exception_handler($ex) {
    if (extension_loaded('newrelic'))
    {
        newrelic_notice_error($ex);
    }
    //Add your code here.
}
</code></pre>
<h3>Report errors from your own error handler (PHP version 5.6 or higher) [#custom-error-handler-5]</h3>
<p><strong>PHP version 5.6 or higher</strong>: Make the PHP agent notice errors from within your own error handler.</p>
<pre><code>function example_error_handler($errno, $errstr, $errfile = null, $errline = null, $errcontext = null) {
    if (extension_loaded('newrelic'))
    {
        newrelic_notice_error(...func_get_args());
    }
    //Add your code here.
}
</code></pre>
<h3>Report errors from your own error handler (PHP version 5.5 or lower) [#custom-error-handler-7]</h3>
<p><strong>PHP version 5.5 or lower</strong>: Make the PHP agent notice errors from within your own error handler.</p>
<pre><code>function example_error_handler($errno, $errstr, $errfile = null, $errline = null, $errcontext = null) {
    if (extension_loaded('newrelic'))
    {
        call_user_func_array('newrelic_notice_error', func_get_args());
    }
    //Add your code here.
}
</code></pre>
