
<p>Monitor your <a href="/docs/agents/go-agent/get-started/new-relic-go">New Relic for Go</a> application or microservice by creating <a href="/docs/apm/transactions/intro-transactions/transactions-new-relic-apm">transactions</a> associated with specific app server activities, such as HTTP responses or background tasks. You can then view your app's performance in the New Relic, including the <a href="/docs/apm/applications-menu/monitoring/transactions-page">APM <strong>Transactions</strong> page</a>.</p>
<h2>Identify web and non-web transactions [#go-monitoring]</h2>
<p>Unlike many other languages, Go applications run from a compiled, native binary file. This means that setting up New Relic for your Golang app requires you to manually add New Relic methods to your source code.</p>
<p>In APM, transactions are identified as <a href="/docs/apm/transactions/intro-transactions/transactions-new-relic-apm">web transactions</a> or <a href="/docs/apm/transactions/intro-transactions/monitor-background-processes-other-non-web-transactions">non-web transactions</a>.</p>
<ul>
  <li>When you instrument or wrap a transaction that has an HTTP request and response writer, New Relic treats it as a web transaction.</li>
  <li>When you instrument or wrap a transaction that does not have HTTP data, New Relic treats it as a non-web transaction.</li>
</ul>
<p>Segments are the functions and calls that make up a transaction. You can also use New Relic for Go to <a href="/docs/agents/go-agent/get-started/instrument-go-segments">add segment-level detail to your transactions</a>.</p>
<h2>Monitor a transaction [#go-txn]</h2>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>Do not use brackets <code>[suffix]</code> at the end of your transaction name. New Relic automatically strips brackets from the name. Instead, use parentheses <code>(suffix)</code> or other symbols if needed.</p>
</div>
<p>To monitor a transaction: Place the following code immediately after the start of the function you want to monitor. For example:</p>
<pre><code>txn := app.StartTransaction("transaction_name")
defer txn.End()
</code></pre>
<p>In this code example:</p>
<ul>
  <li><code>app</code> refers to the variable assigned during the New Relic configuration process. For more information, see the <a href="/docs/agents/go-agent/installation/install-new-relic-go">Go agent installation procedures</a>.</li>
  <li>The <a href="https://gobyexample.com/defer"><code>defer</code></a> statement defers the segment ending until the function closes.</li>
</ul>
<p>To monitor a web transaction, call the <code>Transaction.SetWebRequest</code> and optionally the <code>Transaction.SetWebResponse</code> APIs:</p>
<pre><code>txn := app.StartTransaction("transaction_name")
defer txn.End()

// req is a *http.Request, this marks the transaction as a web transaction
txn.SetWebRequestHTTP(req)

// writer is a http.ResponseWriter, use the returned writer in place of the original
writer = txn.SetWebResponse(writer)
writer.WriteHeader(500)
</code></pre>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidHJhbnNhY3Rpb24tZXhhbXBsZSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiVHJhbnNhY3Rpb24gZXhhbXBsZSJ9XQ==">
    <div data-prop-text="title">Transaction example</div>
    <p>Here is a simple before-and-after example for creating a transaction called <code>checkout_transaction</code>:</p>
    <p><strong>Before:</strong></p>
    <pre><code>func checkout() {
    // function code here
}

</code></pre>
    <pre><code>
func checkout() {
    txn := app.StartTransaction("checkout_transaction")
    defer txn.End()
    // function code here
}

</code></pre>**After:**
  </div>
</div>
<h2>Monitor a transaction with multiple goroutines</h2>
<p>To monitor a transaction across multiple goroutines, use <code>Transaction.NewGoroutine()</code>. The <code>NewGoroutine</code> method returns a new reference to the Transaction, which is required by each segment-creating goroutine. It does not matter if you call <code>NewGoroutine</code> before or after the other goroutine starts.</p>
<p>All <code>Transaction</code> methods can be used in any <code>Transaction</code> reference. The <code>Transaction</code>will end when <code>End()</code> is called in any goroutine.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibXVsdGllLWV4YW1wbGUifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6Ik11bHRpcGxlIGdvcm91dGluZXMgZXhhbXBsZSJ9XQ==">
    <div data-prop-text="title">Multiple goroutines example</div>
    <p>The below example passes a new <code>Transaction</code> reference directly to another goroutine:</p>
    <pre><code>go func(txn *newrelic.Transaction) {
    defer txn.StartSegment("async").End()
    time.Sleep(100 * time.Millisecond)
}(txn.NewGoroutine())

</code></pre>
    <pre><code>
ch := make(chan *newrelic.Transaction)
go func() {
    txn := &#x3C;-ch
    defer txn.StartSegment("async").End()
    time.Sleep(100 * time.Millisecond)
}()
ch &#x3C;- txn.NewGoroutine()

</code></pre>The below example passes a new `Transaction` reference on a channel to another goroutine:
  </div>
</div>
<h2>Monitor a transaction by wrapping an HTTP handler [#http-handler-txns]</h2>
<p>If you are using the standard HTTP library package, you can create transactions by wrapping HTTP requests, as an alternative to <a href="/docs/agents/go-agent/get-started/new-relic-go-monitor-transactions#go-txn">instrumenting a function's code</a>.</p>
<p>Here is a before-and-after example of an HTTP handler being wrapped:</p>
<p><strong>Before:</strong></p>
<pre><code>http.HandleFunc("/users", usersHandler)
</code></pre>
<p><strong>After:</strong></p>
<p>This automatically starts and ends a transaction with the request and response writer.</p>
<pre><code>http.HandleFunc(newrelic.WrapHandleFunc(app, "/users", usersHandler))
</code></pre>
<p>To access the transaction in your handler, use the <code>newrelic.FromContext</code> API. Note this will only work for Go versions 1.7 and newer. For example:</p>
<pre><code>func myHandler(w http.ResponseWriter, r *http.Request) {
    txn := newrelic.FromContext(r.Context())
    txn.NoticeError(errors.New("my error message"))
}â€‹
</code></pre>
<h2>Monitor errors [#go-error-methods]</h2>
<p>New Relic for Go captures errors in three different ways:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>If you want to...</p>
      </div>
      <div>
        <p>Use this</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>Track errors and report any combination of message, class, and attributes</p>
      </div>
      <div>
        <p><a href="https://github.com/newrelic/go-agent/blob/master/GUIDE.md#noticeerror"><code>Transaction.NoticeError()</code></a></p>
      </div>
    </div>
    <div>
      <div>
        <p>Report panics</p>
      </div>
      <div>
        <p>Transactions ended with <code>defer</code> automatically record panics. <a href="https://github.com/newrelic/go-agent/blob/master/GUIDE.md#panics">See the New Relic for Go GitHub documentation for more information</a>. As of version 3.0.0, this feature must be specifically enabled by setting the <code>Config.ErrorCollector.RecordPanics</code> configuration to <code>true</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Report error response codes</p>
      </div>
      <div>
        <p>Transactions automatically record errors above 400 and below 100. <a href="https://github.com/newrelic/go-agent/blob/master/GUIDE.md#error-response-codes">See the New Relic for Go GitHub documentation for more information</a>.</p>
      </div>
    </div>
  </div>
</div>
<h2>Additional transaction methods [#go-transactions-methods]</h2>
<p>The <code>Transaction</code> object has several optional methods that can be used for controlling transaction behavior, such as <code>NoticeError</code>, <code>AddAttribute</code>, and <code>Ignore</code>. For a list of transaction methods, see the <a href="https://godoc.org/github.com/newrelic/go-agent/v3/newrelic#Transaction">New Relic for Go transaction methods on Godoc</a>.</p>
