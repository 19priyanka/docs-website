
<p>This document contains detailed descriptions of resources and procedures that are referenced in the <a href="/docs/agents/net-agent/installation/new-relic-net-agent-install-introduction">New Relic .NET agent install procedures</a>.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>This document is <strong>not</strong> meant to be read as a standalone document. For install instructions, see <a href="https://docs.newrelic.com/docs/agents/net-agent/installation/install-enable-new-relic-net-agent">Introduction to .NET agent install</a>.</p>
</div>
<h2>Microsoft's .NET profiler [#profiler]</h2>
<p>New Relic’s .NET agent relies on the <a href="https://docs.microsoft.com/en-us/dotnet/framework/unmanaged-api/profiling/profiling-overview">Microsoft profiling API</a> to report data from your .NET application.</p>
<p>.NET monitoring solutions other than New Relic can use this profiling API. But only one service can use the profiler at a time. This means that if you have used a .NET monitoring service in the past and haven’t completely disabled/removed it, the profiler may still be in use, which will cause <a href="/docs/agents/net-agent/troubleshooting/profiler-conflicts">profiler conflicts</a> when you try to enable the .NET agent.</p>
<h2>.NET agent download library [#download-library]</h2>
<p>The New Relic .NET agent <a href="https://download.newrelic.com/dot_net_agent/latest_release/">download library</a> contains install file packages that are referenced in specific <a href="/docs/agents/net-agent/installation/install-enable-new-relic-net-agent#common-installs">install procedures</a>. For more on these files, see the download library’s <a href="https://download.newrelic.com/dot_net_agent/latest_release/Readme.txt">ReadMe file</a>.</p>
<h2>Zip files for manual .NET agent install (Windows) [#install-zip-file]</h2>
<p>To manually install the agent using a ZIP file, choose the correct file for the application you wish to monitor:</p>
<ol>
  <li>
    <p>Go to the <a href="http://download.newrelic.com/dot_net_agent/latest_release/" title="Link opens in a new window.">.NET agent download site</a> and get the file matching your application's runtime and architecture:</p>
    <ul>
      <li>.NET Framework (32-bit): <code>newrelic-agent-win-x86-VERSION.zip</code></li>
      <li>.NET Framework (64-bit): <code>newrelic-agent-win-x64-VERSION.zip</code></li>
      <li>.NET Core (32-bit): <code>newrelic-netcore20-agent-win-x86-VERSION.zip</code></li>
      <li>.NET Core (64-bit): <code>newrelic-netcore20-agent-win-x64-VERSION.zip</code></li>
    </ul>
  </li>
  <li>
    <p>Unzip the agent folder in the desired location.</p>
  </li>
  <li>
    <p>Set environment variables for the process you wish to monitor.</p>
    <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJjYXV0aW9uIn1d">
      <p>We do not recommend setting these environment variables globally. Setting these environment variables globally can cause all .NET processes running on the system to get instrumented and report to New Relic. If you are installing the agent manually, we expect that you have the means to set these environment variables only for the processes you wish to monitor.</p>
    </div>
    <div data-component="CollapserGroup" data-prop="W10=">
      <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibmV0LWZyYW1ld29yay1lbnYtdmFyaWFibGVzIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiIuTkVUIEZyYW1ld29yayBlbnZpcm9ubWVudCB2YXJpYWJsZXMgZm9yIG1hbnVhbCBpbnN0YWxsIn1d">
        <div data-prop-text="title">.NET Framework environment variables for manual install</div>
        <p>For .NET Framework, the following variables are required:</p>
        <pre><code>COR_ENABLE_PROFILING=1
  COR_PROFILER={71DA0A04-7777-4EC6-9643-7D28B46A8A41}
  NEWRELIC_HOME=path\to\agent\directory
  COR_PROFILER_PATH=path\to\agent\directory\NewRelic.Profiler.dll

</code></pre>
      </div>
      <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibmV0LWNvcmUtZW52LXZhcmlhYmxlcyJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiLk5FVCBDb3JlIGVudmlyb25tZW50IHZhcmlhYmxlcyBmb3IgbWFudWFsIGluc3RhbGwifV0=">
        <div data-prop-text="title">.NET Core environment variables for manual install</div>
        <p>For .NET Core, the following variables are required:</p>
        <pre><code>CORECLR_ENABLE_PROFILING=1
  CORECLR_PROFILER={36032161-FFC0-4B61-B559-F6C5D41BAE5A}
  CORECLR_NEWRELIC_HOME=path\to\agent\directory
  CORECLR_PROFILER_PATH=path\to\agent\directory\NewRelic.Profiler.dll

</code></pre>
      </div>
    </div>
  </li>
  <li>
    <p>Restart your application. If using IIS, restart IIS.</p>
  </li>
</ol>
<p>If your application is receiving traffic, data should appear within a few minutes. If it doesn't, see <a href="https://docs.newrelic.com/docs/agents/net-agent/troubleshooting/no-data-appears-net">No data appears</a>.</p>
<h2>Need for custom instrumentation [#custom-instrumentation]</h2>
<p>After installing a .NET agent, most .NET application frameworks will automatically report data to your New Relic account. (See app framework compatibility: <a href="/docs/agents/net-agent/getting-started/compatibility-requirements-net-framework-agent">.NET Framework</a> | <a href="/docs/agents/net-agent/getting-started/compatibility-requirements-net-core-agent">.NET Core</a>.)</p>
<p>If your .NET application uses an application framework that is <strong>not</strong> automatically instrumented, or if the app has no framework (like a console app), after the install you will need to manually set up instrumentation of your app. Here are the steps to do that:</p>
<ol>
  <li>Follow the relevant <a href="/docs/agents/net-agent/installation/new-relic-net-agent-install-introduction#install-instructions">install instructions</a> for your application and framework.</li>
  <li><a href="/docs/agents/net-agent/custom-instrumentation/introduction-net-custom-instrumentation">Custom instrument</a> your application to define what activity is reported to New Relic.</li>
</ol>
<h2>Install-related environment variables [#env-variables]</h2>
<p>A .NET agent install requires setting environment variables. For some install procedures (like for IIS-hosted .NET applications), these environment variables are set automatically. For other install procedures, you will have to manually set them. To see the required environment variables for both .NET Framework and .NET Core applications, see <a href="/docs/agents/net-agent/configuration/net-agent-configuration#environment-variables">Environment variables</a>.</p>
<p>For installations requiring you to manually set environment variables, you can also set other <a href="/docs/agents/net-agent/configuration/net-agent-configuration">configuration options</a> via environment variables. Here's a look at two that are commonly set:</p>
<ul>
  <li>
    <p><strong>License key</strong>. The environment variable for setting the <a href="/docs/accounts/install-new-relic/account-setup/license-key">New Relic license key</a> is:</p>
    <pre><code>NEW_RELIC_LICENSE_KEY = YOUR_LICENSE_KEY
</code></pre>
    <p>You can also set this in the <a href="/docs/agents/net-agent/configuration/net-agent-configuration#service">newrelic.config file</a> or the <a href="/docs/agents/net-agent/configuration/net-agent-configuration#app-cfg-license-key">app's config file</a>.</p>
  </li>
  <li>
    <p><strong>App name</strong>. Setting a <a href="/docs/agents/manage-apm-agents/app-naming/name-your-application#app-name">meaningful application name</a> is recommended, but you can also set this after install. The environment variable is:</p>
    <pre><code>NEW_RELIC_APP_NAME = YOUR_APP_NAME
</code></pre>
    <p>You can also <a href="/docs/agents/net-agent/configuration/name-your-net-application">set this via the newrelic.config, the app's config file, or the API</a>.</p>
  </li>
</ul>
<h2>Scriptable installers (Windows only) [#scriptable-installer]</h2>
<p>The scriptable installers are ZIP archives containing a PowerShell script for installing the .NET agent. There is a separate zip archive for .NET Framework versus .NET Core.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>We recommend using the MSI installer over the scriptable installer. If you want to automate your install, consider running the MSI installer from the command line.</p>
</div>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZnJhbWV3b3JrLWluc3RhbGxlci1vcHRpb25zIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJTY3JpcHRhYmxlIGluc3RhbGxlciBmb3IgLk5FVCBGcmFtZXdvcmsifV0=">
    <div data-prop-text="title">Scriptable installer for .NET Framework</div>
    <p>To use the scriptable installer to install the .NET agent for a .NET Framework app:</p>
    <ol>
      <li>
        <p>Ensure you have administrator rights for your Windows admin group. For more details on this, see the <a href="https://docs.newrelic.com/docs/agents/net-agent/getting-started/compatibility-requirements-net-framework-agent#user-rights">permissions documentation</a>.</p>
      </li>
      <li>
        <p>Download the scriptable installer package for .NET Framework from the <a href="https://download.newrelic.com/dot_net_agent/latest_release/" title="Link opens in a new window.">download site</a>. By downloading or using one of these packages, you agree to and accept the <a href="https://docs.newrelic.com/docs/licenses/license-information/agent-licenses/net-agent-licenses">license terms</a>.</p>
      </li>
      <li>
        <p>Unzip the package.</p>
      </li>
      <li>
        <p>Open a command shell and navigate into the unzipped package's folder.</p>
      </li>
      <li>
        <p>For a simple install with no options, use this command:</p>
        <pre><code>.\install.cmd -LicenseKey YOUR_LICENSE_KEY
</code></pre>
        <p>To install with one or more additional options, use the format below. See table below for a description of the install options.</p>
        <pre><code>install.cmd -LicenseKey YOUR_LICENSE_KEY [-NoIISReset] [-InstrumentAll] [-InstallPath PATH_TO_INSTALL]
</code></pre>
        <p>If your application is receiving traffic, data should appear within a few minutes. If it doesn't, see <a href="https://docs.newrelic.com/docs/agents/net-agent/troubleshooting/no-data-appears-net">No data appears</a>.</p>
        <div data-component="Table" data-prop="W10=">
          <div>
            <div>
              <div>
                <p>Install options</p>
              </div>
              <div>
                <p>Description</p>
              </div>
            </div>
          </div>
          <div>
            <div>
              <div>
                <p><code>LicenseKey</code></p>
              </div>
              <div>
                <p><strong>Required</strong>. Your <a href="/docs/accounts/install-new-relic/account-setup/license-key">New Relic license key</a>.</p>
              </div>
            </div>
            <div>
              <div>
                <p><code>NoIISReset</code></p>
              </div>
              <div>
                <p>Optional. Use this option to prevent the installer from initiating an IIS reset.</p>
                <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
                  <p>If you use this option, you need to do an IIS reset manually before New Relic starts instrumenting any IIS-hosted applications.</p>
                </div>
              </div>
            </div>
            <div>
              <div>
                <p><code>InstrumentAll</code></p>
              </div>
              <div>
                <p>Optional. By default, the .NET agent will instrument all IIS-hosted applications. Use this option to enable instrumentation of other types of .NET applications.</p>
              </div>
            </div>
            <div>
              <div>
                <p><code>InstallPath</code></p>
              </div>
              <div>
                <p>Optional. Use this option to choose a different installation location. The default install location is <code>C:\Program Files\New Relic</code>.</p>
              </div>
            </div>
          </div>
        </div>
        <p>Uninstalling the agent with the scriptable uninstaller:</p>
        <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
          <p>You can add the <code>Force</code> option to the uninstall script to force an uninstall without prompting to restart IIS.</p>
        </div>
        <p>Execute the following command to uninstall the .NET Framework agent:</p>
        <pre><code>.\uninstall.cmd
</code></pre>
      </li>
    </ol>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY29yZS1pbnN0YWxsZXItb3B0aW9ucyJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiU2NyaXB0YWJsZSBpbnN0YWxsZXIgZm9yIC5ORVQgQ29yZSJ9XQ==">
    <div data-prop-text="title">Scriptable installer for .NET Core</div>
    <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
      <p>Before installing the agent:</p>
      <ul>
        <li>Understand the <a href="https://docs.newrelic.com/docs/agents/net-agent/getting-started/compatibility-requirements-net-core-agent">agent requirements</a>, including the <a href="https://docs.newrelic.com/docs/agents/net-agent/getting-started/compatibility-requirements-net-core-agent#user-rights">permissions requirements</a>.</li>
        <li>Note that admin rights in an elevated shell are required (specifically for selecting a custom log directory and performing an IISReset).</li>
      </ul>
    </div>
    <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJjYXV0aW9uIn1d">
      <p>For security reasons, it is necessary to execute the <code>installAgent.ps1</code> script as shown below, by prepending <code>./</code> to the script filename, rather than by prepending <code>powershell</code> to the script. If you execute the script by prepending <code>powershell</code>, and any of your supplied arguments (e.g. the install path or custom log path) have spaces in them, these arguments will be corrupted, which would lead to the agent being installed to a location other than the intended location, which could be unsecure.</p>
    </div>
    <p>To use the scriptable installer to install the .NET agent for a .NET Core application:</p>
    <ol>
      <li>
        <p>Ensure you have administrator rights for your Windows admin group. For more details on this, see the <a href="https://docs.newrelic.com/docs/agents/net-agent/getting-started/compatibility-requirements-net-core-agent#user-rights">permissions documentation</a></p>
      </li>
      <li>
        <p>Download the .NET Core agent's scriptable installer package from the <a href="https://download.newrelic.com/dot_net_agent/latest_release/" title="Link opens in a new window.">.NET agent download site</a> . By downloading or using one of these packages, you agree to and accept the <a href="https://docs.newrelic.com/docs/licenses/license-information/agent-licenses/net-agent-licenses">license terms</a>.</p>
      </li>
      <li>
        <p>Unzip the package in the desired location.</p>
      </li>
      <li>
        <p>Open a command shell and navigate into the unzipped package's folder.</p>
      </li>
      <li>
        <p>You can install the agent either locally or globally:</p>
        <div data-component="CollapserGroup" data-prop="W10=">
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiaW5zdGFsbGVyLWxvY2FsIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJMb2NhbCBpbnN0YWxsIn1d">
            <div data-prop-text="title">Local install</div>
            <p>For a simple install, with no options, use this command:</p>
            <pre><code>./installAgent.ps1 -destination PATH -installType global -licenseKey YOUR_LICENSE_KEY \
	[-appName "YOUR_APPLICATION_NAME" -logDir "PATH_TO_CUSTOM_LOG_LOCATION"]

</code></pre>
            <pre><code>
./installAgent.ps1 -destination PATH -installType local -licenseKey YOUR_LICENSE_KEY \
	[-appName "YOUR_APPLICATION_NAME" -logDir "PATH_TO_CUSTOM_LOG_LOCATION" -X86 -ResetIIS -Force]

</code></pre>To install with one or more additional options, use the same command with desired options. For option descriptions, see table below.
          </div>
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiaW5zdGFsbGVyLWdsb2JhbCJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiR2xvYmFsIGluc3RhbGwifV0=">
            <div data-prop-text="title">Global install</div>
            <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
              <p>The global install will instrument all .NET Core processes on your system. Only choose the global install if you want all .NET Core processes monitored.</p>
            </div>
            <p>For a simple install with no options, use this command:</p>
            <pre><code>./installAgent.ps1 -destination PATH -installType global -licenseKey YOUR_LICENSE_KEY \
	[-appName "YOUR_APPLICATION_NAME" -logDir "PATH_TO_CUSTOM_LOG_LOCATION"]

</code></pre>
            <pre><code>
./installAgent.ps1 -destination PATH -installType local -licenseKey YOUR_LICENSE_KEY \
	[-appName "YOUR_APPLICATION_NAME" -logDir "PATH_TO_CUSTOM_LOG_LOCATION" -X86 -ResetIIS -Force]

</code></pre>To install with one or more additional options, use the same command with desired options. For option descriptions, see table below.
          </div>
        </div>
        <p>If your application is receiving traffic, data should appear within a few minutes. If it doesn't, see <a href="https://docs.newrelic.com/docs/agents/net-agent/troubleshooting/no-data-appears-net">No data appears</a>.</p>
        <div data-component="Table" data-prop="W10=">
          <div>
            <div>
              <div>
                <p>Install options</p>
              </div>
              <div>
                <p>Description</p>
              </div>
            </div>
          </div>
          <div>
            <div>
              <div>
                <p><code>Destination</code></p>
              </div>
              <div>
                <p><strong>Required</strong>. The location where the agent is installed. This can be an absolute or relative path. Wrapping quotes are required.</p>
              </div>
            </div>
            <div>
              <div>
                <p><code>InstallType</code></p>
              </div>
              <div>
                <p><strong>Required</strong>. Determines whether this is a local (app-specific) or global (system-wide) install.</p>
              </div>
            </div>
            <div>
              <div>
                <p><code>LicenseKey</code></p>
              </div>
              <div>
                <p><strong>Required</strong>. Your <a href="/docs/accounts/install-new-relic/account-setup/license-key">New Relic license key</a>.</p>
              </div>
            </div>
            <div>
              <div>
                <p><code>AppName</code></p>
              </div>
              <div>
                <p>Optional. Sets the default <a href="/docs/agents/net-agent/installation-and-configuration/naming-your-net-application">application name</a> associated with your agent installation.</p>
              </div>
            </div>
            <div>
              <div>
                <p><code>LogDir</code></p>
              </div>
              <div>
                <p>Optional. Sets a custom logging location for the agent. By default, the agent puts the logs directory in the install directory.</p>
              </div>
            </div>
            <div>
              <div>
                <p><code>X86</code></p>
              </div>
              <div>
                <p>Optional. Installs the 32-bit version of the agent rather than the 64-bit version. New Relic <strong>does not recommend</strong> installing the 32-bit version of the agent globally.</p>
              </div>
            </div>
            <div>
              <div>
                <p><code>ResetIIS</code></p>
              </div>
              <div>
                <p>Optional. Performs an <code>iisreset</code> after the installation.</p>
                <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
                  <p>Only use this if your .NET Core app is hosted via an IIS reverse proxy.</p>
                </div>
              </div>
            </div>
            <div>
              <div>
                <p><code>Force</code></p>
              </div>
              <div>
                <p>Optional. Forces the installation process to overwrite a previous install or to install into an existing folder.</p>
                <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJjYXV0aW9uIn1d">
                  <p>This overwrites any configuration customizations. New Relic recommends backing up your configuration file and any custom instrumentation files prior to forcing an over-install.</p>
                </div>
              </div>
            </div>
            <div>
              <div>
                <p><code>Help</code></p>
              </div>
              <div>
                <p>Optional. Displays usage information for this script.</p>
              </div>
            </div>
          </div>
        </div>
      </li>
    </ol>
  </div>
</div>
