
<p>In <a href="/docs/apm/new-relic-apm/getting-started/welcome-new-relic-apm">APM</a>, the <strong>Trace details</strong> tab shows the timing of individual segments in a <a href="/docs/apm/transactions/transaction-traces/transaction-traces">transaction trace</a>. This document describes the sections and features of the <strong>Trace details</strong> tab.</p>
<h2>Trace details page functions [#options]</h2>
<p>
  <img src="./images/trx-trace-details.png" alt="Screenshot showing the transaction trace details screen." title="trx-trace-details.png">
</p>
<p>Go to <strong><a href="https://one.newrelic.com">one.newrelic.com</a> > APM > (select an app) > Monitor > Transactions > (select a transaction trace) > Trace details.</strong></p>
<p>The <strong>Trace details</strong> page displays a table with the timing data for the segments in a transaction, plus additional features and functions:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p><strong>Trace details page</strong></p>
      </div>
      <div>
        <p><strong>Description</strong></p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>Primary trace data, functions</p>
      </div>
      <div>
        <p>The top of each transaction trace UI page shows several primary pieces of data, including the trace time, response time, and, if available, CPU info. Also, sometimes the UI may indicate a <a href="#partial">partial trace</a>.</p>
        <p>Available functions include:</p>
        <ul>
          <li>Delete this trace: When you delete a trace, it cannot be retrieved.</li>
          <li>Track as <a href="/docs/apm/transactions/key-transactions/key-transactions-tracking-important-transactions-or-events">key transaction</a>.</li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p>Duration column</p>
      </div>
      <div>
        <p>The duration of each segment and subsegment is shown as both the number of milliseconds and a percentage of the total transaction time. Especially slow segments are <a href="#colors">color-coded</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Segment column</p>
      </div>
      <div>
        <p>The <strong>Segment</strong> column displays segment names and counts. Fast and repeat calls may be <a href="#rollup">automatically grouped together</a>. Sometimes you may see <a href="#application-code"><strong>Application code</strong></a> as the name of a segment or subsegment.</p>
        <p>To expand segments, use either of the following:</p>
        <ul>
          <li>The <strong>Expand performance problems</strong> button at the top of the page</li>
          <li>The expand and collapse dropdown arrows next to the segments</li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p>Drilldown column</p>
      </div>
      <div>
        <p>The <a href="#drilldown"><strong>Drilldown</strong> column</a> may contain icons that link to additional transaction data, if available.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Timestamp column</p>
      </div>
      <div>
        <p>The <strong>Timestamp</strong> column displays the start time of a segment or subsegment, relative to the start of the transaction. For example, a value of <code>3.150 s</code> indicates that that segment started 3.15 seconds into the transaction.</p>
      </div>
    </div>
  </div>
</div>
<h2>Drilldown options [#drilldown]</h2>
<p>In the <strong>Drilldown</strong> column, icons indicate that additional data is available:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p><strong>Icon</strong></p>
      </div>
      <div>
        <p><strong>Description</strong></p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>
          <img src="./images/icon-database.png" alt="icon-database" title="icon-database"> Database queries
        </p>
      </div>
      <div>
        <p>The database
          <div data-component="Icon" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJuYW1lIiwidmFsdWUiOiJmZS1kYXRhYmFzZSJ9XQ=="></div>icon links to the raw database query for that query segment. Depending on your <a href="/docs/features/configuring-transaction-traces">transaction trace settings</a>, this query can either show as raw data or obfuscated data. If the total time for the segment exceeds the query plan threshold in your settings, the query analysis also will appear, along with a stack trace showing the exact location of the call in your code.
        </p>
      </div>
    </div>
    <div>
      <div>
        <p>
          <img src="./images/icon-parameters.png" alt="icon-search" title="icon-search"> Stack traces
        </p>
      </div>
      <div>
        <p>The magnifying glass
          <div data-component="Icon" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJuYW1lIiwidmFsdWUiOiJmZS1zZWFyY2gifV0="></div>links to stack trace details.
        </p>
      </div>
    </div>
    <div>
      <div>
        <p>
          <img src="./images/icon-webtx.png" alt="icon-web-transaction-app" title="icon-web-transaction-app"> Aggregate transaction details
        </p>
      </div>
      <div>
        <p>This icon indicates that cross application tracing details are not available. However, you can select this icon to view <a href="/docs/apm/applications-menu/monitoring/transactions-page">aggregated transaction information</a> across multiple invocations of the transaction.</p>
      </div>
    </div>
  </div>
</div>
<h2>Color coding of segment duration data [#colors]</h2>
<p>The <strong>Duration</strong> column of the <strong>Trace details</strong> table is color-coded:</p>
<p>
  <img src="./images/icon-alerts-red.png" alt="icon-alerts-red.png" title="Alerts v3: alert icons"> Red: More than 25% of the total transaction time was spent in this segment.
</p>
<p>
  <img src="./images/icon-alerts-yellow.png" alt="icon-alerts-yellow.png" title="Alerts v3: alert icons"> Yellow: More than 5% of the total transaction time was spent in this segment.
</p>
<p>Color-coded durations do not necessarily indicate a problem. Whether the timing is actually a problem depends on what you consider normal and acceptable for your application.</p>
<h2>Application code in traces [#application-code]</h2>
<p>If a segment is listed as <strong>Application code</strong> in the table, it indicates that that section of code was not instrumented. You can use <a href="/docs/apm/other-features/metrics/custom-instrumentation">custom instrumentation</a> to get more detail on that part of the code. Segments will often be listed as <strong>Application code</strong> for <a href="#partial">partial traces</a>.</p>
<h2>Partial traces [#partial]</h2>
<p>For performance reasons, New Relic APM only captures the first 2,000 segments of a transaction trace (900 for Node.js). If a transaction trace exceeds that number of segments, the agent truncates the transaction trace and displays a message at the top of the <strong>Details</strong> page:</p>
<p><code>This is a partial trace.</code></p>
<p>The New Relic APM agents have differing rules for when to truncate segments.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>APM agent</p>
      </div>
      <div>
        <p>Truncate segment rules</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>C SDK</p>
      </div>
      <div>
        <p>Truncates based on segment priority:</p>
        <ul>
          <li>
            <p>The root segment has the highest priority.</p>
          </li>
          <li>
            <p>Segments that have seen distributed tracing activity have second-highest priority.</p>
          </li>
          <li>
            <p>Slow segments have third-highest priority.</p>
            <p>For more information, see the C SDK's documentation about <a href="https://newrelic.github.io/c-sdk/structnewrelic__transaction__tracer__config__t.html"><code>newrelic_transaction_tracer_config_t</code> on GitHub</a>.</p>
          </li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p>Go</p>
      </div>
      <div>
        <p>The segment duration must be greater than the <a href="/docs/agents/go-agent/configuration/go-agent-configuration#txn-tracer-segment-threshold"><code>TransactionTracer.SegmentThreshold</code></a> value set in your Go segment configuration.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Java, .NET, Ruby</p>
      </div>
      <div>
        <p>These agents truncate traces chronologically. For more information, see the transaction tracer documentation for <a href="/docs/agents/java-agent/configuration/java-agent-configuration-config-file#h2-transaction-segments">Java</a>, <a href="/docs/agents/net-agent/configuration/net-agent-configuration#transaction_tracer">.NET</a>, or <a href="/docs/agents/ruby-agent/configuration/ruby-agent-configuration#transaction_tracer">Ruby</a> as applicable.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Node.js</p>
      </div>
      <div>
        <p>The Node.js agent only captures the first 900 segments of a transaction trace. For more information, see <a href="/docs/agents/nodejs-agent/installation-configuration/nodejs-agent-configuration#tx_tracer_config">Node.js transaction tracer configuration</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>PHP</p>
      </div>
      <div>
        <p>Truncates based on segment duration; the slowest 2,000 segments are captured for the trace. For more information, see PHP transaction tracer configuration.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Python</p>
      </div>
      <div>
        <p>Truncates based on segment duration; the slowest 2,000 segments are captured for the trace. For more information, see <a href="/docs/agents/python-agent/configuration/python-agent-configuration#txn-tracer-settings">Python transaction tracer configuration</a>.</p>
      </div>
    </div>
  </div>
</div>
<h2>Segment grouping rules [#rollup]</h2>
<p>Transaction traces that have a lot of segments can be hard to interpret. New Relic helps you by automatically grouping fast and/or repeated method calls into a single segment grouping.</p>
<p>For example, you might see a segment titled <code>7 fast method calls</code>. This means that, because of their fast completion, New Relic assumed these calls were unlikely to be a problem and grouped them together. You can expand that grouping to see the individual segments.</p>
<p>Rules underlying segment grouping include:</p>
<ul>
  <li><strong>Fast calls:</strong> When New Relic detects four or more consecutive segments with a duration of 7.5 ms or less, these are grouped into a single collapsed header.</li>
  <li><strong>Identical calls:</strong> When New Relic detects four or more consecutive identical calls, this usually indicates an N+1 problem. These segments are collapsed. Expanding the collapsed node displays only the first three calls, not all calls.</li>
</ul>
