
<p>In APM, when <a href="/docs/apm/transactions/transaction-traces/introduction-transaction-traces">transaction traces</a> are collected, there may be additional <strong>Slow query</strong> data available on the <a href="/docs/apm/applications-menu/monitoring/databases-slow-queries-page"><strong>Databases</strong></a> page. Let's look at what slow query data is, where to find it, and how to configure it.</p>
<h2>Slow query data samples [#about]</h2>
<p>When <a href="/docs/apm/transactions/transaction-traces/introduction-transaction-traces">transaction traces</a> are reported, the slow queries feature samples the slowest database queries in those traces and reports data about them on the <a href="/docs/apm/applications-menu/monitoring/databases-slow-queries-page"><strong>Databases</strong></a> page. Slow query data can include:</p>
<ul>
  <li>Duration of query segments</li>
  <li>Query/explain plans (if recognized)</li>
  <li><a href="/docs/apm/applications-menu/features/analyze-database-instance-level-performance-issues">Host and instance level details</a> (if supported by agent)</li>
</ul>
<h2>View slow query data [#db_slowsql]</h2>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>To get a high-level overview of all your applications and services, use the <a href="/docs/new-relic-one/use-new-relic-one/ui-data/new-relic-one-entity-explorer">entity explorer</a>.</p>
</div>
<p>To see your slow query data:</p>
<ol>
  <li>Do one of the following:
    <ul>
      <li>Entity explorer: Go to <strong><a href="https://one.newrelic.com">one.newrelic.com</a> > Entity explorer > (select an app) > Monitor > Databases</strong>.</li>
      <li>APM: Go to <strong><a href="https://one.newrelic.com">one.newrelic.com</a> > APM > (select an app) > Monitor > Databases</strong>.</li>
    </ul>
  </li>
  <li>Select a database transaction.</li>
  <li>If available, select any available <a href="#slowsql_details">slow queries</a> listed on the page.</li>
</ol>
<p>If you do not see expected slow query data, follow the <a href="#troubleshooting">troubleshooting tips</a>.</p>
<h2>Configuration [#settings]</h2>
<p>In general, you can configure your slow query settings either of these ways:</p>
<ul>
  <li>Agent configuration</li>
  <li><a href="/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration">Server-side configuration</a> (if available for your agent)</li>
</ul>
<p>Agent configuration gives you more options than server-side configuration does. How you choose to configure slow queries will depend on your own setup and preferences. For more information, see the documentation for the specific agent:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiYy1zZGsifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkMgU0RLIn1d">
    <div data-prop-text="title">C SDK</div>
    <p>You can report slow query traces for SQL databases only. For more information, see <a href="/docs/agents/c-sdk/instrumentation/instrument-your-app-c-sdk#slow-query-datastore">Instrument your application with the C SDK</a>.</p>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZ28ifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkdvIn1d">
    <div data-prop-text="title">Go</div>
    <p>Agent configuration options:</p>
    <ul>
      <li>Enable/disable: <a href="/docs/agents/go-agent/configuration/go-agent-configuration#slow-query"><code>SlowQuery.Enabled</code></a></li>
      <li>Slow query threshold: <a href="/docs/agents/go-agent/configuration/go-agent-configuration#slow-query-threshold"><code>SlowQuery.Threshold</code></a></li>
      <li>For other datastore config options, see <a href="/docs/agents/go-agent/configuration/go-agent-configuration#datastore-tracer">Datastore tracer configuration</a>.</li>
    </ul>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiamF2YSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiSmF2YSJ9XQ==">
    <div data-prop-text="title">Java</div>
    <p>Agent configuration:</p>
    <ul>
      <li>
        <p>Slow query threshold: <a href="/docs/agents/java-agent/configuration/java-agent-configuration-config-file#tt-explain_threshold"><code>explain_threshold</code></a>.</p>
      </li>
      <li>
        <p>For other settings related to slow transactions and queries, see the <a href="/docs/agents/java-agent/configuration/java-agent-configuration-config-file#h2-Transaction-tracer">Transaction tracer config options</a>.</p>
        <p>You can also edit basic slow query settings via <a href="/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration#customize-ssc">server-side configuration</a>.</p>
      </li>
    </ul>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibmV0In0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiIuTkVUIn1d">
    <div data-prop-text="title">.NET</div>
    <p>Agent configuration:</p>
    <ul>
      <li>
        <p>Enable/disable: <a href="/docs/agents/net-agent/configuration/net-agent-configuration#slow_sql"><code>slowSql enabled</code></a></p>
      </li>
      <li>
        <p>Slow query threshold: <a href="/docs/agents/net-agent/configuration/net-agent-configuration#tracer-explainThreshold">explainThreshold</a></p>
      </li>
      <li>
        <p>For other settings related to slow transactions and queries, see the <a href="/docs/agents/net-agent/configuration/net-agent-configuration#transaction_tracer">Transaction tracer config options</a> and the <a href="/docs/agents/net-agent/configuration/net-agent-configuration#datastore_tracer">Datastore tracer options</a>.</p>
        <p>You can also edit basic slow query settings via <a href="/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration#customize-ssc">server-side configuration</a>.</p>
      </li>
    </ul>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibm9kZSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiTm9kZS5qcyJ9XQ==">
    <div data-prop-text="title">Node.js</div>
    <p>Agent configuration:</p>
    <ul>
      <li>
        <p>Enable/disable: <a href="/docs/agents/nodejs-agent/installation-configuration/nodejs-agent-configuration#slow-sql-enabled"><code>enabled</code></a></p>
      </li>
      <li>
        <p>Threshold: <a href="/docs/agents/nodejs-agent/installation-configuration/nodejs-agent-configuration#explain_threshold"><code>explain_threshold</code></a></p>
      </li>
      <li>
        <p>Maximum slow query samples: <a href="/docs/agents/nodejs-agent/installation-configuration/nodejs-agent-configuration#slow-sql-max-samples"><code>max_samples</code></a></p>
      </li>
      <li>
        <p>For other settings related to slow transactions and queries, see the <a href="/docs/agents/nodejs-agent/installation-configuration/nodejs-agent-configuration#tx_tracer_config">Transaction tracer config options</a>.</p>
        <p><a href="/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration">Server-side configuration</a> of slow query data is not possible for the Node.js agent.</p>
      </li>
    </ul>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicGhwIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJQSFAifV0=">
    <div data-prop-text="title">PHP</div>
    <p>Agent configuration:</p>
    <ul>
      <li>
        <p>Enable/disable: <a href="/docs/agents/php-agent/configuration/php-agent-configuration#inivar-tt-slowsql"><code>slow_sql</code></a></p>
      </li>
      <li>
        <p>Threshold: <a href="/docs/agents/php-agent/configuration/php-agent-configuration#inivar-tt-epthreshold"><code>explain_threshold</code></a></p>
      </li>
      <li>
        <p>For other settings related to slow transactions and queries, see the <a href="/docs/agents/php-agent/configuration/php-agent-configuration#inivar-tt-settings">Transaction tracer config options</a>.</p>
        <p><a href="/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration">Server-side configuration</a> is not possible for the PHP agent.</p>
      </li>
    </ul>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicHl0aG9uIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJQeXRob24ifV0=">
    <div data-prop-text="title">Python</div>
    <p>Agent configuration:</p>
    <ul>
      <li>
        <p>Slow query threshold: <a href="/docs/agents/python-agent/configuration/python-agent-configuration#txn-tracer-explain-threshold"><code>explain_threshold</code></a></p>
      </li>
      <li>
        <p>For other settings related to slow transactions and queries, see the <a href="/docs/agents/python-agent/configuration/python-agent-configuration#txn-tracer-settings">Transaction tracer config options</a> and the <a href="/docs/agents/python-agent/configuration/python-agent-configuration#datastore-tracer-settings">Datastore tracer options</a>.</p>
        <p>You can also edit basic slow query settings via <a href="/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration#customize-ssc">server-side configuration</a>.</p>
      </li>
    </ul>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicnVieSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiUnVieSJ9XQ==">
    <div data-prop-text="title">Ruby</div>
    <p>Agent configuration:</p>
    <ul>
      <li>
        <p>Enable/disable: <a href="/docs/agents/ruby-agent/configuration/ruby-agent-configuration#slow_sql-enabled"><code>slow_sql.enabled</code></a></p>
      </li>
      <li>
        <p>Slow query threshold: <a href="/docs/agents/ruby-agent/configuration/ruby-agent-configuration#slow_sql-explain_threshold"><code>slow_sql.explain_threshold</code></a></p>
      </li>
      <li>
        <p>For other settings related to slow transactions and queries, see the <a href="/docs/agents/ruby-agent/configuration/ruby-agent-configuration#transaction_tracer">Transaction tracer config options</a> and the <a href="/docs/agents/ruby-agent/configuration/ruby-agent-configuration#slow_sql">Slow SQL config options</a>.</p>
        <p>If applicable for your application's agent language, you can also edit basic slow query settings by using <a href="/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration#customize-ssc">server-side configuration</a>.</p>
      </li>
    </ul>
  </div>
</div>
<h2>Slow queries metrics [#slowsql_details]</h2>
<p>The slow queries list contains the following metrics:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p><strong>Metric</strong></p>
      </div>
      <div>
        <p><strong>Description</strong></p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>Response time</code></p>
      </div>
      <div>
        <p>The average response time for the statements sampled.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>Sample count</code></p>
      </div>
      <div>
        <p>The number of slow queries identified in the sample.</p>
      </div>
    </div>
  </div>
</div>
<p>To view additional details, select an individual slow query:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p><strong>Metric</strong></p>
      </div>
      <div>
        <p><strong>Description</strong></p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>Start time</code></p>
      </div>
      <div>
        <p>When the stack trace began collecting the data shown.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>Max time</code></p>
      </div>
      <div>
        <p>The maximum time for all similar query statements in the sample.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>Action</code></p>
      </div>
      <div>
        <p>The action or process invoking the query.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>Query</code></p>
      </div>
      <div>
        <p>The query that is being reported as slow. Depending on your configuration, some parts of the query may be obfuscated.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>Stack trace</code></p>
      </div>
      <div>
        <p>Where in the code the statement was called.</p>
      </div>
    </div>
  </div>
</div>
<p>For MySQL, we provide a query analysis, which explains what happened in your query and what you might do to speed it up. Other databases display an explain plan whenever possible.</p>
<h2>Troubleshooting: No slow query data [#troubleshooting]</h2>
<p>If you do not see slow query data, it may be for any of these reasons:</p>
<ul>
  <li>The slow query feature has been disabled.</li>
  <li>The threshold is set to too high a duration and no slow queries are being reported.</li>
  <li>The query obfuscation setting (usually <code>record_sql</code> or similar) may be set to <code>Off</code>.</li>
</ul>
<p>To solve the problem, try adjusting the <a href="#settings">configuration options</a>.</p>
