
<p>Alerts sends out timely notifications when your system is having problems. Sometimes there are notifications you know you don't need to see: You can use <strong>muting rules</strong> to stop being bombarded by messages you don't want.</p>
<p>Once you've spotted the common elements in your unwanted notifications, you can define muting rules that specifically target those elements, while letting other notifications through. Even when a notification is muted, Alerts still gathers data on those violations. Muting rules don't interfere with the alerts process and are applied at the point right before a notification is sent.</p>
<p>You can read more about why we added muting rules <a href="https://blog.newrelic.com/product-news/muting_rules_new_relic_alerts/">in this blog post</a>.</p>
<h2>Manage muting rules [#manage]</h2>
<p>A muting rule condition is the set of individual expressions made up of attributes, operators, and values that define which violations to target for muting.</p>
<p>You can create, enable, disable, and manage muting rules. Go to <strong><a href="https://one.newrelic.com">one.newrelic.com</a></strong>, in the top nav click <strong>Alerts &#x26; AI</strong>, then click <strong>Muting rules</strong>. Muting rules can be enabled or disabled at any time.</p>
<p>Rules can have one of the following statuses:</p>
<ul>
  <li><strong>Active</strong>: Muting is enabled and active.</li>
  <li><strong>Scheduled</strong>: Muting is enabled but not active yet (there's a future schedule).</li>
  <li><strong>Ended</strong>: Muting is enabled, but no longer active (there's no future schedule).</li>
  <li><strong>Inactive</strong>: Muting is disabled.</li>
</ul>
<p>
  <img src="./images/manage_muting_rules.png" alt="Manage muting rules" title="Manage muting rules">
</p>
<p><strong><a href="https://one.newrelic.com">one.newrelic.com</a> > Alerts &#x26; AI > Muting rules</strong>: You can create complex muting rules to target a small or large set of unwanted notifications.</p>
<h2>Create a muting rule [#create]</h2>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>Before creating muting rules, you'll need to <a href="/docs/alerts/new-relic-alerts/configuring-alert-policies/create-edit-or-find-alert-policy">create policies and conditions</a> that generate violation notifications.</p>
</div>
<p>To create a muting rule, click <strong>+ Add a rule</strong> in the <strong>Muting rules</strong> screen. Enter a name and a description for the muting rule, and select the account to which the rule will apply.</p>
<p>Next, build the violation filter. You can use <a href="/docs/alerts/new-relic-alerts/defining-conditions/violation-event-attributes">violation event attributes</a> and <a href="#sub-conditions">sub-condition operators</a>. Values can be compared against one of your violation attributes, such as an Alerts policy ID or a condition name.</p>
<p>
  <img src="./images/violationfilter.png" alt="Muting rule edit screen" title="Muting rule edit screen">
</p>
<p><strong><a href="https://one.newrelic.com">one.newrelic.com</a> > Alerts &#x26; AI > Muting rules</strong>: You can create complex muting rules to target a small or large set of unwanted notifications.</p>
<h2>Schedule a muting rule [#schedule-muting-rule]</h2>
<p>If needed, you can schedule your muting rules.</p>
<p>To do this, select a start time and/or end time. Optionally, you can set the muting rule to last the whole day.</p>
<p>You can also choose to select a time zone for the muting rule schedule. The default is the time zone selected in your user preferences.</p>
<p>
  <img src="./images/Schedule_mute_rule_0.png" alt="Schedule_mute_rule.png" title="Schedule_mute_rule.png">
</p>
<h2>Manage muting rules with NerdGraph [#manage-with-nerdgraph]</h2>
<p>In <a href="/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph">NerdGraph</a>, you can use the following queries and mutations with your muting rules. You can see the schema in more detail in the <a href="https://docs.newrelic.com/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph#explorer">API Explorer</a>.</p>
<ul>
  <li><code>actor.account.alerts.mutingRule</code>: Fetch a muting rule by id.</li>
  <li><code>actor.account.alerts.mutingRules</code>: Fetch a list of muting rules for an account.</li>
  <li><code>alertsMutingRuleCreate</code>: Create a muting rule for an account.</li>
  <li><code>alertsMutingRuleUpdate:</code> Update a muting rule by id and account id.</li>
  <li><code>alertsMutingRuleDelete:</code> Delete a muting rule by id and account id.</li>
</ul>
<p>We've given you some sample queries and mutations <a href="#examples">examples in this document</a>.</p>
<p>A muting rule has the following fields and components:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Muting rule</p>
      </div>
      <div>
        <p>Fields and components</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>id</code></p>
      </div>
      <div>
        <p>The unique identifier for the muting rule.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>name</code> (<strong>Required</strong>)</p>
      </div>
      <div>
        <p>A text field for the user-friendly name of the muting rule. This is used when listing or referencing a rule. We don't require that the name be unique, but it is recommended.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>description</code></p>
      </div>
      <div>
        <p>This is an optional text field describing the muting rule. It can be a useful way to provide more context for your muting rule. This data is only used for management display purposes.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>accountId</code></p>
      </div>
      <div>
        <p>The muting rule's account ID. A muting rule will only affect violations that occur in a single account. To mute violations across multiple accounts, you'll need to create a muting rule for each account separately.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>createdAt</code></p>
      </div>
      <div>
        <p>The timestamp when the muting rule was created (UTC).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>createdBy</code></p>
      </div>
      <div>
        <p>The user ID of the person who created the muting rule.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>updatedAt</code></p>
      </div>
      <div>
        <p>The timestamp when the muting rule was last modified (UTC).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>updatedBy</code></p>
      </div>
      <div>
        <p>The user ID of the person who last modified the muting rule.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>enabled</code></p>
      </div>
      <div>
        <p>Enable or disable the muting rule (Boolean). Muting rules must be manually enabled and disabled.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>condition</code></p>
      </div>
      <div>
        <p>The set of individual expressions that define which violations to target. A muting rule condition has:</p>
        <ul>
          <li>
            <p><code>operator</code>: The boolean operator <code>AND</code> or <code>OR</code> that defines how to combine the set of conditions.</p>
          </li>
          <li>
            <p><code>conditions</code>: The set of individual expressions (sub-conditions) that target attributes within a violation. These are evaluated together based on the <code>operator</code>. You can have a maximum of 20 sub-conditions for a single muting rule.</p>
            <p>A sub-condition has:</p>
          </li>
          <li>
            <p><code>attribute</code>: A single attribute within a violation. Go here for a list of <a href="/docs/alerts/new-relic-alerts/defining-conditions/violation-event-attributes">Violation event attributes</a>.</p>
          </li>
          <li>
            <p><code>operator</code>: The comparison function used to compare the selected violation attribute against values in the condition. Go here for a list of <a href="#sub-conditions">sub-condition operators</a>.</p>
          </li>
          <li>
            <p><code>values</code>: An array of string values to compare against selected violation attributes. When the muting rules evaluate a condition, if necessary, values will be coerced from strings. You can use a maximum of 500 values when using an operator that supports comparison against multiple values, such as <code>IN</code>.</p>
          </li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p><code>schedule</code></p>
      </div>
      <div>
        <p>The time window when the MutingRule should actively mute violations.</p>
        <ul>
          <li><code>startTime</code>: The datetime stamp that represents when the MutingRule should start. This is in local ISO 8601 format without an offset. Example: '2020-07-08T14:30:00'</li>
          <li><code>endTime</code>: The datetime stamp that represents when the MutingRule should end. This is in local ISO 8601 format without an offset. Example: '2020-07-15T14:30:00'</li>
          <li><code>timeZone</code>: The time zone that applies to the muting rule schedule. Example: 'America/Los_Angeles'. See <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">https://en.wikipedia.org/wiki/List_of_tz_database_time_zones</a>.</li>
        </ul>
      </div>
    </div>
  </div>
</div>
<h2>How muting rules work [#overview]</h2>
<p>Muting rules are applied at the end of the default alert lifecycle in order to suppress, or mute, notifications. They don't disable existing policies or conditions. For example, you can mute notifications during known system disruptions, such as maintenance windows and deployments. System disruption violations will still be identified, even though the notifications for those violations are muted.</p>
<p>A muting rule uses a set of conditions that match against attributes in a <a href="/docs/alerts/new-relic-alerts/defining-conditions/violation-event-attributes">violation event</a>. The muting rules tell us how to:</p>
<ol>
  <li>Identify individual violations after they're created, but before an incident is opened.</li>
  <li>Override their default condition to indicate that they should be "muted."</li>
</ol>
<p>Currently, muting a violation means that the normal Alerts incident lifecycle will be maintained, except that an incident that only contains muted violations will not send out any notifications.</p>
<p>Muting rules override specific violations. They don't disable existing policies or conditions. This allows you to mute violations from specific entities that may be covered by a policy or condition that covers a large number of entities. This also keeps you from having to over-mute your monitoring when you are performing maintenance on a subset of your system.</p>
<h2>Muting behavior [#behavior]</h2>
<p>The following table describes how the Alerts incident lifecycle is affected by muted violations:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>IF</p>
      </div>
      <div>
        <p>AND</p>
      </div>
      <div>
        <p>THEN</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><strong>Event</strong>: Incident opens</p>
      </div>
    </div>
    <div>
      <div>
        <p>An incident opens because of a violation that is <strong>not</strong> muted</p>
      </div>
      <div></div>
      <div>
        <p>An “Open incident” notification will be sent (default).</p>
      </div>
    </div>
    <div>
      <div>
        <p>An incident opens due to a violation that <strong>is</strong> muted</p>
      </div>
      <div></div>
      <div>
        <p>An “Open incident” notification will <strong>not</strong> be sent (muted).</p>
      </div>
    </div>
    <div>
      <div>
        <p><strong>Event</strong>: Violation added to an open incident</p>
      </div>
    </div>
    <div>
      <div>
        <p>A new <strong>muted</strong> violation is added to an already open incident</p>
      </div>
      <div></div>
      <div>
        <p>No notification action is triggered (default).</p>
      </div>
    </div>
    <div>
      <div>
        <p>A new <strong>unmuted</strong> violation is added to an open incident</p>
      </div>
      <div>
        <p>An “Open incident” notification <strong>has not</strong> <strong>been sent</strong></p>
      </div>
      <div>
        <p>An “Open incident” notification <strong>will be sent</strong>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>A new <strong>unmuted</strong> violation is added to an open incident</p>
      </div>
      <div>
        <p>An “Open incident” notification <strong>has already been sent</strong></p>
      </div>
      <div>
        <p>No notification action is triggered (default).</p>
      </div>
    </div>
    <div>
      <div>
        <p><strong>Event</strong>: Incident closed</p>
      </div>
    </div>
    <div>
      <div>
        <p>An Incident is closed</p>
      </div>
      <div>
        <p>An “Open incident” notification <strong>has not been sent</strong></p>
      </div>
      <div>
        <p>A “Close incident” notification <strong>will not be sent</strong>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>An Incident is closed</p>
      </div>
      <div>
        <p>An “Open incident” notification <strong>has been sent</strong></p>
      </div>
      <div>
        <p>A “Close incident” notification <strong>will be sent</strong>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><strong>Event</strong>: Incident acknowledged</p>
      </div>
    </div>
    <div>
      <div>
        <p>An Incident is acknowledged</p>
      </div>
      <div>
        <p>An “Open incident” notification <strong>has not been sent</strong></p>
      </div>
      <div>
        <p>An “Incident acknowledged” notification <strong>will not be sent</strong>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>An Incident is acknowledged</p>
      </div>
      <div>
        <p>An “Open incident” notification <strong>has been sent</strong></p>
      </div>
      <div>
        <p>An “Incident acknowledged” notification <strong>will be sent</strong>.</p>
      </div>
    </div>
  </div>
</div>
<h2>View muted violations and incidents [#ui]</h2>
<p>When viewing an open or closed incident, violations and incidents are marked as <code>Muted</code>:</p>
<p>Go to <strong><a href="https://one.newrelic.com">one.newrelic.com</a></strong>, in the top nav click <strong>Alerts &#x26; A</strong>I, then click <strong>Incidents.</strong></p>
<p>
  <img src="./images/muting-rules-incident-violations.png" alt="Alert incident lifecycle: Muting rule violations" title="Alert incident lifecycle: Muting rule violations">
</p>
<p>An incident with a critical violation that's been muted.</p>
<p>Violations and incidents are marked as <strong>Muted</strong> in the <strong>State</strong> column when viewing lists of incidents, violations, or events:</p>
<p>Go to <strong><a href="https://one.newrelic.com">one.newrelic.com</a></strong>, in the top nav click <strong>Alerts &#x26; A</strong>I, click <strong>Incidents</strong>, then click <strong>Open incidents.</strong></p>
<p>
  <img src="./images/muting-rules-open-incidents.png" alt="Alert incident lifecycle: Muting rule incidents" title="Alert incident lifecycle: Muting rule incidents">
</p>
<p>An example of an open incident that triggered the muting rule.</p>
<p>Go to <strong><a href="https://one.newrelic.com">one.newrelic.com</a></strong>, in the top nav click <strong>Alerts &#x26; A</strong>I, then click <strong>Events.</strong></p>
<p>
  <img src="./images/muting-rules-violations_0.png" alt="Alert incident lifecycle: Muting rule critical violations" title="Alert incident lifecycle: Muting rule critical violations">
</p>
<p>An example of a list of violations. The <strong>State</strong> column shows which violations have been muted.</p>
<p>Go to <strong><a href="https://one.newrelic.com">one.newrelic.com</a></strong>, in the top nav click <strong>Alerts &#x26; A</strong>I, click <strong>Events</strong>, then click <strong>All events.</strong></p>
<p>
  <img src="./images/muting-rules-events.png" alt="Alert incident lifecycle: Muting rule events" title="Alert incident lifecycle: Muting rule events">
</p>
<p>An example of a list of alert events. The <strong>State</strong> column shows which events have been muted.</p>
<h2>Use attributes for muting [#violation-event-attributes]</h2>
<p>For an explanation of what attributes (metadata) is available for choosing what violations are muted, see <a href="/docs/alerts/new-relic-alerts/defining-conditions/violation-event-attributes">Violation event attributes</a>.</p>
<h3>Mute faceted results using <code>tag.</code> [#facet-muting]</h3>
<p>To mute results of faceted queries, use the <code>tag.FACETED_ATTRIBUTE</code> attribute, where FACETED_ATTRIBUTE represents the attributed you've run a NRQL <a href="/docs/query-data/nrql-new-relic-query-language/getting-started/nrql-syntax-clauses-functions#sel-facet"><code>FACET</code> query</a> on. For example: if your NRQL alert condition includes <code>FACET host</code> in its query, you can target that <code>FACET</code> attribute using <code>tag.host</code>.</p>
<p>NRQL condition queries can accept multiple facet attributes. If you want to be able to filter from attributes in your events or metric time series that have been aggregated, you must add those attributes to your NRQL query <code>FACET</code> clause; for example: <code>FACET host, region, cluster</code>.</p>
<p>For an example of using <code>tag.</code>, see <a href="#create-rule">Create muting rule</a>.</p>
<h2>Sub-condition operators [#sub-conditions]</h2>
<p>The following are the logical operators available to use to compare attributes when you're constructing muting rules. For examples of these being used, see <a href="/docs/alerts/new-relic-alerts/managing-notification-channels/muting-rules-suppress-notifications#examples">Examples</a>.</p>
<ul>
  <li><code>EQUALS</code>: Where the supplied value equals the violation attribute value.</li>
  <li><code>NOT_EQUALS</code>: Where the supplied value does not equal the violation attribute value.</li>
  <li><code>IN</code>: Where the violation attribute value is present in a list of supplied values (up to 500).</li>
  <li><code>NOT_IN</code>: Where the violation attribute value is not present in a list of supplied values (up to 500).</li>
  <li><code>CONTAINS</code>: Where the supplied value string is present in the violation attribute value.</li>
  <li><code>NOT_CONTAINS</code>: Where the supplied value string is not present in the violation attribute value.</li>
  <li><code>ANY</code>: <strong>Caution:</strong> A condition with this operator will mute <strong>all</strong> violations on the account.</li>
  <li><code>IS_BLANK</code>: Where the violation attribute value is blank. Null, empty string, etc.</li>
  <li><code>IS_NOT_BLANK</code>: Where the violation attribute value is not blank. Null, empty string, etc.</li>
  <li><code>STARTS_WITH</code>: Where the violation attribute value begins with the supplied value string.</li>
  <li><code>NOT_STARTS_WITH</code>: Where the violation attribute value does not begin with the supplied value string.</li>
  <li><code>ENDS_WITH</code>: Where the violation attribute value ends with the supplied value string.</li>
  <li><code>NOT_ENDS_WITH</code>: Where the violation attribute value does not end with the supplied value string.</li>
</ul>
<h2>Muting examples [#examples]</h2>
<p>For more information about making requests to NerdGraph, see the <a href="https://docs.newrelic.com/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph">NerdGraph documentation</a>, including <a href="https://docs.newrelic.com/docs/apis/graphql-api/tutorials">GraphQL tutorials</a>.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZmV0Y2gtbGlzdCJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiRmV0Y2ggbXV0aW5nIHJ1bGVzIGZvciBhY2NvdW50In1d">
    <div data-prop-text="title">Fetch muting rules for account</div>
    <p>To fetch the list of muting rules (with name and condition) for an account:</p>
    <pre><code>{
  actor {
    account(id: YOUR_ACCOUNT_ID) {
      alerts {
        mutingRules {
          name
          condition {
            operator
            conditions {
              attribute
              operator
              values
            }
          }
        }
      }
    }
  }
}

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY3JlYXRlLXJ1bGUifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkNyZWF0ZSBtdXRpbmcgcnVsZSJ9XQ==">
    <div data-prop-text="title">Create muting rule</div>
    <p>To create a muting rule and return the muting rule's <code>id</code> for muting violations from NRQL conditions where host facet is <code>host-1</code>:</p>
    <pre><code>mutation {
  alertsMutingRuleCreate(accountId: YOUR_ACCOUNT_ID, rule: {
    name: "host-1 mute rule",
    description: "Mute host-1 violations",
    enabled: true,
    condition: {
      operator: AND,
      conditions: [{
        attribute: "tag.host",
        operator: EQUALS,
        values: ["host-1"]
      }]
    }
  }) {
    id
  }
}

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicnVsZS1wcm9kdWN0In0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJDcmVhdGUgbXV0aW5nIHJ1bGUgZm9yIHNwZWNpZmljIGhvc3RzIG9yIHByb2R1Y3RzIn1d">
    <div data-prop-text="title">Create muting rule for specific hosts or products</div>
    <p>To create a muting rule and return the muting rule's <code>id</code> for muting violations from Infrastructure conditions where the target host is <code>host-1</code> or the violation was from Synthetic monitoring or Mobile products:</p>
    <pre><code>mutation {
  alertsMutingRuleCreate(accountId: YOUR_ACCOUNT_ID, rule: {
    name: "host-1 and Synthetics/Mobile mute rule",
    description: "Mute host-1 and Synthetics/Mobile violations",
    enabled: true,
    condition: {
      operator: OR,
      conditions: [
        {
          attribute: "targetName",
          operator: EQUALS,
          values: ["host-1"]
        },
        {
          attribute: "product",
          operator: IN,
          values: ["SYNTHETICS", "MOBILE"]
        }
      ]
    }
  }) {
    id
  }
}

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicmVuYW1lIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJSZW5hbWUgYW5kIGRpc2FibGUgbXV0aW5nIHJ1bGUifV0=">
    <div data-prop-text="title">Rename and disable muting rule</div>
    <p>To change the name and disable a muting rule and return its new name:</p>
    <pre><code>mutation {
  alertsMutingRuleUpdate(accountId: YOUR_ACCOUNT_ID, id: MUTING_RULE_ID, rule: {
    name: "updated name",
    enabled: false
  }) {
    name
  }
}

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZGVsZXRlLXJ1bGUifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkRlbGV0ZSBtdXRpbmcgcnVsZSJ9XQ==">
    <div data-prop-text="title">Delete muting rule</div>
    <p>To delete a muting rule:</p>
    <pre><code>mutation {
 alertsMutingRuleDelete(accountId: YOUR_ACCOUNT_ID, id: MUTING_RULE_ID) {
    id
  }
}

</code></pre>
  </div>
</div>
