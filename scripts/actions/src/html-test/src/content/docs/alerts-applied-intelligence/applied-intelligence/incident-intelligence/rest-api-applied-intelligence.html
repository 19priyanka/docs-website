
<p>The incident events API allows you to report any related activities from your own proprietary incident management systems for advanced correlation and reasoning. The API is designed in a generic way with minimal required attributes and flexibility to keep native keys and values of your incident events.</p>
<p>The more information your system can provide, the better our decision engine works to surface more relevant information to you. Use the attributes field to push your specific information in addition to the required fields.</p>
<h2>Authentication</h2>
<p>The REST API supports secure token-based authentication and accepts JSON content as input. To get your secure token, go to <strong><a href="https://one.newrelic.com">one.newrelic.com</a></strong>, click <strong>Alerts &#x26; AI</strong>, in the left nav under <strong>Incident Intelligence</strong> click <strong>Sources</strong>, then click <strong>REST API</strong>.</p>
<p>Your user account must have permissions to manage Sources to get a secure token.</p>
<h3>Batching data</h3>
<p>We currently support up to 10 events in the same API call. In order to batch, just append new event data to the body.</p>
<p>A batch must be POSTed as <code>{"events": [{"event_source": "Snap", ...}]}</code> with each event part in a list that is the value of "events", as the following sample shows.</p>
<p><strong>Sample JSON</strong></p>
<pre><code>{
    "events": [{
        "application": "Name of my application",
        "attributes": {
            "alert/description": "Add a description about the alert itself",
            "state": "alarm",
            "application/state": "MAJOR",
            "environment": "prod"
        },
        "event_description": "Add a description about the incident",
        "event_source": "List the application that created the incident",
        "host": "host-name",
        "value": "medium"
    }]
}
</code></pre>
<p>Our collector will first check to see if <code>events</code> is the key in the root object and if so, extract and iterate.</p>
<h3>Default data size limits [#size-limits]</h3>
<ul>
  <li>Batch – up to 10 messages inside the body.</li>
  <li>We support up to 20 attributes per metric or event.</li>
  <li>Each string value field size is limited to 1024 characters.</li>
  <li>Each attribute name field size is limited to 128 characters.</li>
</ul>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>If you have different requirements for data size/restrictions please contact us as those parameters can be tuned for you.</p>
</div>
<h3>Make API calls [#get-started]</h3>
<p>On the Incident Intelligence <strong>Sources</strong> page, click <strong>REST API</strong>. Choose the correct account and click on the clipboard icon to copy the collector URL. The security token should be used in the <strong>Authorization: Bearer HTTP</strong> header.</p>
<p>Here is an example curl command using this interface:</p>
<pre><code>curl -L -X POST 'https://collectors.signifai.io/v1/incidents' -H 'Authorization: Bearer XXXXXXXXX' -H 'Content-Type: application/json' --data-raw '{"application": "A Unique App Name","attributes": {"alert/description": "The health check end-point is failing for A Unique App Name","annotations/description": "Health check failure","cluster/name": "auan_001","datacenter/name": "US-EAST-1","health_check/entity_name": "a-unique-app-name","service/name": "a-unique-app-name","service/status": "down","state": "alarm","label/namespace": "use labels to control how events aggregate into incidents"},"event_description": "Something in the health check failed for A Unique App Name","event_source": "my-rest-api","value": "critical"}'
</code></pre>
<h2>API specifications</h2>
<h3>Available methods</h3>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Method</p>
      </div>
      <div>
        <p>API Endpoint</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>POST</p>
      </div>
      <div>
        <p><code>https://collectors.signifai.io/v1/incidents</code></p>
      </div>
      <div>
        <p>Sends incident events to Applied Intelligence for processing.</p>
      </div>
    </div>
  </div>
</div>
<h3>Available fields</h3>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Field</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>event_source</code></p>
        <p><em>String</em></p>
      </div>
      <div>
        <p><strong>REQUIRED</strong>. Your own representation for the system or application that is generating the event.</p>
        <p><strong>Example</strong>: <code>{"event_source": "sensu"}</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><code>host|service|application</code></p>
        <p><em>String</em></p>
      </div>
      <div>
        <p><strong>REQUIRED</strong>. What generated the event. Can be the associated host or, if a host isn't relevant, a service or an application. Note: only one is required.</p>
        <p><strong>Example</strong>: <code>{"host": "payments001"}</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><code>value</code></p>
        <p><em>String, Boolean (only <code>true</code> is supported)</em></p>
      </div>
      <div>
        <p><strong>REQUIRED</strong>. Incident priority. String must be one of: <code>critical</code>, <code>high</code>, <code>medium</code>, <code>low</code><br>Use a boolean to indicate an event happened</p>
        <p><strong>Example</strong>: <code>{"value": "high"}</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><code>timestamp</code></p>
        <p><em>Long</em></p>
      </div>
      <div>
        <p>Epoch time in seconds (UTC) that the event occurred. <strong>Negative timestamps are not supported.</strong></p>
        <p>Default: the time our server receives the event</p>
        <p><strong>Example</strong>: <code>{"timestamp": 1591302334}</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><code>event_description</code></p>
        <p><em>String</em></p>
      </div>
      <div>
        <p><strong>REQUIRED</strong>. Free text information that describes this event. We recommend describing what happened on which entity. This is used in various places in the UI. <strong>This attributes is required.</strong></p>
        <p><strong>Example</strong>: <code>{"event_description": "Response time is > 2 seconds for the last 10min on [Production] Storefront"}</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><code>attributes</code></p>
        <p><em>JSON Object</em></p>
      </div>
      <div>
        <p>This is a flat key/value mapping of additional attributes about the incident event. We recommend putting as much information and meta data as you can here.</p>
        <p>Any attributes added here will be used to perform better correlations.</p>
        <p>Labels are defined within the attributes object. Labels allow you to control how the de-duplication step works for your events. See <a href="#de-duplication">De-duplication and identification</a> below.</p>
        <p><strong>Example</strong>:</p>
        <p><code>{"attributes": {</code></p>
        <p><code>"affected_cluster": "cluster foo",</code></p>
        <p><code>"team": "SRE Infra Team",</code></p>
        <p><code>"environment": "production"</code></p>
        <p><code>}}</code></p>
      </div>
    </div>
  </div>
</div>
<h2>De-duplication and identifications [#de-duplication]</h2>
<p>To better support our system’s advanced de-duplication and correlation capabilities, we recommend supplying a set of labels or an alert ID, as part of the incident’s <code>attributes</code>.</p>
<p>Any attribute prefixed with <code>label/</code> is considered as a label.</p>
<p>The combination of the labels, <code>event_source</code>, <code>host</code>, <code>application</code>, and <code>server</code> are used to create unique incidents. If labels are not provided, provide an <code>alert/id</code> attribute to be used as a de-duplication key.</p>
<h2>Significant incident attributes (hints) [#hint-attributes]</h2>
<p>Some attributes have enhanced capabilities. Sending these allows us to process the data more intelligently.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Attribute name</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>alert/description</code></p>
      </div>
      <div>
        <p>Additional details that describe what happened.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>alert/id</code></p>
      </div>
      <div>
        <p>Alert identification - used to deduplicate incidents.</p>
        <p>Every incident that is received with the same <code>alert/id</code> will be aggregated to the same open incident.</p>
        <p><strong>Important</strong>: Specifying <code>alert/id</code> manually will deactivate New Relic's automatic creation of an alert ID using the defined labels.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>alert/metric_name</code></p>
      </div>
      <div>
        <p>Metric name that triggered the incident.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>alert/policy_id</code></p>
      </div>
      <div>
        <p>Policy id of the alert.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>alert/policy_name</code></p>
      </div>
      <div>
        <p>Policy name of the alert.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>annotations/description</code></p>
      </div>
      <div>
        <p>The incident description that will be used for representation in the UI.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>application/id</code></p>
      </div>
      <div>
        <p>Instrumented application identifier.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>application/name</code></p>
      </div>
      <div>
        <p>Instrumented application name assigned from the application field in the payload.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>availability_zone</code></p>
      </div>
      <div>
        <p>Instrumented incident availability zone.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>cloud/region</code></p>
      </div>
      <div>
        <p>Region hosting the service (for example: us-east-1).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>cluster/name</code></p>
      </div>
      <div>
        <p>Identify the cluster name impacted.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>datacenter/name</code></p>
      </div>
      <div>
        <p>Identify the datacenter name impacted.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>environment</code></p>
      </div>
      <div>
        <p>Environment kind (dev, prod).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>health_check/entity_name</code></p>
      </div>
      <div>
        <p>The name of the health check originally triggered the incident if available.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>health_check/id</code></p>
      </div>
      <div>
        <p>Health check identification.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>health_check/name</code></p>
      </div>
      <div>
        <p>Health check name.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>health_check/probe_id</code></p>
      </div>
      <div>
        <p>Identification of the probe id used for health check.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>health_check/probe_name</code></p>
      </div>
      <div>
        <p>Name of the probe name used for health check.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>health_check/type</code></p>
      </div>
      <div>
        <p>Health check type.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>host/name</code></p>
      </div>
      <div>
        <p>Instrumented host's name assigned from the host field in the payload.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>instance/name</code></p>
      </div>
      <div>
        <p>Instrumented instance name.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>instance/type</code></p>
      </div>
      <div>
        <p>Instrumented instance type.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>label/*</code></p>
      </div>
      <div>
        <p>Any attribute prefixed with <code>label/</code> will be considered as part of the incident de-duplication key and will be used to identify the incident.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>organization/name</code></p>
      </div>
      <div>
        <p>Organization name (in cases there are more than one).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>runbook_url</code></p>
      </div>
      <div>
        <p>In case there is a link for a runbook.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>service/name</code></p>
      </div>
      <div>
        <p>Service name that reported the incident. Assigned from the service field in the payload.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>service/status</code></p>
      </div>
      <div>
        <p>Instrumented service status.<br>Can be either <code>up</code> or <code>down</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>state</code></p>
      </div>
      <div>
        <p>Indicates what state the event is in. Acceptable values are: <code>alarm</code> and <code>ok</code>.</p>
        <p>The default value is <code>alarm</code> if state is not provided which will create an incident or update an existing incident with the same <code>labels</code> or <code>alert/id</code>.</p>
        <p>If the value is <code>ok</code> this will close the open incident with the same <code>labels</code> or <code>alert/id</code>.</p>
      </div>
    </div>
  </div>
</div>
