
<p>With Applied Intelligence's Proactive Detection, you can be notified of unusual app behavior and access an automatic analysis of this unusual behavior. You can have notifications for anomalies delivered in Slack, or you can set up a webhook to deliver messages when you need them. These events are automatically available in NRDB for dashboarding, alerting, and integration with Incident Intelligence.</p>
<h2>Why it matters</h2>
<p>With Proactive Detection, Applied Intelligence delivers insights about anomalies in your production system, along with an automatic analysis of the anomaly. When an anomaly is detected, you can view it in an overview of anomalies, or we'll send notifications directly to your Slack channel or a webhook.</p>
<h2>How it works</h2>
<p>Proactive Detection uses the following methods to detect anomalies in your app data:</p>
<ol>
  <li>Proactive Detection monitors metric data reported by an APM agent, building a model of your typical application dynamics, and focuses on key golden signals: throughput, response time, and errors.</li>
  <li>If one of these golden signals shows anomalous behavior, the system flags it and tracks recovery to normal behavior.</li>
  <li>The system adapts to changes in your data, and continuously updates models based on new data.</li>
</ol>
<p><strong>Receiving notifications:</strong> We send notifications when we detect anomalous changes in throughput, error rate, or response time. The notifications are sent to selected Slack channels, or sent via webhook. When the anomaly goes back to normal, a recovery message is sent. If you don't want to receive notifications, you can choose to just save the events to NRDB.</p>
<p><strong>Anomaly analysis:</strong> For each anomaly, we provide a link in Slack to an analyze anomaly page. This page generates automatic insights into the anomaly. The page is also available from the anomaly overview page, which lists all recent anomalies. This page uses your existing APM and Proactive Detection data to provide explanations as to the cause of the anomaly.</p>
<p><strong>Activity stream:</strong> Inside the activity stream on the New Relic One homepage and the APM Summary page you will see relevant anomalies for applications that you've configured with Proactive Detection. Clicking on any of the anomaly events in the activity stream will bring up the analysis page for that anomaly.</p>
<p>Applications will not always generate anomalies, so it can be normal to not receive any detections.</p>
<h2>Requirements</h2>
<p>To use Proactive Detection, ensure you have:</p>
<ul>
  <li>An APM agent installed on applications to monitor</li>
  <li>To receive notifications in Slack, you'll need to ask your IT administrator to install the Applied Intelligence application into <a href="https://slack.com/help/articles/202035138-Add-an-app-to-your-workspace">your Slack workspace</a>.</li>
</ul>
<p>For more details, see <a href="#data-limits">Data limits</a>.</p>
<h2>Set up Proactive Detection [#set-up]</h2>
<p>You can configure this feature in the Proactive Detection UI:</p>
<ol>
  <li>
    <p>Go to <strong><a href="https://one.newrelic.com">one.newrelic.com</a></strong>, in the top nav click <strong>Alerts &#x26; AI</strong>, then click <strong>Proactive Detection</strong> to go to <strong>Configuration</strong>.</p>
  </li>
  <li>
    <p>Click <strong>Add a configuration</strong>.</p>
  </li>
  <li>
    <p>Input the following information into the form:</p>
    <ul>
      <li>Choose a name for your configuration that helps you easily identify it from others in your account.</li>
      <li>Select an account.</li>
      <li>Select up to 1,000 applications. Note that certain applications with low throughput might not be good candidates for Proactive Detection, as they can be more sensitive to smaller amounts of data fluctuation.</li>
    </ul>
  </li>
  <li>
    <p>Select the golden signals you would like to monitor for anomalies.</p>
  </li>
</ol>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoic2xhY2stc2V0LXVwIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJTZXQgdXAgZm9yIFNsYWNrIn1d">
    <div data-prop-text="title">Set up for Slack</div>
    <p>To use Proactive Detection with Slack:</p>
    <ol>
      <li>
        <p>Select <strong>Slack</strong>.</p>
      </li>
      <li>
        <p>Choose which Slack channel receives notifications. You can select any existing public or private channel. This prompts the workflow to add the Applied Intelligence Slack application to your selected channel. To create a new channel, do that directly in Slack first.</p>
        <ul>
          <li>
            <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
              <p>If you experience an error when assigning Slack channels, make sure that the New Relic AI Slack application has been <a href="https://slack.com/help/articles/202035138-Add-an-app-to-your-workspace">added to your Slack workspace</a>.</p>
            </div>
          </li>
        </ul>
      </li>
      <li>
        <p>Save the configuration.</p>
        <p>You can modify the applications for each configuration at any time by selecting the configuration in the configuration table.</p>
      </li>
    </ol>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY29uZmlndXJlLXdlYmhvb2tzIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJTZXQgdXAgZm9yIHdlYmhvb2tzIn1d">
    <div data-prop-text="title">Set up for webhooks</div>
    <p>To use Proactive Detection with webhooks:</p>
    <ol>
      <li>
        <p>Select <strong>Webhook</strong>.</p>
      </li>
      <li>
        <p>Input the following information into the form:</p>
        <ul>
          <li>Provide the webhook URL.</li>
          <li>Provide optional custom headers.</li>
          <li>Choose to edit the custom payload, or enable using the default payload.</li>
        </ul>
      </li>
      <li>
        <p>Save the configuration.</p>
        <p>You can modify the applications for each configuration at any time by selecting the configuration in the configuration table.</p>
      </li>
    </ol>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibm8tbm90aWZpY2F0aW9ucyJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiU2V0IHVwIHdpdGhvdXQgbm90aWZpY2F0aW9ucyJ9XQ==">
    <div data-prop-text="title">Set up without notifications</div>
    <p>To use Proactive Detection when you don't need to receive notifications:</p>
    <ol>
      <li>
        <p>Select <strong>No notifications</strong>.</p>
      </li>
      <li>
        <p>Save the configuration.</p>
        <p>You can modify the applications for each configuration at any time by selecting the configuration in the configuration table.</p>
      </li>
    </ol>
  </div>
</div>
<h2>Mute notifications (Slack only) [#mute-notifications]</h2>
<p>In Slack, detections coming from specific applications can be muted temporarily or permanently. The entire channel can also be muted temporarily. This is useful in the case of an incident or when the channel should otherwise not be interrupted.</p>
<p>To mute in Slack, select <strong>Mute this app’s warnings</strong> or <strong>Mute all warnings</strong>, then select the duration. We will resume sending notifications for any detections once the muting duration has completed.</p>
<p>Muting an application permanently removes it from the configuration. To add it back in, go to <strong><a href="https://one.newrelic.com">one.newrelic.com</a></strong>, in the top nav click <strong>Alerts &#x26; AI</strong>, then click <strong>Proactive Detection</strong>, and select the configuration to edit.</p>
<p>Muting Proactive Detection notifications does not affect alerts.</p>
<h2>Use Proactive Detection Slack messages [#feedback]</h2>
<p>Each anomaly message has several key pieces of information you can use to learn more about and start troubleshooting the potential issue:</p>
<ul>
  <li>The application name and a link to more information about it in New Relic One.</li>
  <li>The metric experiencing an anomaly and a link to its details in New Relic One.</li>
  <li>A graph of the metric over time to provide a visual understanding of the anomaly’s behavior and degree.</li>
  <li>An <strong>Analyze</strong> button that navigates to an analysis page in Applied Intelligence that identifies key attributes that are unique to the anomaly, anomalies found upstream or downstream, and any other relevant signals.</li>
</ul>
<p>Once an anomaly has returned to normal, we send a recovery notification with the option to provide feedback. Your feedback provides our development team with input to help us improve detection quality. In the case of feedback provided on throughput anomalies, an evaluation is run each hour based on feedback to fit a more suitable model. If we helped you, you can select <strong>Yes</strong> or <strong>No</strong>.</p>
<h2>View Anomaly overview UI [#anomaly-overview]</h2>
<p>In addition to notifications for anomalies that give you information via Slack or webhook, Proactive Detection also includes a UI view with more information about the anomalies in your environment. This provides a list of all the recent anomalies from every configuration in the selected account. You can also select each anomaly to view a detailed analysis.</p>
<h2>Use anomaly events with NRDB [#anomaly-events]</h2>
<p>Once you configure Proactive Detection, anomaly events will be sent to New Relic’s database (NRDB). You can query NRDB for Proactive Detection anomaly events and use them in conjunction with other Applied Intelligence tools.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY3JlYXRlLWN1c3RvbS1kYXNoYm9hcmQifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IlF1ZXJ5IGZvciBQcm9hY3RpdmUgRGV0ZWN0aW9uIGV2ZW50cyBmcm9tIE5SREIifV0=">
    <div data-prop-text="title">Query for Proactive Detection events from NRDB</div>
    <p>You can use NRQL to query NRDB for any Proactive Detection events recorded over the previous 7 days:</p>
    <p><code>FROM ProactiveDetection SELECT *</code></p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Attribute</p>
          </div>
          <div>
            <p>Description</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p><code>anomaly.deliveredAt</code></p>
            <p><em>Number</em></p>
          </div>
          <div>
            <p>The time at which the anomaly event was initially recorded, in epoch milliseconds.</p>
            <p>Example: <code>1584366819000</code></p>
          </div>
        </div>
        <div>
          <div>
            <p><code>anomaly.description</code></p>
            <p><em>String</em></p>
          </div>
          <div>
            <p>A brief description of the anomaly event.</p>
            <p>Example: <code>Non-web throughput has returned to normal</code></p>
          </div>
        </div>
        <div>
          <div>
            <p><code>anomaly.endedAt</code></p>
            <p><em>String</em></p>
          </div>
          <div>
            <p>The time at which the anomalous period ended, in epoch milliseconds.</p>
            <p>Example: <code>1584366819000</code></p>
          </div>
        </div>
        <div>
          <div>
            <p><code>anomaly.startedAt</code></p>
            <p><em>Number</em></p>
          </div>
          <div>
            <p>The time at which the anomalous period began, in epoch milliseconds.</p>
            <p>Example: <code>1584366819000</code></p>
          </div>
        </div>
        <div>
          <div>
            <p><code>anomaly.type</code></p>
          </div>
          <div>
            <p>The type of data that was analyzed, including <code>error_rate</code>, <code>response_time.web</code>, <code>response_time.non_web</code>, <code>throughput.web</code>, or <code>throughput.non_web</code>.</p>
          </div>
        </div>
        <div>
          <div>
            <p><code>anomaly.status</code></p>
          </div>
          <div>
            <p>The state of the anomaly as the NRDB event is inserted, including <code>open</code> or <code>close</code>.</p>
          </div>
        </div>
        <div>
          <div>
            <p><code>anomaly.uuid</code></p>
          </div>
          <div>
            <p>A unique identifier for the NRDB anomaly event.</p>
            <p>Example: <code>4ee3b908-d323-4677-94c8-339762c931bc</code></p>
          </div>
        </div>
        <div>
          <div>
            <p><code>anomaly.id</code></p>
          </div>
          <div>
            <p>ID of the anomaly associated with the event.</p>
            <p>Example: <code>56341b5608bf68e1</code></p>
          </div>
        </div>
        <div>
          <div>
            <p><code>entity.accountId</code></p>
            <p><em>Number</em></p>
          </div>
          <div>
            <p>The ID of the account for the entity.</p>
          </div>
        </div>
        <div>
          <div>
            <p><code>entity.domain</code></p>
            <p><em>Enum</em></p>
          </div>
          <div>
            <p>The domain for the entity.</p>
            <p>Example: <code>APM</code></p>
          </div>
        </div>
        <div>
          <div>
            <p><code>entity.domainId</code></p>
            <p><em>String</em></p>
          </div>
          <div>
            <p>The id used to uniquely identify the entity within the domain.</p>
          </div>
        </div>
        <div>
          <div>
            <p><code>entity.guid</code></p>
            <p><em>String</em></p>
          </div>
          <div>
            <p>The guid used to uniquely identify the entity across all products.</p>
          </div>
        </div>
        <div>
          <div>
            <p><code>entity.name</code></p>
            <p><em>String</em></p>
          </div>
          <div>
            <p>The name of the entity.</p>
            <p>Example: <code>Laura's coffee service</code></p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<h2>Send Proactive Detection events to Incident Intelligence [#send-events]</h2>
<p>You can send Proactive Detection events to Incident Intelligence to be processed and correlated with other activity in your system:</p>
<ol>
  <li>Create an <a href="/docs/alerts/new-relic-alerts/defining-conditions/create-alert-conditions-nrql-queries">alert condition for your NRQL query</a> that pulls proactive detection events from NRDB.</li>
  <li>Configure a new incident intelligence <a href="/docs/new-relic-one/use-new-relic-one/new-relic-ai/get-started-incident-intelligence#configure-source-nr-alerts">source for your condition</a>.</li>
  <li>(Optional) Create <a href="/docs/new-relic-one/use-new-relic-one/new-relic-ai/get-started-incident-intelligence#decisions">Decision logic</a> to correlate future anomalies with related events.</li>
</ol>
<h2>Webhook payload and examples [#webhook]</h2>
<p>Proactive Detection sends the event body in JSON format via HTTPS POST. The system expects the endpoint to return a successful HTTP code (2xx). If you use webhooks to configure Proactive Detection, use these examples of the webhook body format and JSON schema.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Attribute</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>category</code></p>
        <p><em>Enum</em></p>
      </div>
      <div>
        <p>The category of data that was analyzed.</p>
        <p>Categories include web throughput, non-web throughput, web transactions, non-web transactions, and error class.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>data</code></p>
        <p><em>List</em></p>
      </div>
      <div>
        <p>The time series data leading up to the detection.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>data[].timestamp</code></p>
        <p><em>Number</em></p>
      </div>
      <div>
        <p>The timestamp of the data point in epoch milliseconds.<br>Example: 1584366819000</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>data[].unit</code></p>
        <p><em>String</em></p>
      </div>
      <div>
        <p>The unit describing the value of the data point.</p>
        <p>Data units include <code>count</code>, <code>milliseconds</code>, and <code>error_rate</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>data[].value</code></p>
        <p><em>Number</em></p>
      </div>
      <div>
        <p>The value of the data point.</p>
        <p>Example: 1.52</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>detectionType</code></p>
        <p><em>Enum</em></p>
      </div>
      <div>
        <p>The type of data that was analyzed.</p>
        <p>Types include <code>latency</code>, <code>throughput</code>, and <code>error_rate</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>entity</code></p>
        <p><em>Object</em></p>
      </div>
      <div>
        <p>The entity that reported the unusual data.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>entity.accountId</code></p>
        <p><em>Number</em></p>
      </div>
      <div>
        <p>The ID for the entity's account.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>entity.domain</code></p>
        <p><em>Enum</em></p>
      </div>
      <div>
        <p>The domain for the entity.</p>
        <p>Example: APM</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>entity.domainId</code></p>
        <p><em>String</em></p>
      </div>
      <div>
        <p>The id used to uniquely identify the entity within the domain.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>entity.guid</code></p>
        <p><em>String</em></p>
      </div>
      <div>
        <p>The guid used to uniquely identify the entity across all products.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>entity.name</code></p>
        <p><em>String</em></p>
      </div>
      <div>
        <p>The name of the entity.</p>
        <p>Example: <code>Laura’s coffee service</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><code>entity.link</code></p>
        <p><em>String</em></p>
      </div>
      <div>
        <p>A link to view the entity. Example:</p>
        <pre><code>https://rpm.newrelic.com/accounts/YOUR_ACCOUNT_ID/applications/987654321”

</code></pre>
      </div>
    </div>
    <div>
      <div>
        <p><code>severity</code></p>
        <p><em>Enum</em></p>
      </div>
      <div>
        <p>A description of how unusual of a change occurred, including <code>NORMAL</code>, <code>WARNING</code>, or <code>CRITICAL</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>version</code></p>
        <p><em>String</em></p>
      </div>
      <div>
        <p>Version used to describe the data being provided.</p>
        <p>Example: v1</p>
      </div>
    </div>
  </div>
</div>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoianNvbi1leGFtcGxlLXNjaGVtYSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiSlNPTiBzY2hlbWEgZXhhbXBsZSJ9XQ==">
    <div data-prop-text="title">JSON schema example</div>
    <p>Applied Intelligence will send the event body in JSON format via HTTPS POST. The system expects the endpoint to return a successful HTTP code (2xx).</p>
    <p>Template:</p>
    <pre><code>{
  "version": "{{version}}", 
  "entity": {
    "type": "{{entity.type}}",
    "name": "{{entity.name}}",
    "link": "{{entity.link}}",
    "entityGuid": "{{entity.entityGuid}}",
    "domainId": "{{entity.domainId}}",
    "domain": "{{entity.domain}}",
    "accountId": {{entity.accountId}}
  },
  "detectionType": "{{detectionType}}",
  "category": "{{category}}",
  "data": [{{#each data}}
    {
      "value": {{value}},
      "unit": "{{unit}}",
      "timestamp": {{timestamp}}
    }
    {{#unless @last}},{{/unless}}
  {{/each}}]
}

</code></pre>
    <pre><code>
{
  "version": "v1", 
  "entity": {
    "type": "APPLICATION",
    "name": "My Application",
    "link": "https://rpm.newrelic.com/accounts/ACCOUNT_ID/applications/123",
    "entityGuid": "foo",
    "domainId": "123",
    "domain": "APM",
    "accountId": YOUR_ACCOUNT_ID
  },
  "detectionType": "metric",
  "category": "web throughput",
  "severity": "CRITICAL",
  "data": [
    {
      "value": 100,
      "unit": "count",
      "timestamp": 1584047560917
    }
    ,

    {
      "value": 99,
      "unit": "count",
      "timestamp": 1584047620917
    }
    ,

    {
      "value": 0,
      "unit": "count",
      "timestamp": 1584047680917
    }
  ]
}

</code></pre>Sample payload:
  </div>
</div>
<h2>Data limits</h2>
<p>In addition to <a href="#requirements">requirements</a>, data limits include:</p>
<ul>
  <li>APM app transactions per month: up to 100 million included free</li>
  <li>Monitored APM applications: limited to 1,000 per configuration</li>
  <li>Slack configurations: limited to 200 per account</li>
  <li>Webhook configurations: limited to 200 per account</li>
  <li>Configurations without notifications: limited to 200 per account</li>
</ul>
