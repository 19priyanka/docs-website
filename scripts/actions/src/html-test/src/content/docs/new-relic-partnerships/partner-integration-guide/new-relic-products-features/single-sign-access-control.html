
<p>New Relic supports Single Sign On (SSO) as a convenience for partner customers. Partners implementing SSO also have the option to restrict access by requiring customers to access New Relic via the partner's management site or product login.</p>
<p>Single Sign On is a convenience for your customers, eliminating the requirement of entering sign on credentials multiple times, and it creates a more unified experience for the user. In situations where this distinction is desired, SSO is recommended. Where it is desirable to maintain a distinction between the services or where technical considerations preclude implementing SSO, a fully functioning integration is still achievable.</p>
<h2>Implement Single Sign On [#implementation]</h2>
<p>Two methods for SSO are supported by New Relic. New Relic upgraded its single sign on system during 2011. If you implemented single sign on with New Relic prior to September 2011, you will have used the old system. That method of implementing SSO has been deprecated.</p>
<p>All new integrations must use the new system. Existing implementations using the old system will continue to work indefinitely. However, we encourage all partners using the old system to upgrade to the new model.</p>
<h2>Use shared secret method [#shared-secret]</h2>
<p>The upgraded shared secret version of New Relic's SSO implementation offers several improvements over the old handshake version. Most important, the system is more secure. Security is enhanced by the use of passing a SHA1 digest of a shared secret, a timestamp, and request specific data in the authentication SSO request. The shared secret can be any string. Whatever shared secret is chosen, enter it in the appropriate field in the New Relic Partner console.</p>
<p>To edit the SSO settings:</p>
<ol>
  <li>Log in to the partnership owner account.</li>
  <li>From the <a href="/docs/accounts-partnerships/education/getting-started-new-relic/glossary#account-dropdown">account dropdown</a> in the New Relic UI, select <strong>Account settings > Partnerships > Edit settings</strong>.</li>
  <li>For <strong>SSO type</strong>, select <code>signature</code>.</li>
  <li>For <strong>SSO data</strong>, type the shared secret.</li>
  <li>Select <strong>Save</strong>.</li>
</ol>
<p>In addition to enhanced security, the new SSO method supports a session cookie. Nav data may be stored in the session cookie to support enhanced functionality of headers and footers. The name of the cookie is specified through the Partner console. If unspecified the cookie name defaults to <code>nav_data</code>.</p>
<p>To successfully use this SSO method, the SSO URI must be invoked from the user's browser. On success the browser will be automatically logged into New Relic and the redirect URL to that account returned.</p>
<p>The SSO URI however should not be generated on the browser, as this would expose the shared secret and allow the login to be spoofed. The URI should be generated on a host and passed to the user's browser.</p>
<h2>SSO API</h2>
<h3>Description [#sso-description]</h3>
<p>SSO authentication request</p>
<h3>Method [#sso-method]</h3>
<p>POST or GET</p>
<h3>URI [#sso-uri]</h3>
<pre><code>https://rpm.newrelic.com/accounts/sso_access
</code></pre>
<h3>Parameters [#sso-parameters]</h3>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p><strong>Name</strong></p>
      </div>
      <div>
        <p><strong>Required</strong></p>
      </div>
      <div>
        <p><strong>Description</strong></p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>id</code></p>
      </div>
      <div>
        <p>Yes</p>
      </div>
      <div>
        <p>ID of the New Relic account.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>email</code></p>
      </div>
      <div>
        <p>No</p>
      </div>
      <div>
        <p>Email address of user logging in (optional). If given, the user must already have been added to the account. By default, the account Owner role is used.</p>
        <p>Account Owners have full privileges on accounts. If some lesser degree of account privileges or a different user is desired, the email must be provided.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>timestamp</code></p>
      </div>
      <div>
        <p>Yes</p>
      </div>
      <div>
        <p>Timestamp used to generate token, in seconds since the epoch. Only timestamps within five minutes (300 seconds) of the New Relic system clock are accepted.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>nav-data</code></p>
        <p>OR</p>
        <p><code>nav_data</code></p>
      </div>
      <div>
        <p>No</p>
      </div>
      <div>
        <p>Partner navigation data. This data will be set in the session cookie using the name as specified in the partnership configuration, or <code>nav_data</code> by default.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>token</code></p>
      </div>
      <div>
        <p>Yes</p>
      </div>
      <div>
        <p>Signed token. The signature token is generated by applying a SHA1 hex digest on a seed string, which is composed as <code>Account_id:secret:timestamp</code> or <code>Account_id:secret:timestamp:email</code>. Each component is separated by a colon (:).</p>
        <p><strong>Example without email:</strong> "12345:MySecret:0987654321"</p>
        <p>Using Ruby syntax: <code>"#{account_id}:#{secret}:#{timestamp}"</code></p>
        <p><strong>Example with email:</strong> "12345:MySecret:0987654321:<a href="mailto:user@host.com">user@host.com</a>"</p>
        <p>Using Ruby syntax: <code>"#{account_id}:#{secret}:#{timestamp}:#{email}"</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><code>remote_url</code></p>
      </div>
      <div>
        <p>No</p>
      </div>
      <div>
        <p>Relative path of a New Relic page to which the users will be directed.</p>
      </div>
    </div>
  </div>
</div>
<h3>*<strong>*cURL examples**</strong> [#sso-examples]</h3>
<pre><code>curl -X POST -d "id=63790" -d "timestamp=1319659982" -d
"token=a4d30d6f1f1a5b6c2872ab"
https://rpm.newrelic.com/accounts/sso_access
</code></pre>
<pre><code>curl -X POST -d "id=63790" -d "timestamp=1319659982" -d
"token=a4d30d6f1f1a5b6c2872ab" -d "remote_url=/account/63790/servers"
https://rpm.newrelic.com/accounts/sso_access
</code></pre>
<p>On success returns:</p>
<pre><code>&#x3C;html>&#x3C;body>You are being &#x3C;a href="https://rpm.newrelic.com/accounts/63790/applications">redirected&#x3C;/a>.&#x3C;/body>&#x3C;/html>
</code></pre>
<h2>For more help [#more_help]</h2>
<p>Additional documentation resources include:</p>
<ul>
  <li><a href="/docs/accounts-partnerships/accounts/saml-single-sign/saml-service-providers">SAML service providers</a> (overview of New Relic's SSO feature, providers supported by New Relic)</li>
  <li><a href="/docs/accounts-partnerships/accounts/saml-single-sign/new-relic-partners-saml-sso">New Relic Partners and SAML SSO</a> (additional options for partner accounts)</li>
</ul>
