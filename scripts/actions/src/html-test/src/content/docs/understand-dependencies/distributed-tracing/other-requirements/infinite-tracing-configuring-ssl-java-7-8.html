
<p>Infinite Tracing requires special configuration of Java Cryptographic Extensions (JCE) for certain older versions of Java. This document provides guidelines on how to configure Java in this case.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>For security and performance, New Relic strongly recommends upgrading to the latest Java 8 update. For HotSpot-based JVMs, none of the steps below are required after 8u251.</p>
</div>
<h2>When to configure Java Cryptography [#when-configure]</h2>
<p>You must follow this process if you meet ALL of the criteria below:</p>
<ul>
  <li>
    <p>You are implementing Infinite Tracing</p>
  </li>
  <li>
    <p>Your JVM does not support Application-Layer Protocol Negotiation (ALPN). New Relic has identified that these JVMs do not support ALPN and require configuration:</p>
    <ul>
      <li>
        <p>Oracle Java 7</p>
      </li>
      <li>
        <p>Oracle Java 8 prior to update 251</p>
      </li>
      <li>
        <p>OpenJDK Java 8 prior to update 252</p>
        <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
          <p>New Relic has only confirmed that the JVMs above lack ALPN support. You should confirm with your vendor if ALPN support is present in your JVM.</p>
        </div>
      </li>
    </ul>
  </li>
</ul>
<h2>Application Server</h2>
<p>If you use Tomcat, WebSphere, Weblogic, or another application server, refer to your application server's documentation about how to add a Java Cryptography Extension (JCE) in your application server.</p>
<h2>Configure the export policy for Oracle JVMs [#export-policy]</h2>
<p>Older Oracle JVMs require an extra update to allow JCE. Consult <a href="https://www.oracle.com/java/technologies/javase-jce-all-downloads.html">this Oracle TechNote</a> for downloads and instructions.</p>
<h2>Configuring Conscrypt for HotSpot JVMs [#conscrypt]</h2>
<p>New Relic has successfully tested OpenJDK Java 8 with Conscrypt. Complete the following:</p>
<ol>
  <li>
    <p>Download the <a href="https://github.com/google/conscrypt/#download">appropriate Conscrypt jar</a> for your operating system.</p>
  </li>
  <li>
    <p>Copy the Conscrypt jar to <code>JAVA_HOME/jre/lib/ext</code>. This directory should already exist, but if it doesn't, look for a directory named <code>ext</code> under <code>JAVA_HOME</code>.</p>
  </li>
  <li>
    <p>Edit the file <code>JAVA_HOME/jre/lib/security/java.security</code> .</p>
  </li>
  <li>
    <p>Under the lines that start with <code>security.provider</code>, increment the last number, and set the value to <code>org.conscrypt.OpenSSLProvider</code>. For example, if the last entry was <code>security.provider.10</code>, add this line:</p>
    <pre><code>security.provider.11=org.conscrypt.OpenSSLProvider
</code></pre>
  </li>
</ol>
<h2>Finish setting up Infinite Tracing [#return-to-distributed-tracing]</h2>
<p>When you finish these preliminary configurations, return to <a href="/docs/understand-dependencies/distributed-tracing/enable-configure/enable-distributed-tracing">Language agents: Enable distributed tracing</a> to finish setting up Infinite Tracing.</p>
