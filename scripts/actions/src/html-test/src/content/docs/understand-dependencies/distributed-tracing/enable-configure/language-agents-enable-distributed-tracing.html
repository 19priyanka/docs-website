
<p>Here's what you need to know for enabling either standard distributed tracing or Infinite Tracing with our language agents.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>If you want to get more background before getting started, check out these topics:</p>
  <ul>
    <li><a href="/docs/understand-dependencies/distributed-tracing/get-started/how-new-relic-distributed-tracing-works#sampling">How span sampling works</a> explains distributed tracing options.</li>
    <li><a href="/docs/apm/distributed-tracing/getting-started/transition-guide-distributed-tracing">Impacts to APM</a> tells you what to expect if you are a current APM user.</li>
  </ul>
</div>
<p>The process of enabling distributed tracing takes you through these steps:</p>
<ol>
  <li><a href="#update-agents">Meet the prerequisites</a></li>
  <li><a href="#provision-trace-observer">(Infinite Tracing) Set up a trace observer</a></li>
  <li><a href="#configure-agents">Configure your agents</a></li>
  <li><a href="#view-traces">View traces</a></li>
</ol>
<h2>Step 1. Prerequisites [#update-agents]</h2>
<p>Check the following sections to confirm that the distributed tracing options you want are available for your environment. Your main options are:</p>
<ul>
  <li><a href="/docs/understand-dependencies/distributed-tracing/get-started/how-new-relic-distributed-tracing-works#head-based">Standard distributed tracing:</a> Head-based sampling</li>
  <li><a href="/docs/understand-dependencies/distributed-tracing/get-started/how-new-relic-distributed-tracing-works#tail-based">Infinite Tracing:</a> Tail-based sampling</li>
  <li><a href="/docs/understand-dependencies/distributed-tracing/get-started/how-new-relic-distributed-tracing-works#headers">Support for W3C Trace Context:</a> Available in all Infinite Tracing agents and in standard distributed tracing agents as noted</li>
</ul>
<p>Once you find the agent version with the features you want, follow the links for help installing or updating your agent. For best results, update existing agents to the latest version.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiYy1zZGsifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkMgU0RLIn1d">
    <div data-prop-text="title">C SDK</div>
    <p><a href="/docs/agents/c-sdk/install-configure/install-c-sdk-compile-link-your-code">Install (compile)</a> or <a href="/docs/agents/c-sdk/install-configure/update-your-c-sdk-library">update</a> to the required C SDK version. For best results, update to the <a href="/docs/release-notes/agent-release-notes/c-sdk-release-notes">latest C SDK version</a>.</p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Option</p>
          </div>
          <div>
            <p>C SDK version</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Standard distributed tracing</p>
          </div>
          <div>
            <p>1.1.0 or higher (W3C Trace Context not available)</p>
          </div>
        </div>
        <div>
          <div>
            <p>Infinite Tracing</p>
          </div>
          <div>
            <p>Not available</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZ28tdmVyc2lvbiJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiR28ifV0=">
    <div data-prop-text="title">Go</div>
    <p><a href="/docs/agents/go-agent/installation/install-new-relic-go">Install</a> or <a href="/docs/agents/go-agent/installation/install-new-relic-go">update</a> to the required Go agent version. For best results, update to the <a href="/docs/release-notes/agent-release-notes/go-release-notes">latest Go agent version</a>.</p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Option</p>
          </div>
          <div>
            <p>Go agent version</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Standard distributed tracing</p>
          </div>
          <div>
            <p>2.1.0 or higher</p>
            <p>With W3C Trace Context: 3.1.0 or higher</p>
          </div>
        </div>
        <div>
          <div>
            <p>Infinite Tracing</p>
          </div>
          <div>
            <p>v3.5.0 (includes W3C Trace Context)</p>
            <p>Supported environments: Go 1.9 or higher</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiamF2YSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiSmF2YSJ9XQ==">
    <div data-prop-text="title">Java</div>
    <p><a href="/docs/agents/java-agent/installation/install-java-agent">Install</a> or <a href="/docs/agents/java-agent/installation/upgrade-java-agent">update</a> to the required Java agent version. For best results, update to the <a href="/docs/release-notes/agent-release-notes/java-release-notes">latest Java agent version</a>.</p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Type</p>
          </div>
          <div>
            <p>Java agent version</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Standard distributed tracing</p>
          </div>
          <div>
            <p>4.3.0 or higher</p>
            <p>With W3C Trace Context: 5.10 or higher</p>
          </div>
        </div>
        <div>
          <div>
            <p>Infinite Tracing</p>
          </div>
          <div>
            <p>5.12.1 or higher (includes W3C Trace Context)</p>
            <p>Supported environments:</p>
            <ul>
              <li>
                <p>Java 8: Update 252 or higher</p>
              </li>
              <li>
                <p>All versions of Java 9 or higher</p>
                <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
                  <p>For special considerations, see <a href="/docs/understand-dependencies/distributed-tracing/other-requirements/infinite-tracing-configuring-ssl-java-7-8">Infinite Tracing: Configuring SSL for Java 7 and 8</a>.</p>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZG90LW5ldC12ZXJzaW9uIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiIuTkVUIn1d">
    <div data-prop-text="title">.NET</div>
    <p><a href="/docs/agents/net-agent/installation/net-agent-install-introduction">Install</a> or <a href="/docs/agents/net-agent/installation/update-net-agent">update</a> to the required .NET agent version. For best results, update to the <a href="/docs/release-notes/agent-release-notes/net-release-notes">latest .NET agent version</a>.</p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Option</p>
          </div>
          <div>
            <p>.NET agent version</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Standard distributed tracing</p>
          </div>
          <div>
            <p>8.6.45.0 or higher</p>
            <p>With W3C Trace Context: 8.27.139.0 or higher</p>
          </div>
        </div>
        <div>
          <div>
            <p>Infinite Tracing</p>
          </div>
          <div>
            <p>8.30.0 (includes W3C Trace Context)</p>
            <p>Supported environments:</p>
            <ul>
              <li>.NET Framework 4.5 or higher</li>
              <li>.NET Core 2.0 or higher</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibm9kZS12ZXJzaW9uIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJOb2RlLmpzIn1d">
    <div data-prop-text="title">Node.js</div>
    <p><a href="/docs/agents/nodejs-agent/installation-configuration/install-nodejs-agent">Install</a> or <a href="/docs/agents/nodejs-agent/installation-configuration/upgrade-nodejs-agent">update</a> to the required Node.js agent version. For best results, update to the <a href="/docs/release-notes/agent-release-notes/nodejs-release-notes">latest Node.js agent version</a>.</p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Option</p>
          </div>
          <div>
            <p>Node.js agent version</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Standard distributed tracing</p>
          </div>
          <div>
            <p>4.7.0 or higher</p>
            <p>With W3C Trace Context: 6.4 or higher</p>
          </div>
        </div>
        <div>
          <div>
            <p>Infinite Tracing</p>
          </div>
          <div>
            <p>6.7.0 (includes W3C Trace Context)</p>
            <p>Supported environments: Node version 10.10.0 or higher</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicGhwLXZlcnNpb24ifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IlBIUCJ9XQ==">
    <div data-prop-text="title">PHP</div>
    <p><a href="/docs/agents/php-agent/getting-started/introduction-new-relic-php">Install</a> or <a href="/docs/agents/php-agent/installation/upgrade-php-agent">update</a> to the required PHP agent version. For best results, update to the <a href="/docs/release-notes/agent-release-notes/php-release-notes">latest PHP agent version</a>.</p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Option</p>
          </div>
          <div>
            <p>PHP agent version</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Standard distributed tracing</p>
          </div>
          <div>
            <p>8.4 or higher</p>
            <p>With W3C Trace Context: 9.8 or higher</p>
          </div>
        </div>
        <div>
          <div>
            <p>Infinite Tracing</p>
          </div>
          <div>
            <p>9.12.0.268 or higher</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicHl0aG9uLXZlcnNpb24ifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IlB5dGhvbiJ9XQ==">
    <div data-prop-text="title">Python</div>
    <p><a href="/docs/agents/python-agent/installation/standard-python-agent-install">Install</a> or <a href="/docs/agents/python-agent/installation-configuration/upgrade-python-agent">update</a> to the required Python agent version. For best results, update to the <a href="/docs/release-notes/agent-release-notes/python-release-notes">latest Python agent version</a>.</p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Option</p>
          </div>
          <div>
            <p>Python agent version</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Standard distributed tracing</p>
          </div>
          <div>
            <p>4.2.0.100 or higher</p>
            <p>With W3C Trace Context: 5.6 or higher</p>
          </div>
        </div>
        <div>
          <div>
            <p>Infinite Tracing</p>
          </div>
          <div>
            <p>5.12.0.140 (includes W3C Trace Context)</p>
            <p>Supported environments: CPython only (pypy is unsupported)</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicnVieS12ZXJzaW9uIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJSdWJ5In1d">
    <div data-prop-text="title">Ruby</div>
    <p><a href="/docs/agents/ruby-agent/installation/install-new-relic-ruby-agent">Install</a> or <a href="/docs/agents/ruby-agent/installation/update-ruby-agent">update</a> to the required Ruby agent version. For best results, update to the <a href="/docs/release-notes/agent-release-notes/ruby-release-notes">latest Ruby agent version</a>.</p>
    <p>Also install the additional Ruby agent gem for Infinite Tracing.</p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Option</p>
          </div>
          <div>
            <p>Ruby agent version</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Standard distributed tracing</p>
          </div>
          <div>
            <p><a href="https://rubygems.org/gems/newrelic_rpm">newrelic_rpm</a> 5.3.0.346 or higher</p>
            <p>With W3C Trace Context: <a href="https://rubygems.org/gems/newrelic_rpm">newrelic_rpm</a> 6.9 or higher</p>
          </div>
        </div>
        <div>
          <div>
            <p>Infinite Tracing</p>
          </div>
          <div>
            <p><a href="https://rubygems.org/gems/newrelic_rpm">newrelic_rpm</a> 6.11.0.365 or higher (includes W3C Trace Context)</p>
            <p><a href="https://rubygems.org/gems/newrelic-infinite_tracing">newrelic-infinite_tracing</a> 6.11.0.375 or higher</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<h2>Step 2. (Infinite Tracing) Set up a trace observer [#provision-trace-observer]</h2>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>This section only applies to Infinite Tracing. If you're enabling standard distributed tracing, skip to <a href="#configure-agents">Configure the agents</a>.</p>
</div>
<p>Infinite Tracing requires you to provision a trace observer that receives your spans. The trace observer examines the spans and keeps the actionable ones. You provision a trace observer in a cluster of services in AWS called New Relic Edge.</p>
<p>Use our Edge app to set up the trace observer. This app also includes some optional configurations: <a href="/docs/understand-dependencies/distributed-tracing/other-requirements/infinite-tracing-trace-observer-monitoring">trace observer monitoring</a> and <a href="/docs/understand-dependencies/distributed-tracing/other-requirements/infinite-tracing-span-attribute-filters">span attribute trace filter</a>. If you're not sure whether you want to configure these, you can set them up later.</p>
<p>Complete the following:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZ2V0LWVuZHBvaW50cyJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiMmEuIFNldCB1cCB0aGUgdHJhY2Ugb2JzZXJ2ZXIgZW5kcG9pbnQifV0=">
    <div data-prop-text="title">2a. Set up the trace observer endpoint</div>
    <ol>
      <li>
        <p>Go to <a href="one.newrelic.com">one.newrelic.com</a>.</p>
      </li>
      <li>
        <p>In the menu bar, click <strong>Apps</strong>, expand <strong>Your apps</strong>, and then click <strong>New Relic Edge</strong>.</p>
      </li>
      <li>
        <p>Select an account in the upper-left dropdown.</p>
        <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
          <p>If you have access to multiple account hierarchies, make sure you're in the hierarchy where you want a trace observer.</p>
        </div>
      </li>
      <li>
        <p>If no trace observers are listed, click <strong>New trace observer</strong> to add one, insert a descriptive name, select a region, and then click <strong>Create</strong>. Some region-related requirements:</p>
        <ul>
          <li>Trace observers should be provisioned in one of these regions: <code>us-east-1</code>, <code>us-west-2</code> , and <code>eu-west-1</code>: these regions will lower latency and AWS cost if you're running your applications in the corresponding region.</li>
          <li>EU regions: If you send data to a trace observer in one of our EU provider regions, you'll still require a U.S.-based New Relic account because the tail-based sampling data is reported to U.S. data centers. If you have questions, contact your account representative.</li>
        </ul>
      </li>
      <li>
        <p>For the trace observer you want to use, go to the <strong>Endpoints</strong> dropdown and click the adjacent clipboard icon to copy these values:</p>
        <div data-component="Table" data-prop="W10=">
          <div>
            <div>
              <div>
                <p>Endpoints dropdown value</p>
              </div>
              <div>
                <p>Description</p>
              </div>
            </div>
          </div>
          <div>
            <div>
              <div>
                <p>For language agents</p>
              </div>
              <div>
                <p>Copy and hold to use later as YOUR_TRACE_OBSERVER_HOST in <a href="#configure-agents">Step 3. Configure the agents</a>.</p>
              </div>
            </div>
            <div>
              <div>
                <p>For other integrations</p>
              </div>
              <div>
                <p>(Optional) Copy and hold to use later as YOUR_TRACE_OBSERVER_URL in <a href="#test-observer">2b. Send test data to the trace observer</a>.</p>
              </div>
            </div>
          </div>
        </div>
      </li>
      <li>
        <p>(Optional) If you want to start gathering trace observer metrics, click the toggle for <strong>Trace observer monitoring</strong>. For details, see <a href="/docs/understand-dependencies/distributed-tracing/other-requirements/infinite-tracing-trace-observer-monitoring">trace observer monitoring</a>.</p>
      </li>
      <li>
        <p>(Optional) If you want to customize the span attribute trace filter, click the gear icon below <strong>Trace filters</strong> to see the current rules. For details, see <a href="/docs/understand-dependencies/distributed-tracing/other-requirements/infinite-tracing-span-attribute-filters">span attribute filter</a>.</p>
      </li>
      <li>
        <p>(Optional) If you want to customize the percentage for the random trace filter, see <a href="/docs/understand-dependencies/distributed-tracing/other-requirements/infinite-tracing-random-trace-filter">Infinite Tracing: Random trace filter</a>. You may want to do this later after you've looked at your traces.</p>
      </li>
    </ol>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidGVzdC1vYnNlcnZlciJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiMmIuIChPcHRpb25hbCkgU2VuZCB0ZXN0IGRhdGEgdG8gdGhlIHRyYWNlIG9ic2VydmVyIn1d">
    <div data-prop-text="title">2b. (Optional) Send test data to the trace observer</div>
    <p>This test includes a sample payload with one trace and two spans from the same service: <code>Test Service A</code>. Follow these steps to send a test request:</p>
    <ol>
      <li>
        <p>Get or generate your <a href="/docs/apis/get-started/intro-apis/types-new-relic-api-keys#event-insert-key">Insert API key</a> so you can use it later in the test.</p>
      </li>
      <li>
        <p>Copy the following <code>curl</code> request into a text editor:</p>
        <div data-component="CollapserGroup" data-prop="W10=">
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY3VybC10ZXN0In0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOnsidHlwZSI6Im1keFZhbHVlRXhwcmVzc2lvbiIsInZhbHVlIjoiPD48SW5saW5lQ29kZT5jdXJsPC9JbmxpbmVDb2RlPiByZXF1ZXN0PC8+IiwicG9zaXRpb24iOnsic3RhcnQiOnsibGluZSI6NTEwLCJjb2x1bW4iOjExLCJvZmZzZXQiOjE2Mjc1fSwiZW5kIjp7ImxpbmUiOjUxMCwiY29sdW1uIjo1NSwib2Zmc2V0IjoxNjMxOX19fX1d">
            <div data-prop-text="title">[object Object]</div>
            <pre><code>curl -i -H "Content-Type: application/json" \
  -H "Api-Key: YOUR_INSERT_API_KEY" \
  -H 'Data-Format: newrelic' \
  -H 'Data-Format-Version: 1' \
  -X POST \
  -d '[
      {
          "common": {
          "attributes": {
              "environment": "staging"
          }
          },
          "spans": [
          {
              "trace.id": "123456",
              "id": "ABC",
              "attributes": {
                  "duration.ms": 12.53,
                  "host": "host123.test.com",
                  "name": "/home",
                  "service.name": "Test Service A"
              }
          },
          {
              "trace.id": "123456",
              "id": "DEF",
              "attributes": {
                  "duration.ms": 2.97,
                  "host": "host456.test.com",
                  "error.message": "Invalid credentials",
                  "name": "/auth",
                  "parent.id": "ABC",
                  "service.name": "Test Service B"
              }
          }
          ]
      }
      ]' \
'YOUR_TRACE_OBSERVER_URL'

</code></pre>
          </div>
        </div>
      </li>
      <li>
        <p>Insert your own values into the <code>curl</code> request:</p>
        <div data-component="Table" data-prop="W10=">
          <div>
            <div>
              <div>
                <p>Value</p>
              </div>
              <div>
                <p>Description</p>
              </div>
            </div>
          </div>
          <div>
            <div>
              <div>
                <p>YOUR_INSERT_API_KEY</p>
              </div>
              <div>
                <p>Replace this with your <a href="/docs/apis/get-started/intro-apis/types-new-relic-api-keys#event-insert-key">Insert API key</a> (not the same as your user key for NerdGraph)</p>
              </div>
            </div>
            <div>
              <div>
                <p>YOUR_TRACE_OBSERVER_URL</p>
              </div>
              <div>
                <p>Replace this with the value you copied in <a href="#get-endpoints">2a. Set up the trace observer endpoint</a>.</p>
              </div>
            </div>
          </div>
        </div>
      </li>
      <li>
        <p>Copy the content of the text editor into a terminal, and then execute the request.</p>
      </li>
      <li>
        <p>If the test does not return <code>HTTP/1.1 202 Accepted</code> indicating success, check the following and try again:</p>
        <ul>
          <li>Confirm that you used the Edge app value <strong>For other integrations</strong> as YOUR_TRACE_OBSERVER_URL.</li>
          <li>Confirm that you only have single quotes around the value you inserted for YOUR_TRACE_OBSERVER_URL.</li>
          <li>Check that you are using the Insert API Key (not a license).</li>
        </ul>
      </li>
      <li>
        <p>If your test returned <code>HTTP/1.1 202 Accepted</code>, go to <a href="https://one.newrelic.com/launcher/distributed-tracing-nerdlets.distributed-tracing?launcher=eyJ0aW1lUmFuZ2UiOnsiYmVnaW5fdGltZSI6bnVsbCwiZW5kX3RpbWUiOm51bGwsImR1cmF0aW9uIjoxODAwMDAwfSwiJGlzRmFsbGJhY2tUaW1lUmFuZ2UiOnRydWV9&#x26;pane=eyJuZXJkbGV0SWQiOiJkaXN0cmlidXRlZC10cmFjaW5nLW5lcmRsZXRzLmRpc3RyaWJ1dGVkLXRyYWNpbmctbGF1bmNoZXIiLCJzb3J0SW5kZXgiOjAsInNvcnREaXJlY3Rpb24iOiJERVNDIiwicXVlcnkiOnsib3BlcmF0b3IiOiJBTkQiLCJpbmRleFF1ZXJ5Ijp7ImNvbmRpdGlvblR5cGUiOiJJTkRFWCIsIm9wZXJhdG9yIjoiQU5EIiwiY29uZGl0aW9ucyI6W119LCJzcGFuUXVlcnkiOnsib3BlcmF0b3IiOiJBTkQiLCJjb25kaXRpb25TZXRzIjpbeyJjb25kaXRpb25UeXBlIjoiU1BBTiIsIm9wZXJhdG9yIjoiQU5EIiwiY29uZGl0aW9ucyI6W3siYXR0ciI6InNlcnZpY2UubmFtZSIsIm9wZXJhdG9yIjoiRVEiLCJ2YWx1ZSI6IlRlc3QgU2VydmljZSBBIn1dfV19fX0=">New Relic One</a> to see a query of your test data using the span attribute <code>service.name = Test Service A</code>. Because the sample payload contains an error attribute, the error sampler will mark it for keeping. If you modify the payload to remove the error attributes, the random sampler may not choose to keep this particular trace.</p>
        <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
          <p>Traces may take up to one minute to be processed by both the trace observer and the Trace API.</p>
        </div>
      </li>
    </ol>
  </div>
</div>
<h2>Step 3. Configure the agents [#configure-agents]</h2>
<p>Distributed tracing is enabled through configuration settings. The settings you need to change for distributed tracing depend on the type you want:</p>
<ul>
  <li>Standard distributed tracing</li>
  <li>Infinite Tracing (requires YOUR_TRACE_OBSERVER_HOST from <a href="#get-endpoints">step 2</a>)</li>
</ul>
<p>Review the following section for your agent to see the required configuration settings. For more information, see <a href="/docs/agents/manage-apm-agents/configuration/configure-agent">Configure the agent</a>.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>Server-side configuration is not available for Infinite Tracing.</p>
</div>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiYy1zZGstY29uZmlnIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJDIFNESyJ9XQ==">
    <div data-prop-text="title">C SDK</div>
    <p>Here's an overview of the settings. For more help with configuration, see <a href="/docs/agents/c-sdk/instrumentation/enable-distributed-tracing-your-c-applications">Enable distributed tracing for your C applications</a>.</p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Type</p>
          </div>
          <div>
            <p>Required configuration</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Standard distributed tracing</p>
          </div>
          <div>
            <p>Configuration examples:</p>
            <ul>
              <li>
                <p><code>newrelic_app_config_t</code> structure:</p>
                <pre><code>newrelic_app_config_t* config;
config = newrelic_create_app_config(app_name, license_key);
config->distributed_tracing.enabled = true;
</code></pre>
              </li>
            </ul>
          </div>
        </div>
        <div>
          <div>
            <p>Infinite Tracing</p>
          </div>
          <div>
            <p>Not available</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZ28tY29uZmlnIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJHbyJ9XQ==">
    <div data-prop-text="title">Go</div>
    <p>Here's an overview of the settings. For more help with configuration, see <a href="/docs/agents/go-agent/features/enable-distributed-tracing-go-agent">Enable distributed tracing for your Go applications</a>.</p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Type</p>
          </div>
          <div>
            <p>Required configuration</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Standard distributed tracing</p>
          </div>
          <div>
            <p>Configuration examples:</p>
            <ul>
              <li>
                <p><code>ConfigOption</code> structure:</p>
                <pre><code>newrelic.NewApplication(
  newrelic.ConfigAppName("Example App"),
  newrelic.ConfigLicense(os.Getenv("NEW_RELIC_LICENSE_KEY")),
  newrelic.ConfigDistributedTracerEnabled(true),
)
</code></pre>
              </li>
              <li>
                <p>Environment variable:</p>
                <pre><code>NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true
</code></pre>
              </li>
            </ul>
          </div>
        </div>
        <div>
          <div>
            <p>Infinite Tracing</p>
          </div>
          <div>
            <p>Configuration examples:</p>
            <ul>
              <li>
                <p><code>newrelic.Config</code> structure:</p>
                <pre><code>app, err := newrelic.NewApplication(
    newrelic.ConfigAppName(YOUR_APP_NAME),
    newrelic.ConfigLicense(YOUR_LICENSE_KEY),
    func(cfg *newrelic.Config) {
        cfg.DistributedTracer.Enabled = true
        cfg.InfiniteTracing.TraceObserver.Host = YOUR_TRACE_OBSERVER_HOST
    },
)
</code></pre>
              </li>
              <li>
                <p>Environment variables:</p>
                <pre><code>NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true
NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST=YOUR_TRACE_OBSERVER_HOST
</code></pre>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiamF2YS1jb25maWcifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkphdmEifV0=">
    <div data-prop-text="title">Java</div>
    <p>Here's an overview of the settings. For more help with configuration, see <a href="/docs/agents/java-agent/configuration/java-agent-configuration-config-file">Java agent configuration: Config file</a>.</p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Type</p>
          </div>
          <div>
            <p>Required configuration</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Standard distributed tracing</p>
          </div>
          <div>
            <p>Configuration examples:</p>
            <ul>
              <li>
                <p>Configuration file (<code>newrelic.yml</code>) (indented 2 spaces under the <code>common</code> stanza):</p>
                <pre><code>distributed_tracing:
    enabled: true
</code></pre>
              </li>
              <li>
                <p>Java system property:</p>
                <pre><code>-Dnewrelic.config.distributed_tracing.enabled=true
</code></pre>
              </li>
              <li>
                <p>Environment variable:</p>
                <pre><code>NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true
</code></pre>
              </li>
            </ul>
          </div>
        </div>
        <div>
          <div>
            <p>Infinite Tracing</p>
          </div>
          <div>
            <p>Configuration examples:</p>
            <ul>
              <li>
                <p>Configuration file (<code>newrelic.yml</code>) (indented 2 spaces under the <code>common</code> stanza):</p>
                <pre><code>distributed_tracing:
    enabled: true
  infinite_tracing:
    trace_observer:
      host: "YOUR_TRACE_OBSERVER_HOST"
</code></pre>
              </li>
              <li>
                <p>Java system property:</p>
                <pre><code>-Dnewrelic.config.distributed_tracing.enabled=true
-Dnewrelic.config.infinite_tracing.trace_observer.host="YOUR_TRACE_OBSERVER_HOST"
</code></pre>
              </li>
              <li>
                <p>Environment variable:</p>
                <pre><code>NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true
NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST="YOUR_TRACE_OBSERVER_HOST"
</code></pre>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZG90LW5ldC1jb25maWcifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6Ii5ORVQifV0=">
    <div data-prop-text="title">.NET</div>
    <p>Here's an overview of the settings. For more help with configuration, see <a href="/docs/agents/net-agent/configuration/net-agent-configuration#distributed_tracing">.NET agent configuration</a>.</p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Type</p>
          </div>
          <div>
            <p>Required configuration</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Standard distributed tracing</p>
          </div>
          <div>
            <p>Configuration examples:</p>
            <ul>
              <li>
                <p>Configuration file (<code>newrelic.config</code>):</p>
                <pre><code>&#x3C;configuration . . . >
   &#x3C;distributedTracing enabled="true" />
&#x3C;/configuration>
</code></pre>
              </li>
              <li>
                <p>Environment variable:</p>
                <pre><code>NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true
</code></pre>
              </li>
            </ul>
          </div>
        </div>
        <div>
          <div>
            <p>Infinite Tracing</p>
          </div>
          <div>
            <p>Configuration examples:</p>
            <ul>
              <li>
                <p>Configuration file (<code>newrelic.config</code>):</p>
                <pre><code>&#x3C;configuration . . . >
   &#x3C;distributedTracing enabled="true" />
   &#x3C;infiniteTracing>
      &#x3C;trace_observer host="YOUR_TRACE_OBSERVER_HOST" />
   &#x3C;/infiniteTracing>
&#x3C;/configuration>
</code></pre>
              </li>
              <li>
                <p>Environment variable:</p>
                <pre><code>NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true
NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST="YOUR_TRACE_OBSERVER_HOST"
</code></pre>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibm9kZS1jb25maWcifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6Ik5vZGUuanMifV0=">
    <div data-prop-text="title">Node.js</div>
    <p>Here's an overview of the settings. For more help with configuration, see <a href="/docs/agents/nodejs-agent/installation-configuration/nodejs-agent-configuration#distributed-tracing">Node.js agent configuration</a>.</p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Type</p>
          </div>
          <div>
            <p>Required configuration</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Standard distributed tracing</p>
          </div>
          <div>
            <p>Configuration examples:</p>
            <p>Configuration file (<code>newrelic.js</code>):</p>
            <pre><code>distributed_tracing: {
  enabled: true
}

</code></pre>
            <pre><code>
NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true

</code></pre>Environment variable:
          </div>
        </div>
        <div>
          <div>
            <p>Infinite Tracing</p>
          </div>
          <div>
            <p>Configuration examples:</p>
            <p>Configuration file (<code>newrelic.js</code>):</p>
            <pre><code>distributed_tracing: {
  enabled: true
}
infinite_tracing: {
  trace_observer: {
    host: 'YOUR_TRACE_OBSERVER_HOST'
  }
}

</code></pre>
            <pre><code>
NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true
NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST="YOUR_TRACE_OBSERVER_HOST"

</code></pre>Environment variable:
          </div>
        </div>
      </div>
    </div>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicGhwLWNvbmZpZyJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiUEhQIn1d">
    <div data-prop-text="title">PHP</div>
    <p>Here's an overview of the settings. For more help with configuration, see <a href="/docs/agents/php-agent/features/distributed-tracing-php-agent">Distributed tracing for the PHP agent</a></p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Type</p>
          </div>
          <div>
            <p>Required configuration</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Standard distributed tracing</p>
          </div>
          <div>
            <p>Configuration examples:</p>
            <ul>
              <li>
                <p>Configuration file (<code>newrelic.ini</code>):</p>
                <pre><code>newrelic.distributed_tracing_enabled = true
</code></pre>
              </li>
            </ul>
          </div>
        </div>
        <div>
          <div>
            <p>Infinite Tracing</p>
          </div>
          <div>
            <p>Configuration examples:</p>
            <ul>
              <li>
                <p>Configuration file (<code>newrelic.ini</code>):</p>
                <pre><code>newrelic.distributed_tracing_enabled = true
newrelic.span_events_enabled = true
newrelic.infinite_tracing.trace_observer_host= YOUR_TRACE_OBSERVER_HOST
</code></pre>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicHl0aG9uLWNvbmZpZyJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiUHl0aG9uIn1d">
    <div data-prop-text="title">Python</div>
    <p>Here's an overview of the settings. For more help with configuration, see <a href="/docs/agents/python-agent/configuration/python-agent-configuration#distributed-tracing-settings">Python agent configuration</a></p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Type</p>
          </div>
          <div>
            <p>Required configuration</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Standard distributed tracing</p>
          </div>
          <div>
            <p>Configuration file (<code>newrelic.ini</code>):</p>
            <pre><code>distributed_tracing.enabled = true

</code></pre>
            <pre><code>
NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true

</code></pre>Environment variable:
          </div>
        </div>
        <div>
          <div>
            <p>Infinite Tracing</p>
          </div>
          <div>
            <p>Use the following installation command:</p>
            <pre><code>pip install newrelic[infinite-tracing]

</code></pre>
            <pre><code>
NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true
NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST="YOUR_TRACE_OBSERVER_HOST"

</code></pre>Environment variable:
            <pre><code>
distributed_tracing.enabled = true
infinite_tracing.trace_observer_host= YOUR_TRACE_OBSERVER_HOST

</code></pre>Configuration file (`newrelic.ini`):
          </div>
        </div>
      </div>
    </div>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicnVieS1jb25maWcifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IlJ1YnkifV0=">
    <div data-prop-text="title">Ruby</div>
    <p>Here's an overview of the settings. For more help with configuration, see <a href="/docs/agents/ruby-agent/configuration/ruby-agent-configuration#distributed_tracing">Ruby agent configuration</a>.</p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Type</p>
          </div>
          <div>
            <p>Required configuration</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Standard distributed tracing</p>
          </div>
          <div>
            <p>Configuration examples:</p>
            <ul>
              <li>
                <p>Configuration file (<code>newrelic.yml</code>):</p>
                <pre><code>distributed_tracing:
        enabled: true
</code></pre>
              </li>
              <li>
                <p>Environment variable:</p>
                <pre><code>NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true
</code></pre>
              </li>
            </ul>
          </div>
        </div>
        <div>
          <div>
            <p>Infinite Tracing</p>
          </div>
          <div>
            <p>Configuration examples:</p>
            <ul>
              <li>
                <p>Configuration file (<code>newrelic.yml</code>):</p>
                <pre><code>distributed_tracing: 
      enabled: true
  infinite_tracing: 
      trace_observer: 
          host: 'YOUR_TRACE_OBSERVER_HOST'
</code></pre>
              </li>
              <li>
                <p>Environment variable:</p>
                <pre><code>NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true
NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST="YOUR_TRACE_OBSERVER_HOST"
</code></pre>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>If you need help with proxy configuration, see <a href="/docs/understand-dependencies/distributed-tracing/other-requirements/infinite-tracing-proxy-support">Proxy support</a>.</p>
</div>
<h2>Step 4. View traces [#view-traces]</h2>
<p>After you upgrade and configure your APM agents to send data to your trace observer, you are ready to view traces. Here are two alternatives:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZW50aXR5LWV4cGxvcmVyIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJWaWV3IHRyYWNlcyB0aGF0IGluY2x1ZGUgYSBzcGVjaWZpYyBzZXJ2aWNlIn1d">
    <div data-prop-text="title">View traces that include a specific service</div>
    <p>The <strong>Entity explorer</strong> helps you navigate to a specific service so you can see traces that include that service.</p>
    <ol>
      <li>Go to <strong><a href="https://one.newrelic.com/">one.newrelic.com</a></strong>.</li>
      <li>Click <strong>Entity explorer</strong> in the top menu bar.</li>
      <li>Filter to the service you enabled for Infinite Tracing by typing the service name, and then press Enter.</li>
      <li>In the left navigation's <strong>Monitor</strong> section, click <strong>Distributed tracing</strong>.</li>
    </ol>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZHQtbGF1bmNoZXIifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IlZpZXcgdHJhY2VzIGFjcm9zcyBhY2NvdW50cyJ9XQ==">
    <div data-prop-text="title">View traces across accounts</div>
    <p>This option allows you to search all traces across all New Relic accounts in your organization that you have access to.</p>
    <ol>
      <li>
        <p>Go to <strong><a href="https://one.newrelic.com/">one.newrelic.com</a></strong>.</p>
      </li>
      <li>
        <p>Click <strong>Apps</strong> in the top menu bar.</p>
      </li>
      <li>
        <p>Under <strong>Favorites</strong> click <strong>Distributed tracing</strong>.</p>
      </li>
      <li>
        <p>In the <strong>Find traces...</strong> search, type a search clause to find the service. For example, to query <code>service.name</code> or <code>trace.id</code>:</p>
        <pre><code>service.name = YOUR_SERVICE_NAME
trace.id = YOUR_TRACE_ID
</code></pre>
      </li>
    </ol>
  </div>
</div>
<h2>Manual instrumentation (If automatic instrumentation doesn't work) [#agent-apis]</h2>
<p><strong>Recommendation:</strong> Before performing any custom instrumentation, read:</p>
<ul>
  <li><a href="/docs/apm/distributed-tracing/getting-started/how-new-relic-distributed-tracing-works">How distributed tracing works</a></li>
  <li><a href="/docs/apm/distributed-tracing/troubleshooting/troubleshooting-missing-trace-data">Troubleshoot missing data</a></li>
</ul>
<p>If a service is not passing the trace header to other services, you can use the distributed tracing payload APIs to instrument the <a href="#calling-service">calling service</a> and the <a href="#called-service">called service</a>. The calling service uses an API call to generate a payload, which is accepted by the called service.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY2FsbGluZy1zZXJ2aWNlIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJJbnN0cnVtZW50IHRoZSBjYWxsaW5nIHNlcnZpY2UifV0=">
    <div data-prop-text="title">Instrument the calling service</div>
    <p>To instrument the calling service:</p>
    <ol>
      <li>
        <p>Ensure the <a href="#compatibility-requirements">version of the APM agent</a> that monitors the calling service supports distributed tracing.</p>
      </li>
      <li>
        <p>Invoke the agent API call for generating a distributed trace payload: <a href="/docs/agents/c-sdk/instrumentation/enable-distributed-tracing-your-c-applications">C SDK</a> | <a href="/docs/agents/go-agent/features/distributed-tracing-go#create-manually">Go</a> | <a href="/docs/agents/java-agent/api-guides/guide-using-java-agent-api#trace-calls">Java</a> | <a href="/docs/agents/net-agent/net-agent-api/itransaction#CreateDistributedTracePayload">.NET</a> | <a href="/docs/agents/nodejs-agent/api-guides/nodejs-agent-api#transaction-handle-createDistributedTracePayload">Node.js</a> | <a href="/docs/agents/php-agent/features/distributed-tracing-php#manual">PHP</a> | <a href="/docs/agents/python-agent/python-agent-api/create_distributed_trace_payload">Python</a> | <a href="/docs/agents/ruby-agent/api-guides/guide-using-ruby-agent-api#distributed">Ruby</a>.</p>
        <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
          <p>To maintain proper ordering of spans in a trace, ensure you <strong>generate the payload in the context of the span that sends it</strong>.</p>
        </div>
      </li>
      <li>
        <p>Add that payload to the call made to the destination service (for example, in a header).</p>
      </li>
      <li>
        <p>(Optional) Identify the call as an external call:</p>
        <ul>
          <li><a href="https://github.com/newrelic/c-sdk/blob/master/GUIDE.md#distributed-tracing">C SDK</a></li>
          <li><a href="/docs/agents/go-agent/get-started/instrument-go-segments#go-external-segments">Go</a></li>
          <li><a href="https://newrelic.github.io/java-agent-api/javadoc/index.html?com/newrelic/api/agent/TracedMethod.html">Java</a></li>
          <li>.NET: n/a</li>
          <li><a href="/docs/agents/nodejs-agent/api-guides/nodejs-agent-api#custom-instrumentation-api">Node.js</a></li>
          <li>PHP: n/a</li>
          <li><a href="/docs/agents/python-agent/python-agent-api/external-trace">Python</a></li>
          <li><a href="/docs/agents/ruby-agent/api-guides/guide-using-ruby-agent-api#externals">Ruby</a></li>
        </ul>
      </li>
    </ol>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY2FsbGVkLXNlcnZpY2UifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6Ikluc3RydW1lbnQgdGhlIGNhbGxlZCBzZXJ2aWNlIn1d">
    <div data-prop-text="title">Instrument the called service</div>
    <p>To instrument the called service:</p>
    <ol>
      <li>
        <p>Ensure the <a href="#compatibility-requirements">version of the APM agent</a> that monitors the called service supports distributed tracing.</p>
      </li>
      <li>
        <p>If the New Relic agent on the called service does not identify a New Relic transaction, use the agent API to declare a transaction:</p>
        <div data-component="CollapserGroup" data-prop="W10=">
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiYy1zZGstY3JlYXRlIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJDIFNESyJ9XQ==">
            <div data-prop-text="title">C SDK</div>
            <p>One way to tell that a transaction is not in progress: when <code>newrelic_create_distributed_trace_payload()</code> is called, a <code>NULL</code> pointer is returned. To solve this problem, follow the procedures to <a href="/docs/agents/c-sdk/instrumentation/instrument-your-app-c-sdk">create a transaction</a> with the C SDK.</p>
          </div>
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZ28tY3JlYXRlIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJHbyJ9XQ==">
            <div data-prop-text="title">Go</div>
            <p>One way to tell that a transaction is not in progress: when <code>Transaction.InsertDistributedTraceHeaders(h http.Header)</code> is called, no headers are inserted. To create a transaction, see <a href="/docs/agents/go-agent/instrumentation/instrument-go-transactions">Instrument Go transactions</a>.</p>
          </div>
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiSmF2YSJ9XQ==">
            <div data-prop-text="title">Java</div>
            <p>One way to tell that a transaction is not in progress: when <code>createDistributedTracePayload()</code> is called, an empty string is returned. To create a transaction, see <a href="/docs/agents/java-agent/api-guides/guide-using-java-agent-api#transactions">Java agent transaction-related APIs</a>.</p>
          </div>
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZG90bmV0LWNyZWF0ZSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiLk5FVCJ9XQ==">
            <div data-prop-text="title">.NET</div>
            <p>One way to tell that a transaction is not in progress: <code>CreateDistributedTracePayload()</code> returns an <a href="/docs/agents/net-agent/net-agent-api/idistributedtracepayload">empty payload</a>. To create a transaction, see <a href="/docs/agents/net-agent/custom-instrumentation/introduction-net-custom-instrumentation">Introduction to .NET custom instrumentation</a>.</p>
          </div>
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibm9kZS1jcmVhdGUifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6Ik5vZGUuanMifV0=">
            <div data-prop-text="title">Node.js</div>
            <p>One way to tell that a transaction is not in progress: the Node.js agent logs will report an error similar to this:</p>
            <pre><code>No transaction found when calling Transaction.acceptDistributedTracePayload.

</code></pre>Use [`startWebTransaction`](/docs/agents/nodejs-agent/api-guides/nodejs-agent-api#startWebTransaction) to create a web transaction or [`startBackgroundTransaction`](/docs/agents/nodejs-agent/api-guides/nodejs-agent-api#startBackgroundTransaction) to capture a [non-web transaction](/docs/apm/transactions/intro-transactions/monitor-background-processes-other-non-web-transactions).
          </div>
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicGhwLWNyZWF0ZSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiUEhQIn1d">
            <div data-prop-text="title">PHP</div>
            <p>One way to tell that a transaction is not in progress: <code>newrelic_insert_distributed_trace_headers()</code> returns <code>false</code>. To create a transaction, see <a href="/docs/agents/php-agent/php-agent-api/newrelic_start_transaction">newrelic_start_transaction</a>.</p>
          </div>
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicHl0aG9uLWNyZWF0ZSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiUHl0aG9uIn1d">
            <div data-prop-text="title">Python</div>
            <p>To tell that a transaction is not in progress: when <code>transaction = current_transaction()</code> is run, <code>transaction</code> is <code>None</code>. Or, if <code>result = accept_distributed_trace_payload(payload)</code> is run, then the result is <code>False</code>.</p>
            <p>Use <a href="/docs/agents/python-agent/python-agent-api/background_task"><code>background_task</code></a> to report a <a href="/docs/apm/transactions/intro-transactions/monitor-background-processes-other-non-web-transactions#define">non-web transaction</a>. For more on Python instrumentation, see <a href="/docs/agents/python-agent/api-guides/guide-using-python-agent-api#transaction-segments">Monitor transactions and segments</a>.</p>
          </div>
          <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicnVieS1jcmVhdGUifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IlJ1YnkifV0=">
            <div data-prop-text="title">Ruby</div>
            <p>If you are using a Rack-based web framework and have enabled New Relic's Rack instrumentation, the Ruby agent will handle starting a transaction for you. For other use cases, see the <a href="/docs/agents/ruby-agent/api-guides/ruby-custom-instrumentation#transaction-tracers"><code>add_transaction_tracer</code> API method</a>.</p>
          </div>
        </div>
      </li>
      <li>
        <p>Extract the payload from the call that you received (for example, in a header).</p>
      </li>
      <li>
        <p>Invoke the call for accepting the payload: <a href="/docs/agents/c-sdk/instrumentation/enable-distributed-tracing-your-c-applications">C SDK</a> | <a href="/docs/agents/go-agent/features/distributed-tracing-go#create-manually">Go</a> | <a href="/docs/agents/java-agent/api-guides/guide-using-java-agent-api#trace-calls">Java</a> | <a href="/docs/agents/net-agent/net-agent-api/itransaction#AcceptDistributedTracePayload">.NET</a> | <a href="/docs/agents/php-agent/features/distributed-tracing-php#manual">PHP</a> | <a href="/docs/agents/nodejs-agent/api-guides/nodejs-agent-api#transaction-handle-acceptDistributedTracePayload">Node.js</a> | <a href="/docs/agents/python-agent/python-agent-api/accept_distributed_trace_payload">Python</a> | <a href="/docs/agents/ruby-agent/api-guides/guide-using-ruby-agent-api#distributed">Ruby</a>.</p>
      </li>
    </ol>
  </div>
</div>
