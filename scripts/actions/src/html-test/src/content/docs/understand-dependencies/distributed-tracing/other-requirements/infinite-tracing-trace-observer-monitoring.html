
<p>The New Relic Edge app offers trace observer monitoring so you can get additional insights into the sampling behavior of the trace observer. This optional feature shows you the amount of traces seen and kept by the trace observer. The trace observer metrics are written to the account you choose and available to view in the New Relic Edge app or in our query builder.</p>
<p>When you enable monitoring, the trace observer metrics can be written to any account in your New Relic account hierarchy. This allows you to control the visibility of the metrics. Before you turn it on, you need to decide which account should receive the trace observer metrics.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>If you enable this feature, you'll see a small additional monthly charge. To give you an idea of what charges you might incur, under the current pricing model, you could see an additional monthly charge of 1.6 cents based on the following:</p>
  <ul>
    <li>Number of metrics: 2</li>
    <li>Rate: Every 10 seconds</li>
    <li>Attribute count: 2-5</li>
  </ul>
</div>
<h2>Enable trace observer monitoring [#enable-monitoring]</h2>
<p>You can turn on trace observer monitoring by clicking a toggle in the New Relic Edge app. As soon as you enable trace observer monitoring, trace observer metrics are captured and displayed in the app or you can view them in query builder. Trace observer metrics are not retroactive and are only captured when trace observer monitoring is enabled.</p>
<ol>
  <li>Go to <a href="one.newrelic.com">one.newrelic.com</a> <strong>> Apps > Your apps > New Relic Edge</strong>.</li>
  <li>Use the account selector to choose the account you'll use for trace observer metrics.</li>
  <li>To enable, click the <strong>Trace observer monitoring</strong> toggle.</li>
</ol>
<h2>Switch trace observer monitoring accounts [#switch-accounts]</h2>
<p>If you decide at some point that you want to change which account receives the trace observer metrics, you can do this in the New Relic Edge app.</p>
<ol>
  <li>Go to <strong>Apps > Your apps > New Relic Edge</strong>.</li>
  <li>Use the account selector to switch to the account where you want trace observer metrics written.</li>
  <li>Click the toggle to disable trace observer monitoring.</li>
  <li>Click the toggle to re-enable trace observer monitoring in the current account.</li>
</ol>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>When trace observer monitoring is enabled or disabled an <code>NrAuditEvent</code> is written to the account where the change occurred. This event helps you keep track of any changes made to the trace observer.</p>
</div>
<h2>View trace observer metrics [#view-metrics]</h2>
<p>Anyone with access to the monitoring account can view the trace observer metrics in the Edge app or in our query builder.</p>
<p>If you don't have access to the monitoring account, you can't see any trace observer metrics in the Edge app or execute NRQL queries on these metrics. Here's what you see if you don't have access:</p>
<p>
  <img src="./images/trace_observer_monitoring_no_access.png" alt="Screenshot showing what appears in the Edge app if you don&#x27;t have access to the monitoring account that is receiving metrics." title="trace_observer_monitoring_no_access.png">
</p>
<h3>View in Edge app [#view-in-edge]</h3>
<p>When you turn on trace observer monitoring, trace observer metrics are added to the Edge app:</p>
<ul>
  <li>
    <p>Two columns are added to the main trace observer listing:</p>
    <ul>
      <li><strong>Traces Seen</strong>: How many traces were seen by the trace observer in the last 60 minutes.</li>
      <li><strong>Traces Kept</strong>: The number and percentage of traces that were retained.</li>
    </ul>
  </li>
  <li>
    <p>A new pane is added on the right side of the screen:</p>
    <ul>
      <li>
        <p><strong>Monitoring account</strong>: At the top of the right pane, this is the account where the trace observer metrics are written.</p>
      </li>
      <li>
        <p><strong>How many traces were kept?</strong> (top chart): Shows the same information as <strong>Traces Kept</strong>, but it shows you what this looks like over time. You can see the magnitude of sampling and any trends.</p>
        <p>
          <img src="./images/how_many_traces_kept.png" alt="Screenshot of graph showing how many traces were kept." title="how_many_traces_kept.png">
        </p>
      </li>
      <li>
        <p><strong>Which traces were kept?</strong> (bottom chart): Shows which categories of traces were kept. The chart shows whether traces were captured by different types of Infinite Tracing filters:</p>
        <ul>
          <li>Duration (slow traces)</li>
          <li>Random</li>
          <li>Span attribute filters (traces with errors or other attributes you specify)</li>
        </ul>
        <p>
          <img src="./images/which_traces_kept.png" alt="Screenshot of graph showing which traces were kept." title="which_traces_kept.png">
        </p>
      </li>
    </ul>
    <h3>View in query builder</h3>
    <p>If you prefer a programmatic way to view the metrics, here are some examples of NRQL queries. These examples replicate the two charts in the Edge app:</p>
    <p><strong>How many traces were kept?</strong> (top chart):</p>
    <pre><code>FROM Metric SELECT sum(monitoring.trace.opened.session.count) AS 'Traces seen', sum(monitoring.trace.sampled.count) AS 'Traces kept' WHERE account = INSERT_THE_MONITORING_ACCOUNT_ID TIMESERIES
</code></pre>
    <p><strong>Which traces were kept?</strong> (bottom chart):</p>
    <pre><code>FROM Metric SELECT sum(monitoring.trace.sampled.count) WHERE account = INSERT_THE_MONITORING_ACCOUNT_ID AND newRelic.traceFilter.type IS NOT NULL FACET newRelic.traceFilter.type LIMIT 3 TIMESERIES
</code></pre>
  </li>
</ul>
