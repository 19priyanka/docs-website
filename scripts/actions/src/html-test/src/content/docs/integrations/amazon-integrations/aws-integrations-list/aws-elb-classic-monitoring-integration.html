
<p><a href="/docs/infrastructure/integrations-getting-started/getting-started/introduction-infrastructure-integrations">New Relic infrastructure integrations</a> include an Amazon Elastic Classic Load Balancing (ELB) integration for reporting Classic ELB data to New Relic. This document explains the integration's features, how to activate it, and what data can be reported.</p>
<h2>Features</h2>
<p>New Relic's integration for <a href="https://aws.amazon.com/elasticloadbalancing/">Amazon Elastic Classic Load Balancing</a> (ELB) reports ELB data, including HTTP code message counts, healthy and unhealthy host counts, latency times, and ELB configuration states. AWS integration data is also available <a href="https://docs.newrelic.com/docs/infrastructure/infrastructure-integrations/getting-started/connect-aws-integrations-infrastructure#insights">for querying and chart creation in New Relic One</a>.</p>
<p>Amazon offers three types of load balancers: <a href="https://aws.amazon.com/elasticloadbalancing/classicloadbalancer/">Classic Load Balancer</a>, <a href="https://aws.amazon.com/elasticloadbalancing/">Application Load Balancer</a> (ALB), and <a href="https://aws.amazon.com/elasticloadbalancing/">Network Load Balancer</a> (NLB). New Relic also offers an <a href="/docs/infrastructure/amazon-integrations/aws-integrations-list/aws-alb-monitoring-integration">ALB/NLB integration</a> to monitor the last two types of load balancers.</p>
<h2>Activate integration [#activate]</h2>
<p>To enable this integration, follow standard procedures to <a href="https://docs.newrelic.com/docs/infrastructure/infrastructure-integrations/getting-started/connect-aws-integrations-infrastructure">connect AWS services to New Relic</a>.</p>
<h2>Configuration and polling [#polling]</h2>
<p>You can change the polling frequency and filter data using <a href="/docs/integrations/new-relic-integrations/getting-started/configure-polling-frequency-data-collection-cloud-integrations">configuration options</a>.</p>
<p><a href="/docs/infrastructure/amazon-integrations/aws-integrations-list/aws-polling-intervals-infrastructure-integrations">Default polling</a> information for the AWS ELB integration:</p>
<ul>
  <li>New Relic polling interval: 5 minutes</li>
  <li>Amazon CloudWatch data interval: 1 minute</li>
</ul>
<h2>View and use data [#find-data]</h2>
<p>To <a href="/docs/infrastructure/integrations/find-use-infrastructure-integration-data">view and use this integration's data</a>, go to <a href="http://one.newrelic.com"><strong>one.newrelic.com</strong></a> <strong>> Infrastructure > AWS</strong> and select one of the ELB integration links.</p>
<p>You can <a href="https://docs.newrelic.com/docs/using-new-relic/data/understand-data/query-new-relic-data">query and explore your data</a> using the <code>LoadBalancerSample</code> <a href="/docs/insights/use-insights-ui/getting-started/introduction-new-relic-insights#event-type">event type</a>, with a <code>provider</code> value of <code>Elb</code>.</p>
<h2>Metric data [#metrics]</h2>
<p>The integration collects the following metrics. For additional details about these metrics, see <a href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/elb-metricscollected.html#loadbalancing-metrics-clb">Amazon's ELB Classic Load Balancer metrics documentation</a>.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Name</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>backendConnectionErrors.Sum</code></p>
      </div>
      <div>
        <p>Rate of the number of connections per second that were not successfully established between the load balancer and the registered instances.</p>
        <p>The load balancer retries the connection when there are errors, so this count may exceed the request rate. This count also includes any connection errors related to health checks.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>healthyHostCount</code></p>
        <p><code>unHealthyHostCount</code></p>
      </div>
      <div>
        <p>The number of healthy or unhealthy instances registered with your load balancer. A newly registered instance is considered healthy after it passes the first health check.</p>
        <p>If cross-zone load balancing is enabled, the number of healthy instances for the <code>LoadBalancerName</code> dimension is calculated across all availability zones. Otherwise, it is calculated per availability zone.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>httpCodeBackend2XX</code></p>
        <p><code>httpCodeBackend3XX</code></p>
        <p><code>httpCodeBackend4XX</code></p>
        <p><code>httpCodeBackend5XX</code></p>
      </div>
      <div>
        <p>[HTTP listener] The number of HTTP response codes generated per second by registered instances. This count does not include any response codes generated by the load balancer.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>httpCodeElb4XX</code></p>
      </div>
      <div>
        <p>[HTTP listener] The number of HTTP <code>4XX</code> client error codes generated by the load balancer per minute. Client errors are generated when a request is malformed or incomplete.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>httpCodeElb5XX</code></p>
      </div>
      <div>
        <p>[HTTP listener] The number of HTTP <code>5XX</code> server error codes generated by the load balancer per minute. This count does not include any response codes generated by the registered instances. The metric is reported if there are no healthy instances registered to the load balancer, or if the request rate exceeds the capacity of the instances (spillover) or the load balancer.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>latency.Average</code></p>
        <p><code>latency.Maximum</code></p>
      </div>
      <div>
        <p>[HTTP listener] The total time elapsed, in seconds, from the time the load balancer sent the request to a registered instance until the instance started to send the response headers.</p>
        <p>[TCP listener] The total time elapsed, in seconds, for the load balancer to successfully establish a connection to a registered instance.</p>
        <p>Available statistics:</p>
        <ul>
          <li>aws.elb.latency.p90</li>
          <li>aws.elb.latency.p95</li>
          <li>aws.elb.latency.p99</li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p><code>requestCount</code></p>
      </div>
      <div>
        <p>The number of requests completed or connections made per second during the specified interval (1 or 5 minutes).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>spilloverCount</code></p>
      </div>
      <div>
        <p>The total number of requests that were rejected per second, due to the surge queue being full.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>surgeQueueLength.Average, Maximum, Minimum</code></p>
      </div>
      <div>
        <p>The total number of requests that are pending routing. The load balancer queues a request if it is unable to establish a connection with a healthy instance in order to route the request.</p>
        <p>The maximum size of the queue is 1,024. Additional requests are rejected when the queue is full. For more information, see <code>SpilloverCount</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>estimatedAlbActiveConnectionCount.Average, Maximum, Minimum</code></p>
      </div>
      <div>
        <p>The estimated number of concurrent TCP connections active from clients to the load balancer and from the load balancer to targets.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>estimatedAlbConsumedLcus.Average, Maximum, Minimum</code></p>
      </div>
      <div>
        <p>The estimated number of load balancer capacity units (LCU) used by an application load balancer.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>estimatedAlbNewConnectionCount.Average, Maximum, Minimum</code></p>
      </div>
      <div>
        <p>The estimated number of new TCP connections established from clients to the load balancer and from the load balancer to targets.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>estimatedProcessedBytes.Average, Maximum, Minimum</code></p>
      </div>
      <div>
        <p>The estimated number of bytes processed by an application load balancer.</p>
      </div>
    </div>
  </div>
</div>
<h2>Inventory data [#config]</h2>
<p>The following configuration options are available with the New Relic Amazon ELB integration.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Name</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>availabilityZone</code></p>
      </div>
      <div>
        <p>Lists one or more availability zones from the same region as the load balancer.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>awsRegion</code></p>
      </div>
      <div>
        <p>The AWS region that the load balancer runs in.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>canonicalHostedZoneNameId</code></p>
      </div>
      <div>
        <p>The ID of the Amazon Route 53 hosted zone name associated with the load balancer.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>canonicalHostedZoneName</code></p>
      </div>
      <div>
        <p>The name of the Amazon Route 53 hosted zone that is associated with the load balancer.</p>
        <p>If you specify <code>internal</code> for the Elastic Load Balancing scheme, use <code>DNSNameinstead</code>. For an <strong>internal scheme</strong>, the load balancer doesn't have a <code>CanonicalHostedZoneName</code> value.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>createdTime</code></p>
      </div>
      <div>
        <p>Timestamp with the date and time the load balancer was created.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>dnsName</code></p>
      </div>
      <div>
        <p>The public DNS name of the load balancer.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>instances</code></p>
      </div>
      <div>
        <p>A JSON string representing the list of IDs of EC2 instances associated with the load balancer.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>listeners</code></p>
      </div>
      <div>
        <p>A JSON string representing the list of <a href="http://docs.aws.amazon.com/elasticloadbalancing/2012-06-01/APIReference/API_Listener.html">Listeners</a> associated with the load balancer.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>loadBalancerName</code></p>
      </div>
      <div>
        <p>The name of the load balancer.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>scheme</code></p>
      </div>
      <div>
        <p>For load balancers attached to an <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Introduction.html">Amazon VPC</a>, this parameter can be used to specify the type of load balancer to use. For more information, see the <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-elb.html#aws-properties-ec2-elb-prop">AWS ElasticLoadBalancing documentation about LoadBalancer properties</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>securityGroups</code></p>
      </div>
      <div>
        <p>A JSON string representing the list of <a href="http://docs.aws.amazon.com/elasticloadbalancing/latest/classic/elb-security-groups.html#elb-vpc-security-groups">security groups</a> assigned to your load balancer within your <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Introduction.html">virtual private cloud (VPC)</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sourceSecurityGroup</code></p>
      </div>
      <div>
        <p>The <a href="http://docs.aws.amazon.com/elasticloadbalancing/latest/classic/elb-security-groups.html#elb-vpc-security-groups">security group</a> that you can use as part of your inbound rules for your load balancer's back-end Amazon EC2 application instances.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>subnets</code></p>
      </div>
      <div>
        <p>A JSON string representing the list of subnet IDs in your <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Introduction.html">virtual private cloud (VPC)</a> to attach to your load balancer. Do not specify multiple subnets that are in the same Availability Zone. You can specify the <code>AvailabilityZones</code> or <code>Subnets</code> property, but not both.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>vpcId</code></p>
      </div>
      <div>
        <p>The ID of the VPC that the load balancer has been configured in.</p>
      </div>
    </div>
  </div>
</div>
<h2>Child inventory data [#child-config]</h2>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>Data indicated with an asterisk <code>*</code> is only fetched if <a href="/docs/integrations/new-relic-integrations/getting-started/configure-polling-frequency-data-collection-cloud-integrations#extended">extended inventory collection</a> is on.</p>
</div>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Name</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>accessLog/enabled</code> *</p>
      </div>
      <div>
        <p>A boolean. If <code>true</code>, access logs are enabled for this load balancer.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>connectionDraining/enabled</code> *</p>
      </div>
      <div>
        <p>A boolean. Use connection draining to ensure that a Classic Load Balancer does not send requests to unhealthy instances. For more information, see the <a href="http://docs.aws.amazon.com/elasticloadbalancing/latest/classic/config-conn-drain.html">AWS documentation to configure connection draining for your Classic Load Balancer</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>connectionDraining/timeout</code> *</p>
      </div>
      <div>
        <p>The number of seconds the load balancer waits before forcibly closing connections to the de-registering instance. Valid values are <code>1</code> to <code>3600</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>connectionSettings/idleTimeout</code> *</p>
      </div>
      <div>
        <p>For more information, see the <a href="http://docs.aws.amazon.com/elasticloadbalancing/latest/classic/config-idle-timeout.html">AWS documentation to configure the idle connection timeout for your Classic Load Balancer</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>crossZoneLoadBalancing/enabled</code> *</p>
      </div>
      <div>
        <p>A boolean. For more information, see the <a href="http://docs.aws.amazon.com/elasticloadbalancing/latest/classic/enable-disable-crosszone-lb.html">AWS documentation to configure cross-zone load balancing for your Classic Load Balancer</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>healthCheck/healthyThreshold</code></p>
      </div>
      <div>
        <p>The number of consecutive successful health checks that must occur before declaring an EC2 instance healthy. Valid values: <code>2</code> to <code>10</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>healthCheck/interval</code></p>
      </div>
      <div>
        <p>The amount of time in seconds between health checks of an individual instance. Valid values: <code>5</code> to <code>300</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>healthCheck/target</code></p>
      </div>
      <div>
        <p>Combination of three properties:</p>
        <ul>
          <li>The protocol to use to connect with the instance. Valid values: <code>TCP</code>, <code>HTTP</code>, <code>HTTPS</code>, and <code>SSL</code>.</li>
          <li>The port to use to connect with the instance, as a <code>protocol:port</code> pair. If the load balancer fails to connect with the instance at the specified port within the configured response timeout period, the instance is considered unhealthy.</li>
          <li>The destination for the HTTP or HTTPS request.</li>
        </ul>
      </div>
    </div>
    <div>
      <div>
        <p><code>healthCheck/timeout</code></p>
      </div>
      <div>
        <p>The amount of time in seconds to wait when receiving a response from the health check. Valid values: <code>2</code> to <code>60</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>healthCheck/unhealthyThreshold</code></p>
      </div>
      <div>
        <p>The number of consecutive failed health checks that must occur before declaring an EC2 instance unhealthy. Valid values: <code>2</code> to <code>10</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>policies/otherPolicies</code></p>
      </div>
      <div>
        <p>JSON string representing security policies associated with this load balancer.</p>
      </div>
    </div>
  </div>
</div>
