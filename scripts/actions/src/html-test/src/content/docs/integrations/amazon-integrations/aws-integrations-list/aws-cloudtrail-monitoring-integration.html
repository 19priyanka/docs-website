
<p><a href="/docs/infrastructure/integrations-getting-started/getting-started/introduction-infrastructure-integrations">New Relic integrations</a> include an integration for reporting your AWS CloudTrail events to New Relic. This document explains how to activate this integration and describes the data that can be reported.</p>
<h2>Features</h2>
<p>This integration collects information from <a href="https://aws.amazon.com/documentation/cloudtrail/">AWS CloudTrail</a>, which captures and records AWS account activity, mainly for audit and governance purposes.</p>
<p>New Relic's AWS CloudTrail integration collects events that represent errors and AWS console logins. Errors give you awareness about API calls and services that have failed, and console logins help you monitor console activity and potential intrusion attempts.</p>
<p>Besides these two types of data, New Relic does not collect any other data. This is because other AWS CloudTrail data is already reported by New Relic in the form of inventory change <a href="/docs/integrations/new-relic-integrations/getting-started/understand-use-data-infrastructure-integrations#overview">events</a>.</p>
<h2>Activate integration [#requirements]</h2>
<p>To enable this integration follow standard procedures to <a href="https://docs.newrelic.com/docs/infrastructure/infrastructure-integrations/getting-started/connect-aws-integrations-infrastructure">Connect AWS services to New Relic</a>.</p>
<h2>Configuration and polling [#polling]</h2>
<p>You can change the polling frequency and filter data using <a href="/docs/integrations/new-relic-integrations/getting-started/configure-polling-frequency-data-collection-cloud-integrations">configuration options</a>.</p>
<p><a href="/docs/infrastructure/amazon-integrations/aws-integrations-list/aws-polling-intervals-infrastructure-integrations">Default polling</a> information for the AWS CloudTrail integration:</p>
<ul>
  <li>New Relic polling interval: 5 minutes</li>
</ul>
<h2>Find and use data [#find-data]</h2>
<p>To find your integration data in Infrastructure, go to <a href="http://one.newrelic.com"><strong>one.newrelic.com</strong></a> <strong>> Infrastructure > AWS</strong> and select one of the AWS CloudTrail integration links.</p>
<p>This integration does not provide metric or inventory data: only <a href="/docs/integrations/new-relic-integrations/getting-started/understand-use-data-infrastructure-integrations#overview">event data</a>. You can use Infrastructure's <a href="https://docs.newrelic.com/docs/infrastructure/new-relic-infrastructure/infrastructure-ui-pages/infrastructure-events-page-live-feed-every-config-change"><strong>Events</strong> page</a> to view a timeline of these events.</p>
<p>You can <a href="https://docs.newrelic.com/docs/using-new-relic/data/understand-data/query-new-relic-data">query and explore your data</a> using the <code>InfrastructureEvent</code> <a href="https://docs.newrelic.com/docs/insights/use-insights-ui/getting-started/introduction-new-relic-insights#event-type">event type</a>, with a <code>provider</code> value of <code>CloudTrail</code>.</p>
<p>For general information about how to find and use integration data, see <a href="/docs/infrastructure/integrations/find-use-infrastructure-integration-data">Understand integration data</a>.</p>
<h2>Event attributes</h2>
<p>Here are attributes that can be reported with CloudTrail events:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Metadata</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>awsRegion</code></p>
      </div>
      <div>
        <p>The AWS region the request was made of.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>cloudTrailEventType</code></p>
      </div>
      <div>
        <p>Identifies the type of event that generated the event record. This can be the one of the following values: <code>AwsApiCall</code>, <code>AwsServiceEvent</code>, <code>ConsoleSignin</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>errorCode</code></p>
      </div>
      <div>
        <p>The AWS service error (if the request returns an error). For a list of the most common errors, see the <a href="https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/CommonErrors.html">AWS CloudTrail documentation</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>errorMessage</code></p>
      </div>
      <div>
        <p>If the request returns an error, the description of the error.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>eventId</code></p>
      </div>
      <div>
        <p>The unique identifier of the event.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>eventName</code></p>
      </div>
      <div>
        <p>The requested action.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>eventSource</code></p>
      </div>
      <div>
        <p>The AWS service the request was made of.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sourceIpAddress</code></p>
      </div>
      <div>
        <p>The IP address from which the request was made.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>userAgent</code></p>
      </div>
      <div>
        <p>The agent through which the request was made, such as the AWS Management Console, an AWS service, the AWS SDKs, or the AWS CLI.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>userName</code></p>
      </div>
      <div>
        <p>The user name or role name of the requester that called the API in the event returned.</p>
      </div>
    </div>
  </div>
</div>
<h2>Query examples [#example-queries]</h2>
<p>You can use New Relic to run queries of AWS CloudTrail data, and optionally use New Relic alerts to set alerts on that data.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiYXBpLWZhaWxzIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJRdWVyeSBleGFtcGxlOiBDb3VudCBvZiBmYWlsZWQgQVBJIGNhbGxzIn1d">
    <div data-prop-text="title">Query example: Count of failed API calls</div>
    <p>Query for a count of failed API calls, aggregated by the AWS service that the request was made to:</p>
    <pre><code>SELECT count(*) from InfrastructureEvent WHERE provider = 'CloudTrail' 
    AND cloudTrailEventType = 'AwsApiCall' 
    FACET eventSource

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiYXBpLWZhaWxzIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJRdWVyeSBleGFtcGxlOiBDb3VudCBvZiBjb25zb2xlIGxvZ2luIGVycm9ycyJ9XQ==">
    <div data-prop-text="title">Query example: Count of console login errors</div>
    <p>Query to find all console login errors:</p>
    <pre><code>SELECT * from InfrastructureEvent WHERE provider = 'CloudTrail' 
    AND cloudTrailEventType = 'AwsConsoleSignIn' 
    AND errorMessage IS NOT NULL

</code></pre>
  </div>
</div>
