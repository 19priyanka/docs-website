
<p>The Varnish Cache <a href="https://docs.newrelic.com/docs/integrations/host-integrations/getting-started/introduction-host-integrations">on-host integration</a> collects and sends inventory and metrics from your Varnish Cache environment to New Relic so you can monitor its health. We collect metrics at the instance, lock, memory pool, storage, and backend levels.</p>
<p>Read on to install the integration, and to see what data we collect.</p>
<h2>Compatibility and requirements [#comp-req]</h2>
<p>Our integration is compatible with Varnish Cache 1.0 or higher.</p>
<p>Before installing the integration, make sure that you meet the following requirements:</p>
<ul>
  <li><a href="/docs/infrastructure/install-infrastructure-agent/get-started/install-infrastructure-agent-new-relic">Install the infrastructure agent</a>.</li>
  <li>Linux distribution or Windows version <a href="/docs/infrastructure/new-relic-infrastructure/getting-started/compatibility-requirements-new-relic-infrastructure">compatible with our infrastructure agent</a>.</li>
</ul>
<h2>Install and activate [#install]</h2>
<p>To install the Varnish Cache integration:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibGludXgtaW5zdGFsbCJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiTGludXggaW5zdGFsbGF0aW9uIn1d">
    <div data-prop-text="title">Linux installation</div>
    <ol>
      <li>
        <p>Follow the instructions for <a href="/docs/install-integrations-package">installing an integration</a>, using the file name <code>nri-varnish</code>.</p>
      </li>
      <li>
        <p>Change directory to the integrations folder:</p>
        <pre><code>cd /etc/newrelic-infra/integrations.d
</code></pre>
      </li>
      <li>
        <p>Copy of the sample configuration file:</p>
        <pre><code>sudo cp varnish-config.yml.sample varnish-config.yml
</code></pre>
      </li>
      <li>
        <p>Edit the <code>varnish-config.yml</code> file as described in the <a href="#config">configuration settings</a>.</p>
      </li>
      <li>
        <p><a href="https://docs.newrelic.com/docs/infrastructure/new-relic-infrastructure/configuration/start-stop-restart-check-infrastructure-agent-status">Restart the infrastructure agent</a>.</p>
      </li>
    </ol>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoid2luZG93cy1pbnN0YWxsIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJXaW5kb3dzIGluc3RhbGxhdGlvbiJ9XQ==">
    <div data-prop-text="title">Windows installation</div>
    <ol>
      <li>
        <p>Download the <code>nri-varnish</code> .MSI installer image from:</p>
        <p><a href="http://download.newrelic.com/infrastructure_agent/windows/integrations/nri-varnish/nri-varnish-amd64.msi">http://download.newrelic.com/infrastructure_agent/windows/integrations/nri-varnish/nri-varnish-amd64.msi</a></p>
      </li>
      <li>
        <p>To install from the Windows command prompt, run:</p>
        <pre><code>msiexec.exe /qn /i PATH\TO\nri-varnish-amd64.msi
</code></pre>
      </li>
      <li>
        <p>In the Integrations directory, <code>C:\Program Files\New Relic\newrelic-infra\integrations.d\</code>, create a copy of the sample configuration file by running:</p>
        <pre><code>cp varnish-config.yml.sample varnish-config.yml
</code></pre>
      </li>
      <li>
        <p>Edit the <code>varnish-config.yml</code> file as described in the <a href="#config">configuration settings</a>.</p>
      </li>
      <li>
        <p><a href="https://docs.newrelic.com/docs/infrastructure/new-relic-infrastructure/configuration/start-stop-restart-check-infrastructure-agent-status">Restart the infrastructure agent</a>.</p>
      </li>
    </ol>
  </div>
</div>
<p>Additional notes:</p>
<ul>
  <li><strong>Advanced:</strong> It's also possible to <a href="/docs/integrations/host-integrations/installation/install-host-integrations-built-new-relic#tarball">install the integration from a tarball file</a>. This gives you full control over the installation and configuration process.</li>
  <li><strong>On-host integrations do not automatically update.</strong> For best results, regularly <a href="/docs/integrations/host-integrations/installation/update-infrastructure-host-integration-package">update the integration package</a> and <a href="/docs/infrastructure/new-relic-infrastructure/installation/update-infrastructure-agent">the infrastructure agent</a>.</li>
</ul>
<h2>Configure the integration [#config]</h2>
<p>An integration's YAML-format configuration is where you can place required login credentials and configure how data is collected. Which options you change depend on your setup and preference.</p>
<p>For an example configuration, see the <a href="#example-config">example config file</a>.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>With secrets management, you can configure on-host integrations with New Relic Infrastructure's agent to use sensitive data (such as passwords) without having to write them as plain text into the integration's configuration file. For more information, see <a href="https://docs.newrelic.com/docs/integrations/host-integrations/installation/secrets-management">Secrets management</a>.</p>
</div>
<h3>Commands</h3>
<p>The <code>varnish-config.yml</code> file accepts the following commands:</p>
<ul>
  <li><code>all_data</code>: collects both inventory and metrics for the Varnish Cache environment.</li>
</ul>
<h3>Arguments</h3>
<p>The <code>varnish-config.yml</code> commands accept the following arguments:</p>
<ul>
  <li>
    <p><code>params_config_file</code>: The location of the <code>varnish.params</code> config file. If this argument is omitted, the following locations will be checked:</p>
    <ul>
      <li><code>/etc/default/varnish/varnish.params</code></li>
      <li><code>/etc/sysconfig/varnish/varnish.params</code></li>
    </ul>
    <p>Note: The location and name of the varnish configuration file may vary. For details, see <a href="https://book.varnish-software.com/4.0/chapters/Getting_Started.html#different-locations-of-the-varnish-configuration-file">Different locations of the Varnish configuration file</a>.</p>
  </li>
  <li>
    <p><code>instance_name</code>: User defined name to identify data from this instance in New Relic. <strong>Required</strong>.</p>
  </li>
</ul>
<h3>Example configuration [#example-config]</h3>
<p>Example <code>varnish-config.yml</code> file configuration:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZXhhbXBsZSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiRXhhbXBsZSBjb25maWd1cmF0aW9uIn1d">
    <div data-prop-text="title">Example configuration</div>
    <pre><code>integration_name: com.newrelic.varnish

instances:
  - name: varnish_all
    command: all_data
    arguments:
      params_config_file:  /etc/varnish/varnish.params
      instance_name: varnish-0.localnet
    labels:
      env: production
      role: varnish

</code></pre>
  </div>
</div>
<p>For more about the general structure of on-host integration configuration, see <a href="/docs/integrations/integrations-sdk/file-specifications/host-integration-configuration-overview">Configuration</a>.</p>
<h2>Find and use data [#find-and-use]</h2>
<p>To find your integration data in Infrastructure, go to <a href="http://one.newrelic.com"><strong>one.newrelic.com</strong></a> <strong>> Infrastructure > Third-party services</strong> and select one of the Varnish Cache integration links.</p>
<p>In <a href="/docs/insights">New Relic Insights</a>, Varnish Cache data is attached to the following Insights <a href="/docs/using-new-relic/welcome-new-relic/getting-started/glossary#event">event type</a>:</p>
<ul>
  <li><code>VarnishSample</code></li>
  <li><code>VarnishLockSample</code></li>
  <li><code>VarnishStorageSample</code></li>
  <li><code>VarnishMempoolSample</code></li>
  <li><code>VarnishBackendSample</code></li>
</ul>
<p>For more on how to find and use your data, see <a href="/docs/infrastructure/integrations/find-use-infrastructure-integration-data">Understand integration data</a>.</p>
<h2>Metric data [#metrics]</h2>
<p>The Varnish Cache integration collects the following metric data attributes. Each metric name is prefixed with a category indicator and a period, such as <code>bans.</code> or <code>main.</code>.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>A number of metrics are calculated as rates (per second) instead of totals as the metric names might suggest. For more details on which metrics are calculated as rates, refer to the <a href="https://github.com/newrelic/nri-varnish/blob/master/spec.csv">spec.csv file</a>.</p>
</div>
<h3>Varnish sample metrics [#varnish-sample]</h3>
<p>These attributes can be found by querying the VarnishSample event types in Insights.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Metric</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>backend.connectionBusy</code></p>
      </div>
      <div>
        <p>Number of times the maximum connection has been reached.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>backend.connectionFails</code></p>
      </div>
      <div>
        <p>Number of failed connections to the backed.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>backend.connectionRecycles</code></p>
      </div>
      <div>
        <p>Number of backend connections that have been recycled.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>backend.connectionRetries</code></p>
      </div>
      <div>
        <p>Number of backend connections that have been retried.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>backend.connectionReuses</code></p>
      </div>
      <div>
        <p>Number of backend connections reuses.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>backend.connectionSuccess</code></p>
      </div>
      <div>
        <p>Number of successful backend connections,</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>backend.connectionUnHealthy</code></p>
      </div>
      <div>
        <p>Number of backend connections that were not attempted due to ‘unhealthy’ backend status.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>backend.fetches</code></p>
      </div>
      <div>
        <p>Total number of backend fetches initiated.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>backend.requests</code></p>
      </div>
      <div>
        <p>Total number of backend connection requests made.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bans.added</code></p>
      </div>
      <div>
        <p>Counter of bans added to ban list.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bans.completed</code></p>
      </div>
      <div>
        <p>Number of bans marked ‘completed'.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bans.cutoffLurkerKilled</code></p>
      </div>
      <div>
        <p>Number of objects killed by bans for cutoff (lurker).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bans.deleted</code></p>
      </div>
      <div>
        <p>Counter of bans deleted from ban list.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bans.dups</code></p>
      </div>
      <div>
        <p>Count of bans replaced by later identical bans.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bans.fragmentationInBytes</code></p>
      </div>
      <div>
        <p>Extra bytes in persisted ban lists due to fragmentation.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bans.lookupKilled</code></p>
      </div>
      <div>
        <p>Number of objects killed by bans during object lookup.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bans.lookupTestsTested</code></p>
      </div>
      <div>
        <p>Count of how many tests and objects have been tested against each other during lookup.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bans.lurkerCon</code></p>
      </div>
      <div>
        <p>Number of times the ban-lurker had to wait for lookups.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bans.lurkerKilled</code></p>
      </div>
      <div>
        <p>Number of objects killed by the ban-lurker.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bans.lurkerTested</code></p>
      </div>
      <div>
        <p>Count of how many bans and objects have been tested against each other by the ban-lurker.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bans.lurkerTestsTested</code></p>
      </div>
      <div>
        <p>Count of how many tests and objects have been tested against each other during by the ban-lurker.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bans.obj</code></p>
      </div>
      <div>
        <p>Number of bans using <code>obj.*</code> variables. These bans can possibly be washed by the ban-lurker.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bans.persistedInBytes</code></p>
      </div>
      <div>
        <p>Bytes used by the persisted ban lists.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bans.req</code></p>
      </div>
      <div>
        <p>Number of bans which use <code>req.*</code> variables. These bans can not be washed by the ban-lurker.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>bans.tested</code></p>
      </div>
      <div>
        <p>Count of how many bans and objects have been tested against each other during hash lookup.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>cache.graceHits</code></p>
      </div>
      <div>
        <p>Count of cache hits with grace. A cache hit with grace is a cache hit where the object is expired. These hits also included in the <code>cache_hit</code> counter.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>cache.hits</code></p>
      </div>
      <div>
        <p>Number of times an object has been delivered to a client without fetching it from a backend server.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>cache.misses</code></p>
      </div>
      <div>
        <p>Number of times the object was fetched from the backend before delivering it to the client.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>cache.missHits</code></p>
      </div>
      <div>
        <p>Number of times a hit object was returned for a miss response.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>cache.passHits</code></p>
      </div>
      <div>
        <p>Number of times a hit object was returned for a pass response.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>esi.errors</code></p>
      </div>
      <div>
        <p>Edge Side Includes (ESI) parsing errors (unlock).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>esi.warnings</code></p>
      </div>
      <div>
        <p>Edge Side Includes (ESI) parse warnings (unlock).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>fetch.bad</code></p>
      </div>
      <div>
        <p>The <code>beresp.body</code> length/fetch could not be determined.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>fetch.chuncked</code></p>
      </div>
      <div>
        <p>The <code>beresp.body</code> chunked.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>fetch.contentLength</code></p>
      </div>
      <div>
        <p>The <code>beresp.body</code> with content-length.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>fetch.eof</code></p>
      </div>
      <div>
        <p>The <code>beresp.body</code> with EOF.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>fetch.failed</code></p>
      </div>
      <div>
        <p>The <code>beresp</code> failed.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>fetch.head</code></p>
      </div>
      <div>
        <p>The <code>beresp</code> with no body because the request is HEAD.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>fetch.noBody</code></p>
      </div>
      <div>
        <p>The <code>beresp</code> with no body.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>fetch.noBody1xx</code></p>
      </div>
      <div>
        <p>The <code>beresp</code> with no body because of 1XX response.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>fetch.noBody204</code></p>
      </div>
      <div>
        <p>The <code>beresp</code> with no body because of 204 response.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>fetch.noBody304</code></p>
      </div>
      <div>
        <p>The <code>beresp</code> with no body because of 304 response.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>fetch.noThreadFail</code></p>
      </div>
      <div>
        <p>The <code>beresp</code> fetch failed, no thread available.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>hcb.inserts</code></p>
      </div>
      <div>
        <p>Number of critical bit tree-based hash (HCB) inserts.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>hcb.lock</code></p>
      </div>
      <div>
        <p>Number of HCB lookups with lock.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>hcb.noLock</code></p>
      </div>
      <div>
        <p>Number of HCB lookups without lock.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>lru.limited</code></p>
      </div>
      <div>
        <p>Number of times more storage space was needed, but limit was reached.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>lru.moved</code></p>
      </div>
      <div>
        <p>Number of move operations done on the LRU list.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>lru.nuked</code></p>
      </div>
      <div>
        <p>Number of least recently used (LRU) objects forcefully evicted from storage to make room for a new object.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.backends</code></p>
      </div>
      <div>
        <p>Number of backends.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.bans</code></p>
      </div>
      <div>
        <p>Count of bans.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.busyKilled</code></p>
      </div>
      <div>
        <p>Number of requests killed after sleep on busy objhdr.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.busySleep</code></p>
      </div>
      <div>
        <p>Number of requests sent to sleep on busy objhdr.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.busyWakeup</code></p>
      </div>
      <div>
        <p>Number of requests woken after sleep on busy objhdr.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.expired</code></p>
      </div>
      <div>
        <p>Number of expired objects.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.expiredMailed</code></p>
      </div>
      <div>
        <p>Number of objects mailed to expiry thread.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.expiredReceived</code></p>
      </div>
      <div>
        <p>Number of objects received by expiry thread.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.gunzip</code></p>
      </div>
      <div>
        <p>Number of gunzip operations.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.gunzipTest</code></p>
      </div>
      <div>
        <p>Number of test gunzip operations.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.gzip</code></p>
      </div>
      <div>
        <p>Number of gzip operations.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.objectcores</code></p>
      </div>
      <div>
        <p>Number of objectcore structs made.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.objectheads</code></p>
      </div>
      <div>
        <p>Number of objected structs made.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.objects</code></p>
      </div>
      <div>
        <p>Number of object structs made.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.passedRequests</code></p>
      </div>
      <div>
        <p>Total pass-ed requests seen.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.pipeSessions</code></p>
      </div>
      <div>
        <p>Total pipe sessions seen.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.pools</code></p>
      </div>
      <div>
        <p>Number of thread pools.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.purgeObjects</code></p>
      </div>
      <div>
        <p>Number of purged objects.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.purgeOperations</code></p>
      </div>
      <div>
        <p>Number of purge operations executed.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.reqDropped</code></p>
      </div>
      <div>
        <p>Number of requests dropped.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.sessions</code></p>
      </div>
      <div>
        <p>Total number of sessions seen.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.sessQueueLength</code></p>
      </div>
      <div>
        <p>Length of session queue waiting for threads.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.summs</code></p>
      </div>
      <div>
        <p>Number of times per-thread statistics were summed into the global counters.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.syntheticResponses</code></p>
      </div>
      <div>
        <p>Total synthethic responses made.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.threads</code></p>
      </div>
      <div>
        <p>Total number of threads.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.threadsCreated</code></p>
      </div>
      <div>
        <p>Total number of threads created in all pools.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.threadsDestroyed</code></p>
      </div>
      <div>
        <p>Total number of threads destroyed in all pools.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.threadsFailed</code></p>
      </div>
      <div>
        <p>Number of times creating a thread failed.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.threadsLimited</code></p>
      </div>
      <div>
        <p>Number of times more threads were needed, but limit was reached in a thread pool.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.unresurrectedObjects</code></p>
      </div>
      <div>
        <p>Number of unresurrected objects.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.uptimeInMilliseconds</code></p>
      </div>
      <div>
        <p>The child process uptime, in milliseconds.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.vclAvailable</code></p>
      </div>
      <div>
        <p>Number of Varnish Configuration Languages (VCL) available.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.vclDiscarded</code></p>
      </div>
      <div>
        <p>Number of discarded VCLs.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.vclFails</code></p>
      </div>
      <div>
        <p>Number of VCL failures.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.vclLoaded</code></p>
      </div>
      <div>
        <p>Number of loaded VCLs in total.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>main.vmodsLoaded</code></p>
      </div>
      <div>
        <p>Number of loaded Varnish modules (VMOD).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mgt.childDied</code></p>
      </div>
      <div>
        <p>Number of times the child process has died due to signals.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mgt.childDump</code></p>
      </div>
      <div>
        <p>Number of times the child process has produced core dumps.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mgt.childExit</code></p>
      </div>
      <div>
        <p>Number of times the child process has been cleanly stopped.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mgt.childPanic</code></p>
      </div>
      <div>
        <p>Number of times the management process has caught a child panic.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mgt.childStart</code></p>
      </div>
      <div>
        <p>Number of times the child process has been started.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mgt.childStop</code></p>
      </div>
      <div>
        <p>Number of times the child process has been cleanly stopped.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mgt.uptimeInMilliseconds</code></p>
      </div>
      <div>
        <p>The management process uptime, in milliseconds.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.400Errors</code></p>
      </div>
      <div>
        <p>Number of client requests received, subject to 400 errors.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.417Errors</code></p>
      </div>
      <div>
        <p>Number of client requests received, subject to 417 errors</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.httpOverflow</code></p>
      </div>
      <div>
        <p>Number of HTTP header overflows.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.pipe.inInBytes</code></p>
      </div>
      <div>
        <p>Total number of bytes forwarded from clients in pipe sessions.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.pipe.outInBytes</code></p>
      </div>
      <div>
        <p>Total number of bytes forwarded to clients in pipe sessions.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.pipereq.headerInBytes</code></p>
      </div>
      <div>
        <p>Total request bytes received for piped sessions.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.request.bodyInBytes</code></p>
      </div>
      <div>
        <p>Total request body transmitted, in bytes.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.request.headerInBytes</code></p>
      </div>
      <div>
        <p>Total request headers transmitted, in bytes.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.requests</code></p>
      </div>
      <div>
        <p>Number of good client requests received.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.response.bodyInBytes</code></p>
      </div>
      <div>
        <p>Total response body transmitted, in bytes.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.response.headerInBytes</code></p>
      </div>
      <div>
        <p>Total response headers transmitted, in bytes.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.backendClose</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>RESP_CLOSE</code>, (Backend/VCL requested close).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.badClose</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>Error RX_BAD</code>, (Received bad req/resp).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.bodyFailClose</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>Error RX_BODY</code>, (Failure receiving req.body).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.clientClose</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>REM_CLOSE</code>, (Client closed).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.clientReqClose</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>REQ_CLOSE</code>, (Client requested close).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.closed</code></p>
      </div>
      <div>
        <p>Total number of sessions closed.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.closedError</code></p>
      </div>
      <div>
        <p>Total number of sessions closed with errors.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.dropped</code></p>
      </div>
      <div>
        <p>Number of sessions dropped for thread.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.eofTxnClose</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>TX_EOF</code>, (EOF transmission).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.errorTxnClose</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>TX_ERROR</code>, (Error transaction).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.herd</code></p>
      </div>
      <div>
        <p>Number of times the <code>timeout_linger</code> triggered.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.junkClose</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>RX_JUNK</code>, (Received junk data).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.overflowClose</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>RX_OVERFLOW</code>, (Received buffer overflow).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.overloadClose</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>OVERLOAD</code>, (Out of some resource).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.pipeOverflowClose</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>PIPE_OVERFLOW</code>, (Session pipe overflow).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.pipeTxnClose</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>TX_PIPE</code>, (Piped transaction).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.queued</code></p>
      </div>
      <div>
        <p>Number of sessions queued for thread.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.readAhead</code></p>
      </div>
      <div>
        <p>Session Read Ahead.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.requestHTTP10Close</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>REQ_HTTP10</code>, (Proto &#x3C; HTTP/1.1).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.requestHTTP20Close</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>REQ_HTTP20</code>, (HTTP2 not accepted).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.shortRangeClose</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>RANGE_SHORT</code>, (Insufficient data for range).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.timeoutClose</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>RX_TIMEOUT</code>, (Receive timeout).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>sess.vclFailClose</code></p>
      </div>
      <div>
        <p>Number of session closes with the error <code>VCL_FAILURE</code>, (VCL failure).</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>session.connections</code></p>
      </div>
      <div>
        <p>Count of sessions successfully accepted.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>session.drops</code></p>
      </div>
      <div>
        <p>Count of sessions silently dropped due to lack of worker thread.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>session.fail</code></p>
      </div>
      <div>
        <p>Count of failures to accept TCP connection.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>shm.contentions</code></p>
      </div>
      <div>
        <p>Number of shared memory (SHM) MTX contentions.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>shm.cycles</code></p>
      </div>
      <div>
        <p>Number of SHM cycles through buffer.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>shm.flushes</code></p>
      </div>
      <div>
        <p>Number of SHM flushes due to overflow.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>shm.records</code></p>
      </div>
      <div>
        <p>Number of SHM records.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>shm.writes</code></p>
      </div>
      <div>
        <p>Number of SHM writes.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>workspace.backendOverflow</code></p>
      </div>
      <div>
        <p>Number of times we ran out of space in <code>workspace_backend</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>workspace.clientOverflow</code></p>
      </div>
      <div>
        <p>Number of times we ran out of space in <code>workspace_client</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>workspace.deliveryFail</code></p>
      </div>
      <div>
        <p>Delivery failed due to insufficient workspace.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>workspace.sessionOverflow</code></p>
      </div>
      <div>
        <p>Number of times we ran out of space in <code>workspace_session</code>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>workspace.threadOverflow</code></p>
      </div>
      <div>
        <p>Number of times we ran out of space in <code>workspace_thread</code>.</p>
      </div>
    </div>
  </div>
</div>
<h3>Varnish lock sample metrics [#varnish-lock-sample]</h3>
<p>These attributes can be found by querying the <code>VarnishLockSample</code> event types in Insights.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Metric</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>lock.created</code></p>
      </div>
      <div>
        <p>Count of created locks.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>lock.destroyed</code></p>
      </div>
      <div>
        <p>Count of destroyed locks.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>lock.locks</code></p>
      </div>
      <div>
        <p>Count of lock operations.</p>
      </div>
    </div>
  </div>
</div>
<h3>Varnish storage sample metrics [#varnish-storage-sample]</h3>
<p>These attributes can be found by querying the <code>VarnishStorageSample</code> event types in Insights.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Metric</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>storage.allocFails</code></p>
      </div>
      <div>
        <p>Number of times the storage has failed to provide a storage segment.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>storage.allocInBytes</code></p>
      </div>
      <div>
        <p>Number of total bytes allocated by this storage.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>storage.allocOustanding</code></p>
      </div>
      <div>
        <p>Number of storage allocations outstanding.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>storage.allocReqs</code></p>
      </div>
      <div>
        <p>Number of times the storage has been asked to provide a storage segment.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>storage.availableInBytes</code></p>
      </div>
      <div>
        <p>Number of bytes left in the storage.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>storage.freeInBytes</code></p>
      </div>
      <div>
        <p>Number of total bytes returned to this storage.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>storage.outstandingInBytes</code></p>
      </div>
      <div>
        <p>Number of bytes allocated from the storage.</p>
      </div>
    </div>
  </div>
</div>
<h3>Varnish mempool sample metrics [#varnish-mempool-sample]</h3>
<p>These attributes can be found by querying the <code>VarnishMempoolSample</code> event types in Insights.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Metric</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>mempool.allocatedSizeInBytes</code></p>
      </div>
      <div>
        <p>Allocated size of memory pool, in bytes.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mempool.allocs</code></p>
      </div>
      <div>
        <p>Memory pool allocations.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mempool.frees</code></p>
      </div>
      <div>
        <p>Number of memory pools free.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mempool.live</code></p>
      </div>
      <div>
        <p>Number of memory pools in use.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mempool.pool</code></p>
      </div>
      <div>
        <p>Count in memory pool.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mempool.ranDry</code></p>
      </div>
      <div>
        <p>Pool ran dry.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mempool.recycles</code></p>
      </div>
      <div>
        <p>Recycled from pool.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mempool.requestSizeInBytes</code></p>
      </div>
      <div>
        <p>Request size of memory pool, in bytes.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mempool.surplus</code></p>
      </div>
      <div>
        <p>Too many for pool.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mempool.timeouts</code></p>
      </div>
      <div>
        <p>Timed out from pool.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>mempool.tooSmall</code></p>
      </div>
      <div>
        <p>Too small to recycle.</p>
      </div>
    </div>
  </div>
</div>
<h3>Varnish backend sample metrics [#varnish-backend-sample]</h3>
<p>These attributes can be found by querying the <code>VarnishBackendSample</code> event types in Insights.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Metric</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>backend.busyFetches</code></p>
      </div>
      <div>
        <p>Fetches not attempted due to backend being busy.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>backend.connections</code></p>
      </div>
      <div>
        <p>Number of concurrent connections to the backend.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>backend.connectionsFailed</code></p>
      </div>
      <div>
        <p>Number of backend connections failed.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>backend.connectionsNotAttempted</code></p>
      </div>
      <div>
        <p>Number of backend connection opens not attempted.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>backend.happy</code></p>
      </div>
      <div>
        <p>Happy health probes.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>backend.unhealtyFetches</code></p>
      </div>
      <div>
        <p>Fetches not attempted due to backend being unhealthy</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.backend.pipeHeaderInBytes</code></p>
      </div>
      <div>
        <p>Total request bytes sent for piped sessions.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.backend.pipeInInBytes</code></p>
      </div>
      <div>
        <p>Total number of bytes forwarded from backend in pipe sessions.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.backend.pipeOutInBytes</code></p>
      </div>
      <div>
        <p>Total number of bytes forwarded to backend in pipe sessions.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.backend.requestBodyInBytes</code></p>
      </div>
      <div>
        <p>Total backend request body bytes sent.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.backend.requestHeaderInBytes</code></p>
      </div>
      <div>
        <p>Total backend request header bytes sent.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.backend.requests</code></p>
      </div>
      <div>
        <p>Number of backend requests sent,</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.backend.responseBodyInBytes</code></p>
      </div>
      <div>
        <p>Total backend response body bytes received.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>net.backend.responseHeaderInBytes</code></p>
      </div>
      <div>
        <p>Total backend response header bytes received.</p>
      </div>
    </div>
  </div>
</div>
<h2>Inventory data [#inventory]</h2>
<p>The Varnish Cache integration captures the configuration parameters. It parses the <code>varnish.params</code> configuration file for all parameters that are active.</p>
<p>The data is available on the <a href="/docs/infrastructure/new-relic-infrastructure/infrastructure-ui-pages/infrastructure-inventory-page-search-your-entire-infrastructure">Inventory page</a>, under the <strong>config/varnish</strong> source. For more about inventory data, see <a href="/docs/infrastructure/integrations-getting-started/getting-started/understand-integration-data-data-types#inventory-data">Understand integration data</a>.</p>
<h2>Check the source code [#source-code]</h2>
<p>This integration is open source software. That means you can <a href="https://github.com/newrelic/nri-varnish" title="Link opens in a new window.">browse its source code</a> and send improvements, or create your own fork and build it.</p>
