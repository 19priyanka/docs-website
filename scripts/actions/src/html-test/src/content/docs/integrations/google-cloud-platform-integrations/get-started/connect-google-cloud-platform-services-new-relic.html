
<p>To start receiving Google Cloud Platform (GCP) data with <a href="/docs/introduction-google-cloud-platform-integrations">New Relic GCP integrations</a>, connect your Google project to New Relic <a href="/docs/infrastructure">infrastructure monitoring</a>.</p>
<h2>Requirements [#authentication]</h2>
<p>These are the requirements for the authorization:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p><strong>GCP integration requirements</strong></p>
      </div>
      <div>
        <p><strong>Comments</strong></p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>Monitoring</p>
      </div>
      <div>
        <p>In the GCP project <strong>API &#x26; Services Library</strong> settings, you must enable <strong>Google Stackdriver Monitoring API</strong>.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Authorization</p>
      </div>
      <div>
        <p><strong>For <a href="#service">service account</a> authorization (recommended):</strong></p>
        <p>A user with Project IAM Admin role is needed to add the service account ID as a member in your GCP project.</p>
        <p>In the GCP project <strong>IAM &#x26; admin</strong>, the service account must have the <strong>Project</strong> <strong>Viewer</strong> role or, alternatively, a <a href="https://docs.newrelic.com/docs/integrations/google-cloud-platform-integrations/get-started/integrations-custom-roles">custom role</a>.</p>
      </div>
    </div>
    <div>
      <div>
        <p><strong>For <a href="#user">user account</a> authorization:</strong></p>
        <p>The New Relic user that will integrate the GCP project must have a Google account and must be able to view the GCP project that New Relic will monitor.</p>
        <p>In the GCP project <strong>IAM &#x26; admin</strong>, the user must have the <strong>Project Viewer</strong> role.</p>
        <p>Please note that this authorization method will not allow New Relic to collect labels and other inventory attributes that can be useful for narrowing down your NRQL queries, dashboards and alerts.</p>
        <p>You can migrate the authorization method from user account to service account from the <strong>Manage services</strong> link in New Relic's user interface.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Project name</p>
      </div>
      <div>
        <p>As part of the <a href="#connect">online setup process</a>, you must identify <code>Project name</code> of the projects you want to monitor with New Relic. The UI workflow automatically lists active projects you can select.</p>
      </div>
    </div>
    <div>
      <div>
        <p>Permissions (only for user account authorization)</p>
      </div>
      <div>
        <p>New Relic requires a specific set of read-only permissions exclusively; this means that, for certain integrations, only partial inventory data will be available.</p>
        <p>Keep in mind that New Relic doesn't inherit your Google account's permissions and therefore is not authorized to perform any changes in the project.</p>
        <p>For more information about the API permissions that New Relic uses, see the <a href="https://developers.google.com/identity/protocols/googlescopes">Google documentation about scopes</a>.</p>
      </div>
    </div>
  </div>
</div>
<h2>Authorization options [#authorization]</h2>
<p>Integrating your GCP project with New Relic requires you to authorize New Relic to fetch monitoring data from your GCP project. You can choose between two authorization methods: <strong>Service accounts</strong> or <strong>User accounts</strong>.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoic2VydmljZSJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiU2VydmljZSBhY2NvdW50IChyZWNvbW1lbmRlZCkifV0=">
    <div data-prop-text="title">Service account (recommended)</div>
    <p>The service account authorization is recommended.</p>
    <p>If you authorize New Relic to fetch data through a service account, we will call your GCP project APIs using a service account ID and its associated public/private key pair.</p>
    <p>New Relic manages a specific Google service account for your New Relic account; you do not need to create it or manage the associated private key. Just add the service account ID as a member with viewing permissions in your project.</p>
    <p>This authorization method is recommended, especially if your GCP project is managed by a team. It also guarantees that New Relic will collect labels and inventory attributes whenever possible.</p>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoidXNlciJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiVXNlciBhY2NvdW50In1d">
    <div data-prop-text="title">User account</div>
    <p>If you authorize New Relic to fetch data through a user account, New Relic will access your GCP project monitoring data on behalf of a particular Google user.</p>
    <p>The authorization process is achieved through an OAuth workflow, which redirects you from the New Relic UI to a Google authorization interface. However, since the authorization is linked to a particular Google user, this method is not recommended for GCP projects that are managed by large teams.</p>
  </div>
</div>
<h2>Connect GCP to New Relic infrastructure monitoring [#connect]</h2>
<p>To connect your Google account to New Relic with user account authorization:</p>
<ol>
  <li>
    <p>Go to <a href="http://one.newrelic.com"><strong>one.newrelic.com</strong></a> <strong>> Infrastructure > GCP</strong>. At the top of Infrastructure's <strong>Google Cloud Services</strong> integrations page, select <strong>Add a GPC account</strong>.</p>
  </li>
  <li>
    <p><strong>Choose Authorization Method</strong>: Select either <strong>Authorize a <a href="#service">Service Account</a></strong> or <strong>Authorize a <a href="#user">User Account</a></strong>, and follow the instructions in the UI to authorize New Relic.</p>
  </li>
  <li>
    <p><strong>Add projects:</strong> Select the projects that you want New Relic to receive data from.</p>
  </li>
  <li>
    <p><strong>Select services:</strong> From the list of available services for your GCP account, select the individual services you want New Relic to receive data from, or select all of the services.</p>
    <div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
      <p>These services will be enabled for <strong>all</strong> of the projects that you selected in the previous step. Once the setup process is finished, you can fine-tune the services that you want monitored for each project individually.</p>
    </div>
  </li>
  <li>
    <p>To complete the setup process, select <strong>Finish</strong>.</p>
  </li>
</ol>
<p>If you see API authentication errors, follow the <a href="https://docs.newrelic.com/docs/gcp-integration-api-authentication-errors">troubleshooting procedures</a>.</p>
<h2>Explore app data in New Relic [#find-data]</h2>
<p>After you authorize New Relic to integrate one or more of your Google project's services, New Relic starts monitoring your GCP data at regular polling intervals. After a few minutes, data will appear in the New Relic UI. To <a href="/docs/infrastructure/integrations/find-use-infrastructure-integration-data">find and use your data</a>, including links to dashboards and alert settings, go to <a href="http://one.newrelic.com"><strong>one.newrelic.com</strong></a> <strong>> Infrastructure > GCP</strong>.</p>
<h2>Link multiple Google projects [#connect-mulitple]</h2>
<p>For your convenience, the setup process allows you to select more than one project at a time.</p>
<p>After the first setup, if you need to monitor additional GCP projects with New Relic, you can repeat the procedure to <a href="#connect">connect your GCP services</a> as many times as you need.</p>
<h2>Unlink your GCP integrations [#disconnect]</h2>
<p>You can <a href="/docs/infrastructure/new-relic-infrastructure/installation/uninstall-infrastructure-agent#disable-integrations">disable any of your GCP integrations</a> any time and still keep your Google project connected to New Relic.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p><strong>If you want to...</strong></p>
      </div>
      <div>
        <p><strong>Do this</strong></p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>Disable a GCP service monitoring</p>
      </div>
      <div>
        <p>To disconnect individual GCP services but keep the integration with New Relic for other GCP services in your Google account:</p>
        <ol>
          <li>Go to <a href="http://one.newrelic.com"><strong>one.newrelic.com</strong></a> <strong>> Infrastructure > GCP</strong> and select <strong>Manage services</strong>.</li>
          <li>From your GCP account page, make changes to the checkbox options for available services and select <strong>Save changes</strong>.</li>
        </ol>
      </div>
    </div>
    <div>
      <div>
        <p>Unlink your project monitoring</p>
      </div>
      <div>
        <p>To uninstall all of your GCP services completely from New Relic Integrations, unlink your Google account:</p>
        <ol>
          <li>Go to <a href="http://one.newrelic.com"><strong>one.newrelic.com</strong></a> <strong>> Infrastructure > GCP</strong> and select <strong>Manage services</strong>.</li>
          <li>From your GCP account page, select <strong>Unlink account</strong> and select <strong>Save changes</strong>.</li>
        </ol>
      </div>
    </div>
    <div>
      <div>
        <p>Clean your GCP Projects after unlinking New Relic</p>
      </div>
      <div>
        <p>To clean your GCP project after unlinking, follow these steps if you were using a service account:</p>
        <ol>
          <li>
            <p>Open the GCP IAM Console.</p>
          </li>
          <li>
            <p>Select the project you want to unlink from New Relic and click Open.</p>
          </li>
          <li>
            <p>Select the service account that is used by New Relic.</p>
          </li>
          <li>
            <p>Click the <strong>Remove</strong> icon.</p>
            <p>Or follow these steps if you were using a user account:</p>
          </li>
          <li>
            <p>Open your Google user account settings.</p>
          </li>
          <li>
            <p>Open the <strong>Apps with access to your account</strong> section.</p>
          </li>
          <li>
            <p>Choose <strong>New Relic</strong> application.</p>
          </li>
          <li>
            <p>Choose <strong>Remove Access</strong>.</p>
          </li>
        </ol>
      </div>
    </div>
  </div>
</div>
