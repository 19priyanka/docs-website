
<p><a href="/docs/infrastructure/integrations-getting-started/getting-started/introduction-infrastructure-integrations">New Relic infrastructure integrations</a> include an integration for reporting your Amazon API Gateway data to New Relic. This document explains how to activate this integration and describes the data that can be reported.</p>
<h2>Features</h2>
<p><a href="https://aws.amazon.com/api-gateway/">Amazon's API Gateway</a> is a fully managed service that allows you to create, publish, maintain, monitor, and secure APIs at any scale. With the New Relic API Gateway integration, you get more data about how your API layer is working behind the scenes. You'll receive metric data about the number of API calls, the requests served, the number of errors, latency counts, and more.</p>
<p>You can monitor and alert on your API Gateway data directly from <a href="/docs/infrastructure">New Relic</a>, and query data and create dashboards.</p>
<h2>Requirements [#requierments]</h2>
<p>API Gateway will not send "Call count by resource", "4xx error by resource" and "5xx errors by resource" metrics unless you have explicitly enabled detailed CloudWatch metrics.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>Enabling these metrics may add additional charges to your <a href="https://aws.amazon.com/cloudwatch/pricing/">Amazon CloudWatch account pricing</a>.</p>
</div>
<p>To enable CloudWatch metrics, use either of these options:</p>
<ul>
  <li>Go to the AWS Management Console, select the <strong>Settings</strong> option for CloudWatch, then select the option to enable detailed CloudWatch metrics.</li>
  <li>Call the <code>stage:update</code> action of the Amazon API Gateway REST API to update the <a href="https://docs.aws.amazon.com/apigateway/api-reference/resource/stage/#metricsEnabled"><code>metricsEnabled</code></a> property to <code>true</code>.</li>
</ul>
<h2>Activate integration [#activate]</h2>
<p>To enable this integration follow standard procedures to <a href="https://docs.newrelic.com/docs/infrastructure/infrastructure-integrations/getting-started/connect-aws-integrations-infrastructure">Connect AWS services to New Relic</a>.</p>
<h2>Configuration and polling [#polling]</h2>
<p>You can change the polling frequency and filter data using <a href="/docs/integrations/new-relic-integrations/getting-started/configure-polling-frequency-data-collection-cloud-integrations">configuration options</a>.</p>
<p>Default <a href="/docs/infrastructure/amazon-integrations/aws-integrations-list/aws-polling-intervals-infrastructure-integrations">polling</a> information for the Amazon API gateway integration:</p>
<ul>
  <li>New Relic polling interval: 5 minutes</li>
  <li>Amazon CloudWatch data interval: 1 minute</li>
</ul>
<h2>Find and use data [#find-data]</h2>
<p>To find your integration data in Infrastructure, go to <a href="http://one.newrelic.com"><strong>one.newrelic.com</strong></a> <strong>> Infrastructure > AWS</strong> and select one of the API Gateway integration links.</p>
<p>You can <a href="https://docs.newrelic.com/docs/using-new-relic/data/understand-data/query-new-relic-data">query and explore your data</a> using the <code>ApiGatewaySample</code> <a href="/docs/insights/use-insights-ui/getting-started/introduction-new-relic-insights#event-type">event type</a>.</p>
<p>For more on how to use your data, see <a href="/docs/infrastructure/integrations/find-use-infrastructure-integration-data">Understand and use integration data</a>.</p>
<h2>Metric data [#metrics]</h2>
<p>This New Relic infrastructure integration collects the following Amazon API Gateway data:</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Metric</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>4XXError</code></p>
      </div>
      <div>
        <p>The number of client-side errors captured</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>5XXError</code></p>
      </div>
      <div>
        <p>The number of server-side errors captured.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>CacheHitCount</code></p>
      </div>
      <div>
        <p>The number of requests served from the API cache.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>CacheMissCount</code></p>
      </div>
      <div>
        <p>The number of requests served from the back end when API caching is enabled.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>Count</code></p>
      </div>
      <div>
        <p>The number of calls to API methods.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>IntegrationLatency</code></p>
      </div>
      <div>
        <p>The time in milliseconds between when API Gateway relays a request to the back end and when it receives a response from the back end.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>Latency</code></p>
      </div>
      <div>
        <p>The time in milliseconds between when API Gateway receives a request from a client and when it returns a response to the client. The latency includes the integration latency and other API Gateway overhead.</p>
      </div>
    </div>
  </div>
</div>
<h2>Inventory data [#inventory]</h2>
<p>Inventory data provides information about the service's state and configuration. API Gateway configuration options are reported as inventory data. For more about inventory data, see <a href="/docs/infrastructure/integrations-getting-started/getting-started/understand-integration-data-data-types#inventory-data">Understand and use data</a>.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Object</p>
      </div>
      <div>
        <p>Inventory data</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><strong>/aws/apigateway/api</strong></p>
      </div>
      <div>
        <p><code>apiId</code></p>
        <p><code>apiName</code></p>
        <p><code>awsRegion</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><strong>/aws/apigateway/resource</strong></p>
      </div>
      <div>
        <p><code>awsRegion</code></p>
        <p><code>methods</code></p>
        <p><code>resource</code></p>
        <p><code>resourceid</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><strong>/aws/apigateway/stage</strong></p>
      </div>
      <div>
        <p><code>apiName</code></p>
        <p><code>awsRegion</code></p>
        <p><code>cacheClusterEnable</code></p>
        <p><code>cacheClusterSize</code></p>
        <p><code>cacheClusterStatus</code></p>
        <p><code>lastUpdatedDate</code></p>
        <p><code>stageName</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><strong>/aws/apigateway/stage/variables</strong></p>
      </div>
      <div>
        <p><code>value</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><strong>/aws/apigateway/stage/settings</strong></p>
      </div>
      <div>
        <p><code>CacheDataEncrypted</code></p>
        <p><code>CacheTtlInSeconds</code></p>
        <p><code>CachingEnabled</code></p>
        <p><code>DataTraceEnabled</code></p>
        <p><code>LoginLevel</code></p>
        <p><code>MetricsEnabled</code></p>
        <p><code>RequireAuthorizationForCacheControl</code></p>
        <p><code>UnauthorizedCacheControlHeaderStrategy</code></p>
        <p><code>ThrottlingBurstLimit</code></p>
        <p><code>ThrottlingRateLimit</code></p>
      </div>
    </div>
    <div>
      <div>
        <p><strong>/aws/apigateway/stage/resource-with-metrics</strong></p>
      </div>
      <div>
        <p><code>apiName</code></p>
        <p><code>awsRegion</code></p>
        <p><code>method</code></p>
        <p><code>resource</code></p>
        <p><code>stageName</code></p>
      </div>
    </div>
  </div>
</div>
<h2>Dimensions</h2>
<p>You can use the <a href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/APIReference/API_Dimension.html">dimensions</a> in the following table to filter API Gateway metrics.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p>Dimensions</p>
      </div>
      <div>
        <p>Description</p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p><code>ApiName</code></p>
      </div>
      <div>
        <p>Filters API Gateway metrics for an API of the specified API name.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>ApiName</code>, <code>Method</code>, <code>Resource</code>, <code>Stage</code></p>
      </div>
      <div>
        <p>Filters API Gateway metrics for an API method of the specified API, stage, resource, and method.</p>
      </div>
    </div>
    <div>
      <div>
        <p><code>ApiName</code>, <code>Stage</code></p>
      </div>
      <div>
        <p>Filters API Gateway metrics for an API stage of the specified API and stage.</p>
      </div>
    </div>
  </div>
</div>
