
<h2>Problem</h2>
<p>You created a custom New Relic Infrastructure on-host integration using the <a href="/docs/integrations/integrations-sdk/getting-started/introduction-infrastructure-integrations-sdk">Integrations SDK</a>, but you're not seeing data in the Infrastructure UI.</p>
<h2>Solution</h2>
<p>To troubleshoot and resolve the problem:</p>
<ol>
  <li>Verify that your integration meets New Relic Infrastructure's <a href="#requirements">integration requirements</a>.</li>
  <li>After ruling out common problems with integration requirements, follow the more in-depth troubleshooting procedures for <a href="#check-errors">error logs</a> and <a href="#check-loading">integration loading</a>.</li>
</ol>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicmVxdWlyZW1lbnRzIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJUcm91Ymxlc2hvb3QgaW50ZWdyYXRpb24gcmVxdWlyZW1lbnRzIn1d">
    <div data-prop-text="title">Troubleshoot integration requirements</div>
    <p>If you are not receiving data from your custom integration, verify that your integration follows these requirements.</p>
    <div data-component="Table" data-prop="W10=">
      <div>
        <div>
          <div>
            <p>Integration requirements</p>
          </div>
          <div>
            <p>Comments</p>
          </div>
        </div>
      </div>
      <div>
        <div>
          <div>
            <p>Environment</p>
          </div>
          <div>
            <p>Make sure your environment meets the <a href="/docs/compatibility-requirements-infrastructure-integration-sdk">Integrations SDK requirements</a>.</p>
          </div>
        </div>
        <div>
          <div>
            <p>Configuration file</p>
          </div>
          <div>
            <ol>
              <li>Use a validator such as <a href="http://www.yamllint.com/">yamllint</a> to verify that the configuration file is a valid YAML file.</li>
              <li>Verify that the file is in the <a href="/docs/infrastructure/integrations-sdk/get-started/create-activate-infrastructure-integration#placement-naming">correct location</a>.</li>
            </ol>
          </div>
        </div>
        <div>
          <div>
            <p>Definition file</p>
          </div>
          <div>
            <ol>
              <li>Use a validator such as <a href="http://www.yamllint.com/">yamllint</a> to verify that the definition file is a valid YAML file.</li>
              <li>Verify that the header fields have the <a href="/docs/infrastructure/integrations-sdk/file-specifications/integration-definition-file-specifications#def-header">required format</a>.</li>
              <li>Verify that the <a href="/docs/infrastructure/integrations-sdk/file-specifications/integration-definition-file-specifications#def-commands">prefix for inventory</a> set in the definition file is no more than two levels deep.</li>
              <li>Verify that the file is in the <a href="/docs/infrastructure/integrations-sdk/get-started/create-activate-infrastructure-integration#placement-naming">correct location</a>.</li>
            </ol>
          </div>
        </div>
        <div>
          <div>
            <p>Metric sets</p>
          </div>
          <div>
            <p>Verify that the integration:</p>
            <ul>
              <li>Does not generate metric sets with more than 120 key-value pairs.</li>
              <li>Does not generate more than 1000 metric sets.</li>
            </ul>
          </div>
        </div>
        <div>
          <div>
            <p>JSON payload</p>
          </div>
          <div>
            <p>Verify that the integration does not generate a single JSON payload of more than 5 MB.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY2hlY2stZXJyb3JzIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJDaGVjayB0aGUgaW50ZWdyYXRpb24gbG9nIGZpbGUgZm9yIGVycm9yIG1lc3NhZ2VzIn1d">
    <div data-prop-text="title">Check the integration log file for error messages</div>
    <p>After ruling out common problems with <a href="#requirements">integration requirements</a>, follow these more in-depth troubleshooting procedures.</p>
    <p><strong>Recommendation:</strong> <a href="/docs/infrastructure/new-relic-infrastructure/troubleshooting/generating-logs-troubleshooting-infrastructure">Configure a log file</a> in the Infrastructure agent configuration. This helps separate the types of errors so you can spot integration errors more easily.</p>
    <p>When there is an error loading or running your integration, the Infrastructure agent adds an error message to the log file. Errors are logged even if <code>verbose</code> mode is disabled.</p>
    <ol>
      <li>Check the log file for lines that include <code>"level=error"</code>.</li>
      <li>If there are no error messages, check whether the Infrastructure agent is <a href="#check-loading">loading the integration correctly</a>.</li>
    </ol>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY2hlY2stbG9hZGluZyJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiQ2hlY2sgdGhhdCB0aGUgaW50ZWdyYXRpb24gaXMgbG9hZGluZyBjb3JyZWN0bHkifV0=">
    <div data-prop-text="title">Check that the integration is loading correctly</div>
    <p>To verify whether the Infrastructure agent is loading the integration correctly:</p>
    <ol>
      <li>
        <p>Enable <a href="/docs/infrastructure/new-relic-infrastructure/troubleshooting/generating-logs-troubleshooting-infrastructure"><code>verbose</code> mode</a> in the Infrastructure agent configuration.</p>
      </li>
      <li>
        <p><a href="/docs/infrastructure/new-relic-infrastructure/configuration/start-stop-restart-check-infrastructure-agent-status">Restart the Infrastructure agent</a>.</p>
      </li>
      <li>
        <p>Verify that the first lines of the log file contain two messages:</p>
        <pre><code>"loaded plugin" plugin=&#x3C;your_integration_name>
"found plugin config file" plugin-path="&#x3C;your_integration_config_path>"
</code></pre>
      </li>
      <li>
        <p>Check for errors just before or after these lines that indicate a problem with loading.</p>
        <p>The agent schedules data to be sent based on the schedule set in the definition file. Look in the log file for the integration's JSON.</p>
        <p><strong>JSON payload example</strong></p>
        <pre><code>nginx-server-metrics: {\"name\":\"com.newrelic.nginx\",\"protocol_version\":\"1\",\"integration_version\":\"0.5.0\",\"metrics\":
[{\"event_type\":\"NginxSample\",\"net.connectionsAcceptedPerSecond\":0.10344827586206896,\"net.connectionsActive\":1,
\"net.connectionsDroppedPerSecond\":0,\"net.connectionsReading\":0,\"net.connectionsWaiting\":0,\"net.connectionsWriting\":1,
\"net.requestsPerSecond\":0.10344827586206896,\"software.edition\":\"open source\",\"software.version\":\"1.4.6 (Ubuntu)\"}],\"inventory\":{},\"events\":[]}
</code></pre>
      </li>
    </ol>
  </div>
</div>
