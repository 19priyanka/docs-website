
<p>You can use synthetic monitoring's <a href="/docs/synthetics/new-relic-synthetics/getting-started/types-synthetics-monitors">scripted browsers</a> to emulate and monitor a custom user experience by scripting browsers that navigate your website, take specific actions, and ensure specific elements are present. For a list of all available functions, see <a href="/docs/synthetics/new-relic-synthetics/scripting-monitors/synthetics-scripted-browser-reference-monitor-versions-050">Scripted browser reference</a>.</p>
<p>Scripted monitors are driven by <a href="https://seleniumhq.github.io/selenium/docs/api/javascript/index.html">Selenium WebDriverJS</a>. Each time your script runs, New Relic creates a fully virtualized Selenium-driven Google Chrome browser that navigates your website and follows each step of the script. Synthetic monitoring includes an IDE-style script editor what suggests functions, locators, and other elements to simplify scripting.</p>
<h2>Visit a URL [#visiting-a-url]</h2>
<p>All scripts begin by specifying which URL the monitor should navigate to. To specify a URL, call <code>$browser.get("url")</code>:</p>
<pre><code>$browser.get("https://mywebsite.com");
</code></pre>
<h2>Sequence actions [#sequence]</h2>
<p>Because WebDriverJS is asynchronous, scripting actions can sometimes execute out of order. To force script actions to execute in order, wrap each action in a <code>then(function(){})</code> call:</p>
<pre><code>$browser.get("https://my-website.com").then(function(){
    return $browser.findElement($driver.By.linkText("Configuration Panel"));
});
</code></pre>
<p>To connect multiple actions in sequence, wrap each action in a <code>then(function(){})</code> call, and chain the calls together:</p>
<pre><code>$browser.get("https://my-website.com").then(function(){
    return $browser.findElement($driver.By.linkText("Configuration Panel"));
}).then(function(){
    return $browser.findElement($driver.By.partialLinkText("Configuration Pa"));
});
</code></pre>
<h2>Locate elements [#locating-elements]</h2>
<p>Once you have specified a URL to monitor, you will usually want to locate a particular element on the page. Locating an element verifies its presence on the page, and also allows you to <a href="#interacting-elements">interact with page elements</a>.</p>
<p>You can locate elements by their <code>class</code>, <code>id</code>, <code>link text</code>, <code>name</code> or even XPath. To find these attributes, use your browser's developer tools or view your website's source code. For a list of all locator functions, see <a href="/docs/synthetics/new-relic-synthetics/scripting-monitors/synthetics-scripted-browser-reference-monitor-versions-050#locators">Locators: Find page elements</a>.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibG9jYXRlLWJ5LWNsYXNzIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJMb2NhdGUgYnkgQ1NTIGNsYXNzIn1d">
    <div data-prop-text="title">Locate by CSS class</div>
    <p>Locate an element by its HTML <code>class</code> (for example, <code>class="button"</code>). A class is usually specified for CSS styling. When locating an element by class, the monitor will select the first element on the page that has that class:</p>
    <pre><code>$browser.findElement($driver.By.className("button"));

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibG9jYXRlLWJ5LWlkIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJMb2NhdGUgYnkgSFRNTCBJRCJ9XQ==">
    <div data-prop-text="title">Locate by HTML ID</div>
    <p>Locate an element by its <strong>exact</strong> HTML <code>id</code> (for example, <code>id="edit-submit"</code>). This is a straightforward way to locate page elements, but be careful to specify an <code>id</code> that is not likely to change.</p>
    <pre><code>$browser.findElement($driver.By.id("edit-submit"));

</code></pre>For an example of locating an element by its `id`, see [Wait for a page element](/docs/synthetics/new-relic-synthetics/scripting-monitors/scripted-browser-examples#wait-for-element).
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibG9jYXRlLWJ5LWxpbmstdGV4dCJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiTG9jYXRlIGJ5IGxpbmsgdGV4dCJ9XQ==">
    <div data-prop-text="title">Locate by link text</div>
    <p>Locate an element by its displayed link text; for example, <code>&#x3C;a href="http://example.com>your link text here&#x3C;/a></code>. You can locate by the <strong>exact</strong> link text (<code>$driver.By.linkText</code>) or by partial match (<code>$driver.By.partialLinkText</code>):</p>
    <pre><code>$browser.findElement($driver.By.linkText("Configuration Panel"));

</code></pre>For an example of locating a link by its link text, see [Navigate to a link](/docs/synthetics/new-relic-synthetics/scripting-monitors/scripted-browser-examples#advanced-navigate).
    <pre><code>
$browser.findElement($driver.By.partialLinkText("Configuration Pa"));

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibG9jYXRlLWJ5LW5hbWUifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkxvY2F0ZSBieSBuYW1lIn1d">
    <div data-prop-text="title">Locate by name</div>
    <p>Locate an element by its <strong>exact</strong> HTML <code>name</code> (for example, <code>name="search-query-field"</code>). This is most commonly used with input fields such as a search box:</p>
    <pre><code>$browser.findElement($driver.By.name("search-query-field"));

</code></pre>For an example of locating an element by its `name`, see [Log in to a website](/docs/synthetics/new-relic-synthetics/scripting-monitors/scripted-browser-examples#advanced-login).
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibG9jYXRlLWJ5LXhwYXRoIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJMb2NhdGUgYnkgWFBhdGgifV0=">
    <div data-prop-text="title">Locate by XPath</div>
    <p>For more complex page structures, you can use XPath to locate the target element:</p>
    <pre><code>$browser.findElement($driver.By.xpath("//input[@placeholder = 'search-query-field']"));

</code></pre>XPath selectors can break when your website's structure changes. For tips on building good XPath selectors, see [Optimizing XPath selectors](https://blog.newrelic.com/engineering/optimize-xpath-selectors/). For an example of locating an element by its xpath, see [Search a website](/docs/synthetics/new-relic-synthetics/scripting-monitors/scripted-browser-examples#advanced-search).
    &#x3C;Callout variant="tip">
    To quickly find the XPath for a particular element, use your browser's developer tools. For example, in Chrome:
    1. In Chrome, navigate to the target website.
    2. Right-click the target element, then select **Inspect element**.
    3. From the Developer Tools panel that opens automatically, look for the highlighted target element.
    4. Right-click the target element, then select **Copy XPath**.
    &#x3C;/Callout>
  </div>
</div>
<h2>Interact with elements [#interacting-elements]</h2>
<p>Because a scripted monitor drives a real, Selenium-powered Google Chrome browser, scripted monitors can interact with page elements in the same way a user would. For example, the monitor can click a link, enter text in a search box, etc. For a list of available actions, see <a href="/docs/synthetics/new-relic-synthetics/scripting-monitors/synthetics-scripted-browser-reference-monitor-versions-050#actionsequence">ActionSequence: Link multiple actions</a>.</p>
<p>First, <a href="#locating-elements">locate the page element</a>, then call an interaction function:</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiY2xpY2tpbmctZWxlbWVudHMifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IkNsaWNrIHBhZ2UgZWxlbWVudHMifV0=">
    <div data-prop-text="title">Click page elements</div>
    <p>To click on a link or other page element, locate the element and call the <code>click()</code> function:</p>
    <pre><code>$browser.findElement($driver.By.linkText("Configuration Panel")).click();

</code></pre>For an example of clicking a located element, see [Navigate to a link](/docs/synthetics/new-relic-synthetics/scripting-monitors/scripted-browser-examples#advanced-navigate).
    &#x3C;Callout variant="tip">
    You can control the mouse in other ways with the `doubleClick()`, `dragAndDrop()`, `mouseDown`, `mouseUp`, and `mouseMove` functions.
    &#x3C;/Callout>
    <pre><code>
$browser.findElement($driver.By.className("config-panel-02")).click();

</code></pre>
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoiZW50ZXJpbmctdGV4dCJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiRW50ZXIgdGV4dCJ9XQ==">
    <div data-prop-text="title">Enter text</div>
    <p>To enter text in a field, locate the field and call the <code>sendKeys()</code> function:</p>
    <pre><code>$browser.findElement($driver.By.name("search-query-field")).sendKeys("EXAMPLE USER NAME");

</code></pre>For an example of entering text in a field, see [Search a website](/docs/synthetics/new-relic-synthetics/scripting-monitors/scripted-browser-examples#advanced-search).
    &#x3C;Callout variant="tip">
    You can add modifier keys (such as `ALT` and `SHIFT`) with the `keyDown()` and `keyUp()` functions.
    &#x3C;/Callout>
    <pre><code>
$browser.findElement($driver.By.id("search-q-box")).clear();

</code></pre>
    <pre><code>
$browser.findElement($driver.By.name("search-query-field")).clear();

</code></pre>Some fields may have default text in them. [Clear](/docs/synthetics/new-relic-synthetics/scripting-monitors/synthetics-scripted-browser-reference-monitor-versions-050#webElement-clear) these fields before sending text to them:
    <pre><code>
$browser.findElement($driver.By.id("search-q-box")).sendKeys("EXAMPLE USER NAME");

</code></pre>
  </div>
</div>
<h2>Waiting and timeouts [#waiting-elements]</h2>
<p>Large page elements, such as images or complex dynamic content, can take a long time to load. This can cause your script to fail when the monitor attempts to interact with or locate an element that hasn't been loaded yet.</p>
<p>To avoid these issues, set wait conditions that will pause the script until the specified page element is present, or <a href="#sequence">sequence actions manually</a>. For a list of conditions, see <a href="/docs/synthetics/new-relic-synthetics/scripting-monitors/synthetics-scripted-browser-reference-monitor-versions-050#until">Conditions: Pause and wait for conditions</a>.</p>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>After a maximum run time of three minutes, New Relic manually stops the script.</p>
</div>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoid2FpdC1wYWdlLXRpdGxlIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJXYWl0IGZvciBwYWdlIHRpdGxlIn1d">
    <div data-prop-text="title">Wait for page title</div>
    <p>Instruct the monitor to wait for the page title to match a certain value. This ensures that the browser has at least received some data from the target page. To wait for page title, specify an expected title and a timeout value in milliseconds:</p>
    <pre><code>//Call the wait function
$browser.wait(function() {
//Tell the monitor to get the page title, then run a function on that title.
  return $browser.getTitle().then(function(title) {
//Specify the expected page title.
    return title === "Your Page Title Here";
    });
//If the condition is not satisfied within a timeout of 1000 milliseconds (1 second), proceed anyway.
}, 1000);

</code></pre>For an example of waiting for page title, see [Wait for a page to load](/docs/synthetics/new-relic-synthetics/scripting-monitors/scripted-browser-examples#wait-for-title).
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoid2FpdC1wYWdlLWVsZW1lbnQifSx7InR5cGUiOiJtZHhBdHRyaWJ1dGUiLCJuYW1lIjoidGl0bGUiLCJ2YWx1ZSI6IldhaXQgZm9yIGEgc3BlY2lmaWMgZWxlbWVudCJ9XQ==">
    <div data-prop-text="title">Wait for a specific element</div>
    <p>Instruct the monitor to wait for a page element to be present. This is useful when an element your script depends on takes a long time to load, or simply to ensure that a page element is present before your script clicks on it.</p>
    <p>Use any of the <a href="#locating-elements">locate functions</a> with the wait function below. Use your desired function instead of the <code>$driver.By.linkText</code> function used below:</p>
    <pre><code>//Tell the monitor to wait up to 7,500 milliseconds (7.5 seconds) for a link whose text is `Your Link Text Here`.
$browser.waitForAndFindElement($driver.By.linkText("Your Link Text Here"), 7500);

</code></pre>For an example of waiting for a specific page element to load, see [Wait for a page element](/docs/synthetics/new-relic-synthetics/scripting-monitors/scripted-browser-examples#wait-for-element).
    &#x3C;Callout variant="important">
    `waitForAndFindElement()` will fail to find an element if it's entirely behind another element or if it has a size of 0. It will still find elements with 0 opacity.
    &#x3C;/Callout>
  </div>
</div>
<h2>Log script results [#logging]</h2>
<p>You can also manually log monitor results to the <a href="/docs/synthetics/new-relic-synthetics/using-monitors/viewing-monitor-results#viewing-logs">script log</a>. Use logging to troubleshoot a script: to discover which step of your script is failing, include a log function along with each key step in your script.</p>
<div data-component="CollapserGroup" data-prop="W10=">
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoibG9nLXN0YXRpYyJ9LHsidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ0aXRsZSIsInZhbHVlIjoiTG9nIHN0YXRpYyB0ZXh0In1d">
    <div data-prop-text="title">Log static text</div>
    <p>To log a line of static text, call <code>console.log()</code>:</p>
    <pre><code>//Send `Hello world.` to the console log.
console.log('Hello world.');

</code></pre>
    <pre><code>
// ----------------------------------- Console log
Hello world.

</code></pre>This results in [the output](/docs/synthetics/new-relic-synthetics/using-monitors/viewing-monitor-results#viewing-logs):
  </div>
  <div data-component="Collapser" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJpZCIsInZhbHVlIjoicGFzcy1hLXZhcmlhYmxlIn0seyJ0eXBlIjoibWR4QXR0cmlidXRlIiwibmFtZSI6InRpdGxlIiwidmFsdWUiOiJQYXNzIGEgdmFyaWFibGUgdG8gdGhlIGxvZyBmdW5jdGlvbiJ9XQ==">
    <div data-prop-text="title">Pass a variable to the log function</div>
    <p>In addition to <a href="#log-static">logging static text</a>, you can also pass variables to <code>console.log()</code>:</p>
    <pre><code>//Declare the variable `WEBSITE_URL`
var assert = require('assert'),
  WEBSITE_URL = 'https://my-website.com/';

console.log('Hello world.');
//Load the website specified in `WEBSITE_URL`
$browser.get(WEBSITE_URL);
//Log our success to the console
console.log('Success for', WEBSITE_URL);

</code></pre>
    <pre><code>
// ----------------------------------- Console log
Hello world.
Success for https://my-website.com/

</code></pre>[Look for these results](/docs/synthetics/new-relic-synthetics/using-monitors/viewing-monitor-results#viewing-logs):
  </div>
</div>
<h2>Unblock analytics services [#unblock-service]</h2>
<p>Synthetics blocks <a href="http://pgl.yoyo.org/adservers/serverlist.php?hostformat=nohtml&#x26;showintro=0">popular analytics services'</a> scripts from running by default. You can allow scripts to run for a specified service(s). This allows the service's scripts to run and collect data like it would for a real user.</p>
<pre><code>//Allow Google Analytics scripts to run
$browser.addHostnameToWhitelist(hostnameArr: ['google-analytics.com']);

//Visit https://my-website.com
$browser.get('https://my-website.com');
</code></pre>
<h2>Customize the user agent [#customize-user-agent]</h2>
<p>You can customize the scripted browser's user agent to ensure any browser-specific fixes in your app are working properly, or to bypass a security mechanism in order to filter an internal site.</p>
<pre><code>//Simulate Internet Explorer 10.6
$browser.addHeader('User-Agent', 'Mozilla/5.0 (compatible; MSIE 10.6; Windows NT 6.1; Trident/5.0; InfoPath.2; SLCC1; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET CLR 2.0.50727) 3gpp-gba UNTRUSTED/1.0');

//Visit http://httpbin.org/user-agent
$browser.get('http://httpbin.org/user-agent');
</code></pre>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJpbXBvcnRhbnQifV0=">
  <p>This only spoofs the user-agent HTTP header for the request to the server. It does not change the value of <code>navigator.userAgent</code>.</p>
</div>
<h2>Import optional modules [#importing]</h2>
<p>You can also import many popular Node.js modules to enhance your test suite, automate the insertion of test data, and simplify complex functions. For more information, see <a href="/docs/synthetics/new-relic-synthetics/scripting-monitors/importing-nodejs-modules">Importing Node.js modules</a>.</p>
