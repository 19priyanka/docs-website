
<p>Synthetic monitoring supports a variety of authentication mechanisms. Depending on the type of monitor you choose, this includes Basic, Digest, NTLM, and NTLMv2.</p>
<h2>Supported authentication by monitor type [#supported_authentication]</h2>
<p>Support for various <a href="/docs/synthetics/new-relic-synthetics/using-monitors/add-edit-monitors#types-monitors">monitor types</a> may depend on your site configuration.</p>
<div data-component="Table" data-prop="W10=">
  <div>
    <div>
      <div>
        <p><strong>Synthetic monitor type</strong></p>
      </div>
      <div>
        <p>Basic</p>
      </div>
      <div>
        <p>Digest</p>
      </div>
      <div>
        <p><a href="#tip">NTLM</a></p>
      </div>
      <div>
        <p><a href="#tip">NTLMv2</a></p>
      </div>
    </div>
  </div>
  <div>
    <div>
      <div>
        <p>Ping</p>
      </div>
      <div>
        <div data-component="Icon" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJuYW1lIiwidmFsdWUiOiJmZS1jaGVjayJ9XQ=="></div>
      </div>
      <div></div>
      <div></div>
      <div></div>
    </div>
    <div>
      <div>
        <p>Simple browser</p>
      </div>
      <div>
        <div data-component="Icon" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJuYW1lIiwidmFsdWUiOiJmZS1jaGVjayJ9XQ=="></div>
      </div>
      <div>
        <div data-component="Icon" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJuYW1lIiwidmFsdWUiOiJmZS1jaGVjayJ9XQ=="></div>
      </div>
      <div>
        <div data-component="Icon" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJuYW1lIiwidmFsdWUiOiJmZS1jaGVjayJ9XQ=="></div>
      </div>
      <div>
        <div data-component="Icon" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJuYW1lIiwidmFsdWUiOiJmZS1jaGVjayJ9XQ=="></div>
      </div>
    </div>
    <div>
      <div>
        <p>Scripted browser</p>
      </div>
      <div>
        <div data-component="Icon" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJuYW1lIiwidmFsdWUiOiJmZS1jaGVjayJ9XQ=="></div>
      </div>
      <div>
        <div data-component="Icon" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJuYW1lIiwidmFsdWUiOiJmZS1jaGVjayJ9XQ=="></div>
      </div>
      <div>
        <div data-component="Icon" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJuYW1lIiwidmFsdWUiOiJmZS1jaGVjayJ9XQ=="></div>
      </div>
      <div>
        <div data-component="Icon" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJuYW1lIiwidmFsdWUiOiJmZS1jaGVjayJ9XQ=="></div>
      </div>
    </div>
    <div>
      <div>
        <p>API test</p>
      </div>
      <div>
        <div data-component="Icon" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJuYW1lIiwidmFsdWUiOiJmZS1jaGVjayJ9XQ=="></div>
      </div>
      <div></div>
      <div></div>
      <div></div>
    </div>
  </div>
</div>
<div data-component="Callout" data-prop="W3sidHlwZSI6Im1keEF0dHJpYnV0ZSIsIm5hbWUiOiJ2YXJpYW50IiwidmFsdWUiOiJ0aXAifV0=">
  <p>For NTLM and NTLMv2, synthetic monitoring uses a Chrome browser in a Linux environment, so your configuration must be compatible with this client-side environment. It must also allow URI-encoded credentials.</p>
</div>
<h2>Provide authentication credentials [#url_encoding]</h2>
<p>Monitors provide authentication credentials by encoding them in the requested URL, such as <code>http(s)://username:password@site.com</code>. To do so, use the <code>encodeURIComponent('string')</code> JavaScript function in your script. For example:</p>
<pre><code>var username = encodeURIComponent('username');
var password = encodeURIComponent('password');
var url = 'https://' + username + ':' + password + '@site.com';
</code></pre>
<p>For ping and simple browser monitors, you can use the following form to encode your values:</p>
<p>Encode Value</p>
<p>The full URL <code>http(s)://username:password@site.com</code> will be recorded as plain text in the corresponding synthetic's check data. The URL will be visible when viewing results for this monitor.</p>
<h2>Code examples [#code_example]</h2>
<p>Here are code examples for some monitor types:</p>
<h3>Scripted browser</h3>
<pre><code>$browser.get('https://username:password@site.com').then(function(){
  $browser.takeScreenshot();
});
</code></pre>
<pre><code>$browser.get('https://username@domain.com:password@site.com').then(function(){
  $browser.takeScreenshot();
});
</code></pre>
<h3>API test</h3>
<pre><code>$http.get('https://username:password@site.com', function(err, resp, body){
  console.log(err, resp, body);
});
</code></pre>
<h2>Troubleshoot NTLM authentication issues</h2>
<p>You can check if New Relic will be able to properly authenticate against your NTLM endpoint using <a href="https://curl.haxx.se">curl</a> or with a scripted API monitor. You must use a host or location with access to your endpoint.</p>
<h3>curl</h3>
<p>To do this, run the following command, with the URL replaced by the endpoint you want to test:</p>
<pre><code>$ curl -v --ntlm http://example.com
</code></pre>
<p>In the output from that command you should see the following <strong>response</strong> header telling you the server is offering NTLM over HTTP as a valid authentication mechanism:</p>
<pre><code>WWW-Authenticate: NTLM
</code></pre>
<h3>Scripted API Monitor</h3>
<p>Create a new API test monitor and assign it to a location with access to your endpoint. Replace the URL and validate the following script, which will print all response headers to the script log:</p>
<pre><code>$http.get('https://www.newrelic.com',
{
  followRedirect: false
},
// Callback
function (err, response, body) {
  console.log(response.headers);
  }
);
</code></pre>
<p>Confirm that the WWW-Authenticate response header includes NTLM.</p>
<h3>Redirects</h3>
<p>NTLM authentication failures may be caused by <code>$browser.get</code> calls that result in a redirect. Check the response code for your request in the Timeline view in your monitor results. If the request is being redirected you may need to use the redirection location as the URL in the initial <code>$browser.get</code> call instead.</p>
