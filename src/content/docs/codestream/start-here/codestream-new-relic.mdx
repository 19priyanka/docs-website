---
title: CodeStream and New Relic
metaDescription: "Read about the useful ways CodeStream and New Relic work together."
---

CodeStream and New Relic work together in several ways to give you insight into your code's errors, as well as making it easier to get started instrumenting your code with our APM agents.

Specifically, when CodeStream is connected to New Relic, you'll be able to jump from a stack trace error directly to the offending line of code in your IDE. Once in your IDE, you'll be able to use all of CodeStream's collaboration tools to resolve the issue and push up the fix to your repository.

<Callout title="Preview release">
This is a preview release limited to accounts on our [US data center](/docs/using-new-relic/welcome-new-relic/get-started/our-eu-us-region-data-centers/).
</Callout>

## Connect CodeStream and New Relic [#connect]

Requirements for connecting CodeStream and New Relic:
* [New Relic account](https://newrelic.com/signup) (If you don't have a New Relic account, sign up at [newrelic.com/signup](https://newrelic.com/signup). It's free, forever!)
* [New Relic user key](https://one.newrelic.com/launcher/api-keys-ui.api-keys-launcher)

In order to get the most out of CodeStream and New Relic, connect CodeStream to New Relic via your [New Relic user key](/docs/apis/intro-apis/new-relic-api-keys/#user-api-key).

Once you have your API key, in **Observability** click **Connect to New Relic One**, then paste your API key and click **Connect**.

## Jump to the source of your errors [#errors]

Requirements for opening stack trace errors in your IDE:
* [New Relic account](https://newrelic.com/signup) (If you don't have a New Relic account, sign up at [newrelic.com/signup](https://newrelic.com/signup). It's free, forever!)
* [New Relic user key](https://one.newrelic.com/launcher/api-keys-ui.api-keys-launcher)
* [CodeStream and New Relic connection](#connect)
* [Your repository's commit sha](#sha)
* [Your repository's URL](#repo-url)
* If you're using an APM agent, [configure your APM agent for CodeStream](#apm)
* [Data being reported to New Relic from an app, host, or other entity ](https://one.newrelic.com/launcher/nr1-core.explorer?pane=eyJuZXJkbGV0SWQiOiJucjEtY29yZS5saXN0aW5nIn0=&cards[0]=eyJuZXJkbGV0SWQiOiJucjEtaW5zdGFsbC1uZXdyZWxpYy5ucjEtaW5zdGFsbC1uZXdyZWxpYyIsImFjdGl2ZUNvbXBvbmVudCI6IlZUU09FbnZpcm9ubWVudCIsInBhdGgiOiJndWlkZWQifQ==)
* [A workload for errors inbox](/docs/new-relic-one/use-new-relic-one/workloads/use-workloads/#create)
* [An error](/docs/apm/apm-ui-pages/errors-inbox/errors-inbox/#error-details)

New Relic errors inbox is a single place to proactively detect, prioritize, and take action on all the errors before they impact customers. Now via CodeStream, you can jump from an error directly to the code causing the error in your IDE.

<Callout variant="tip">
    Limited to APM, browser, and mobile errors.
</Callout>

From **[one.newrelic.com/](https://one.newrelic.com/)**, go to **Errors Inbox**, click a stack trace error, then click **Open in IDE**.

### Connect a stack trace error to the correct version of code [#sha]

For the **Open in IDE** button to open the version of your code that generated the stack trace error, you'll need your [commit sha](https://git-scm.com/book/en/v2/Git-Tools-Revision-Selection)
and/or your [release tag](https://git-scm.com/book/en/v2/Git-Basics-Tagging) associated with the running version of your software.  

CodeStream only needs the first seven characters of your commit sha (for example, `734713b`) to make this connection, but you can include the entire sha.  

Alternately, you can use a release tag (such as `v0.1.209` or `release-209`) for CodeStream to find the correct version of your code.

### Configure your New Relic APM [#apm]

For New Relic APM, the commit and/or release tag (`tags.commit` and `tags.releaseTag`) are added as attributes on `Transaction` and `TransactionError` events. The APM agent protocol provides an easy way to set this up via environment variables.  

We recommend setting one or both of these variables as part of your build pipeline.
* `NEW_RELIC_METADATA_COMMIT` - The commit sha. You can include the whole thing or only the first seven characters.
* `NEW_RELIC_METADATA_RELEASE_TAG` - A release tag (such as `v0.1.209` or `release-209`). This has the advantage of being human readable.

### Give us your git repository's URL [#repo-url]

In order to link your data in New Relic to your code, we need to know the URL for your git repository.  

The URL can be in either the SSH or HTTPS format:
* `git@github.com:newrelic/beta-docs-site.git`
* `https://github.com/newrelic/beta-docs-site.git`

You can use any one of these methods to set up your repository:
* Set up via environment variable using New Relic APM. We recommend this method.
* Use the NerdGraph API.

<CollapserGroup>
  <Collapser
    className="freq-link"
    id="env-var"
    title="Use environment variable with APM"
  >
  Set the environment variable `NEW_RELIC_METADATA_REPOSITORY_URL`. New Relic APM agents create the repository entity and associate it to your application entity automatically.   
  
  This requires the SSH or HTTPS URL format.  We recommend that these be set as part of your build pipeline.

  </Collapser>
    <Collapser
    className="freq-link"
    id="nerdgraph"
    title="Use the NerdGraph API"
  >

Use New Relic's [NerdGraph APIs](/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph/)to create a repository and associate it with your application entities.

**Step 1: Create a repository entity**

To create a repository entity use the `referenceEntityCreateOrUpdateRepository` API and make sure to save the GUID that
is produced.  The API take the following parameters:
* `accountId` - the integer account id for the account you want to add the Repository to
* `url` - example `https://github.com/newrelic/beta-docs-site.git`
* `name` - example: `newrelic/beta-docs-site`
```
mutation {
  referenceEntityCreateOrUpdateRepository(repositories: [{accountId: [YOUR_ACCOUNT_ID], name: "[REPO_NAME]", url: "[REPO_URL]"}]) {
    created
    failures {
      guid
      message
      type
    }
  }
}
```
In order to find back the entity you have created you can use a query like the following.  Note that the URL you
provided to `referenceEntityCreateOrUpdateRepository` gets saved as an entity tag.
```
{
  actor {
    entitySearch(query: "name = 'a name' OR tags.url = 'a url'") {
      count
      query
      results {
        entities {
          guid
          name
          tags {
            key
            values
          }
        }
      }
    }
  }
}

```
**Step 2: Associate the repository entity to your application entity**

First find the GUID for the application you want to associate your repository too.  

Parameters:
* `sourceEntityGuid` - the entity GUID of the application
* `targetEntityGuid` - the entity GUID of your Repository
* `type` - always `BUILT_FROM`

```
mutation {
  entityRelationshipUserDefinedCreateOrReplace(sourceEntityGuid: "", targetEntityGuid: "", type: BUILT_FROM) {
    errors {
      message
      type
    }
  }
}
```

To see all entities related to your Repository you can do a query like this:
```
{
  actor {
    entity(guid: "[YOUR_REPOSITORY_GUID]]") {
      relatedEntities(filter: {direction: BOTH, relationshipTypes: {include: BUILT_FROM}}) {
        results {
          target {
            entity {
              name
              guid
              type
            }
          }
          type
        }
      }
      name
      type
      tags {
        values
        key
      }
    }
  }
}

```

**Step 3: Cleanup (if needed)**

Delete a repository with the following query:
```
mutation DeleteRepository {
  entityDelete(guids: "[ENTITY_GUID_HERE]]") {
    deletedEntities
    failures {
      message
      guid
    }
  }
}

```

  </Collapser>

</CollapserGroup>

## Install APM agents with CodeStream [#install-agents]

Requirements for installing New Relic APM agents via CodeStream:
* [New Relic account](https://newrelic.com/signup)
* [New Relic user key](https://one.newrelic.com/launcher/api-keys-ui.api-keys-launcher)
* [CodeStream and New Relic connection](#connect)
* A supported language application codebase
    * .NET Core
    * Java
    * Node.JS

With CodeStream connected to New Relic, when you're working on an application's codebase that's not being monitored by New Relic, CodeStream will offer to instrument that application for you.

Like [New Relic's guided install](/docs/full-stack-observability/observe-everything/get-started/new-relic-guided-install-overview/), CodeStream will walk you through and automate all of the steps to installing the APM agent to start sending data to New Relic.

