---
title: "NerdGraph tutorial: Create and manage workflows"
tags:
  - Applied intelligence
  - Workflows
  - Nerdgraph
metaDescription: 'Examples of how to use New Relic's NerdGraph API to create workflows.'
---

For New Relic applied intelligence, you can create and manage [workflows](/docs/alerts-applied-intelligence/applied-intelligence/incident-workflows/incident-workflows) using our NerdGraph API.

## List and filter workflows [#filtering]

The `workflows` query allows you to paginate through all of your workflows per account. It also allows some filtering functionality on the account workflows.

<CollapserGroup>
  <Collapser
    id="account"
    title="Listing all workflows for an account"
  >
    
    ```
{
  actor {
    account(id: <YOUR ACCOUNT ID>) {
      aiWorkflows {
        workflows(filters: {}) {
          entities {
            id
            name
            workflowEnabled
            destinationConfigurations {
              channelId
              name
              type
            }
            enrichments {
              configuration {
                ... on AiWorkflowsNrqlConfigurationDto {
                  query
                }
              }
              id
              name
            }
            filter {
              predicates {
                attribute
                operator
                values
              }
            }
          }
          nextCursor
          totalCount
        }
      }
    }
  }
}
    ```
</Collapser>
<Collapser
    id="pagination"
    title="Paginating through policies with cursor pagination:"
  >

In order to paginate through your workflows, you must request the `nextCursor` field on your initial query.

With cursor pagination, you continue to make a request through the result set until the `nextCursor` that is returned from the response comes back empty. This signifies that you reached the end of your results.

First call

```
{
  actor {
    account(id: <YOUR ACCOUNT ID>) {
      aiWorkflows {
        workflows(filters: {}) {
          entities {
            id
            name
          }
          nextCursor
          totalCount
        }
      }
    }
  }
}
```

Response 

```
{
  "data": {
    "actor": {
      "account": {
        "aiWorkflows": {
          "workflows": {
            "entities": [
              {
                "id": <WORKFLOW ID>, 
                "name": <WORKFLOW NAME>
              },
              {
                "id": <WORKFLOW ID>, 
                "name": <WORKFLOW NAME>
              },
              // ... more workflows here in reality
            ]
          }
          "nextCursor": "/8o0y2qiR54m6thkdgHgwg==:jZTXDFKbTkhKwvMx+CtsPVM="
          "totalCount": 157
        }
      }
    }
  }
}
```
</Collapser>
<Collapser
    id="by-id"
    title="Find workflow by id"
  >

```
{
  actor {
    account(id: <YOUR ACCOUNT ID>) {
      aiWorkflows {
        workflows(filters: {id: <WORKFLOW ID>}) {
          entities {
            id
            name
          }
          nextCursor
          totalCount
        }
      }
    }
  }
}
```
</Collapser>
<Collapser
    id="by-name"
    title="Find workflow by name"
  >

```
{
  actor {
    account(id: <YOUR ACCOUNT ID>) {
      aiWorkflows {
        workflows(filters: {name: <WORKFLOW NAME>}) {
          entities {
            id
            name
          }
          nextCursor
          totalCount
        }
      }
    }
  }
}
```
</Collapser>
<Collapser
    id="destination-type"
    title="Find workflows by destination type"
  >
Finds all the workflows that have at least a single destination configuration of a certain type.

```
{
  actor {
    account(id: <YOUR ACCOUNT ID>) {
      aiWorkflows {
        workflows(filters: {destinationType: <DESTINATION TYPE>}) {
          entities {
            id
            name
            destinationConfigurations {
              type
            }
          }
          nextCursor
          totalCount
        }
      }
    }
  }
}
```
</Collapser>
</CollapserGroup>


## Create a workflow [#create-workflow]

In order to create a workflow you should first create destinations and channels using this [documentation](/docs/alerts-applied-intelligence/applied-intelligence/incident-workflows/incident-workflows)

<Callout variant="note">
A channel id is unique and therefore can't be used in multiple workflows and can't be used multiple times in the same workflow.
</Callout>

<CollapserGroup>
  <Collapser
    id="issues"
    title="Create a workflow to catch all issues"
  >

The `issuesFilter` attribute decides which issue events will be caught by the workflow.

By keeping the `predicates` attribute's value as an empty list, the workflow will catch all the possible issue events. When you select an attribute value you can then filter issue events.

For example, we can choose an attribute that only filters issues that are relevant to a specific team.

    ```
mutation {
  aiWorkflowsCreateWorkflow(accountId: <YOUR ACCOUNT ID>, createWorkflowData: {destinationsEnabled: true, workflowEnabled: true, name: "API Demo Workflow", issuesFilter: {name: "team specific issues", predicates: [{ attribute: "accumulations.tag.team", operator: EXACTLY_MATCHES, values:["security"]}], type: FILTER}, destinationConfigurations: {channelId: "<YOUR CHANNEL ID>"}, enrichmentsEnabled: true, enrichments: {nrql: []}, , mutingRulesHandling: DONT_NOTIFY_FULLY_MUTED_ISSUES}) {
    workflow {
      id
      name
      destinationConfigurations {
        channelId
        name
        type
      }
      enrichmentsEnabled
      destinationsEnabled
      issuesFilter {
        accountId
        id
        name
        predicates {
          attribute
          operator
          values
        }
        type
      }
      lastRun
      workflowEnabled
      mutingRulesHandling
    }
    errors {
      description
      type
    }
  }
}
    ```
</Collapser>
</CollapserGroup>

## Update a workflow [#update-workflow]

When you update a workflow, not that the only mandatory attributes you need to supply are the workflow id and account id. the rest are optional. For example, you only need to supply the name if you only intend to update the name:

<CollapserGroup>
  <Collapser
    id="update"
    title="Update a workflow"
  >

    ```
mutation {
  aiWorkflowsUpdateWorkflow(accountId: <YOUR ACCOUNT ID>, updateWorkflowData: {name: "Updated API Demo Workflow", id: <WORKFLOW ID>}) {
    workflow {
      id
      name
      destinationConfigurations {
        channelId
        name
        type
      }
      enrichmentsEnabled
      destinationsEnabled
      issuesFilter {
        accountId
        id
        name
        predicates {
          attribute
          operator
          values
        }
        type
      }
      lastRun
      workflowEnabled
      mutingRulesHandling
    }
    errors {
      description
      type
    }
  }
}
    ```
</Collapser>
</CollapserGroup>

## Delete a workflow [#delete-workflow]

<CollapserGroup>
  <Collapser
    id="delete"
    title="Delete a workflow"
  >
    ```
mutation {
  aiWorkflowsDeleteWorkflow(id: <WORKFLOW ID>, accountId: <YOUR ACCOUNT ID>) {
    id
    errors {
      description
      type
    }
  }
}
```
</Collapser>
</CollapserGroup>

## Test a workflow [#test-workflow]

The test searches for previous issues that match your inputs and creates a fake notification according to it. If no previous issue matching your inputs has been found it will return an error.

<CollapserGroup>
  <Collapser
    id="test"
    title="Test a workflow"
  >
    ```
mutation {
  aiWorkflowsTestWorkflow(accountId: <YOUR ACCOUNT ID>, testWorkflowData: {destinationConfigurations: {channelId: <YOUR CHANNEL ID>, type: SLACK}, issuesFilter: {predicates: [], type: FILTER}}) {
    status
    notificationResponses {
      status
      evidence
      channelId
    }
    errors {
      description
      type
    }
  }
}
    ```
</Collapser>
</CollapserGroup>
