---
title: "NerdGraph tutorial: Manage log parsing rules"
tags:
  - APIs
  - NerdGraph
  - Examples
  - Logs
metaDescription: How to create, query, and manage log parsing rules with NerdGraph, the New Relic GraphQL explorer.
---

You can use our NerdGraph GraphQL explorer at [api.newrelic.com/graphiql](https://api.newrelic.com/graphiql) to create, query, and manage your [parsing rules](/docs/logs/log-management/ui-data/parsing/) for logs.
This document includes:

* [The parsing rule schema](#data-partition-schema)
* [An example query of parsing rules](#query-data-partition-rules) 
* [How to create a parsing rule](#create-data-partition-rules)
* [How to update a parsing rule](#update-data-partition-rules)
* [How to delete a parsing rule](#delete-data-partition-rules)

## Data parsing schema [#parsing-schema]

Available parsing rule fields include:

**REVIEWER: The parsing doc says all they need is an attribute, value, and Grok pattern. This list comes from the NerdGraph data partition rules tutorial. Do any of these apply to parsing, or completely different? Thanks for confirming!**

<table>
  <thead>
  <tr>
    <th style={{width: "200px"}}>
      Fields
    </th>
    <th>
      Description
    </th>
  </tr>
  </thead>

  <tbody>
  <tr>
    <td>id **True for parsing?**</td>
    <td> Unique data parsing identifier.</td>
  </tr>
  <tr>
    <td>targetDataPartition **s/be something like targetParsing, or n/a?**</td>
    <td>The name of the data partition.</td>
  </tr>
  <tr>
    <td>description **True for parsing?**</td>
    <td>A description of what this parsing rule represents.</td>
  </tr>
  <tr>
    <td>matchingCriteria</td>
    <td>The matching criteria for this parsing rule. All parsing takes place against the `message` field; no other fields can be parsed. Once the rule is enabled, log messages matching this criteria will be parsed.
    
    To simplify the matching process, we recommend adding a `logtype` attribute to your logs. For example, you can include the `logtype` for the Grok pattern you are using with a [built-in parsing ruleset](docs/logs/log-management/ui-data/built-log-parsing-rulesets/). However, you are not limited to using `logtype`; any attribute can be used as matching criteria. **Is this right?**
    </td>
  </tr>
  <tr>
    <td>retentionPolicy **True for parsing?**</td>
    <td>The retention policy of the log parsing data.</td>
  </tr>
  <tr>
    <td>createdAt **True for parsing?**</td>
    <td>The date and time the rule was created.</td>
  </tr>
  <tr>
    <td>createdBy **True for parsing?**</td>
    <td>The user who created the rule.</td>
  </tr>
  <tr>
    <td>updatedAt **True for parsing?**</td>
    <td>The date and time the rule was last changed.</td>
  </tr>
  <tr>
    <td>updatedBy **True for parsing?**</td>
    <td>The user who last updated the rule.</td>
  </tr>
  <tr>
    <td>enabled **True for parsing?**</td>
    <td>Whether or not this parsing rule is enabled.</td>
  </tr>
  <tr>
    <td>deleted **True for parsing?**</td>
    <td>Whether or not this parsing rule has been deleted. Deleting a parsing rule does not delete the
      already routed logs.
    </td>
  </tr>
  <tr>
    <td>**anything else?**</td>
    <td>**any other fields for log parsing?**
    </td>
  </tr>

  </tbody>
</table>

## Example query of log parsing rules [#query-parsing-rules]

This NerdGraph API request example gets all of the parsing rules for a given account. In this example, only a few fields are requested.

**REVIEWER: This is the query for data partitions. Please provide a query for parsing, thanks!**

```
{
  actor {
    account(id: 123456) {
      logConfigurations {
        dataPartitionRules {
          id
          targetDataPartition
          description
          matchingCriteria {
            attributeName
            matchingOperator
            matchingExpression
          }
        }
      }
    }
  }
}
```

## Create parsing rules [#create-data-partition-rules]

This example creates a new log parsing rule. Before creating the rule, be sure to review the documentation about [log parsing](/docs/logs/log-management/ui-data/parsing/) and [built-in parsing rulesets](/docs/logs/log-management/ui-data/built-log-parsing-rulesets/).

**REVIEWER: This is the "create" info for data partitions. Please replace for parsing, thanks!**

```
mutation {
	logConfigurationsCreateDataPartitionRule(
	  accountId: 1123456,
    rule: {
      targetDataPartition: "Log_aNewDataPartitionRule",
      description: "Example data partition rule",
      matchingCriteria: {
        attributeName: "attribute",
        matchingMethod: LIKE,
        matchingExpression: "'%example%'"
      },
      retentionPolicy: STANDARD,
      enabled: true
    }) {
   	rule {
      id
      targetDataPartition
      description
    }
    errors {
      message
      type
    }
  }
}
```

## Update parsing rules [#update-parsing-rules]

This example updates the parsing rule with the given id `"123"`. The fields that can be updated are `description`, `matchingCriteria`, and `enabled`. All of them are optional, so you only need to use the ones you want to update.

**REVIEWER: This is the "update" info for data partitions. Please replace for parsing, thanks!**

```
mutation {
	logConfigurationsUpdateDataPartitionRule(
	  accountId: 1123456,
    rule: {
      id: "123",
      description: "Example data partition rule",
      matchingCriteria: {
        attributeName: "attribute",
        matchingMethod: LIKE,
        matchingExpression: "'%example%'"
      },
      enabled: true
    }) {
   	rule {
      id
      targetDataPartition
      description
    }
    errors {
      message
      type
    }
  }
}
```

## Delete parsing rules [#delete-parsing-rules]

This example deletes a parsing rule. Deleting a parsing rule doesn't delete the already persisted data. This data is retained for a given period of time defined by the `retentionPolicy` field.

**REVIEWER: This is the "delete" info for data partitions. Please replace for parsing, thanks!**

```
mutation {
logConfigurationsDeleteDataPartitionRule(id: "1111", accountId: 123456) {
    errors {
      message
      type
    }
  }
}
```
